<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>bee-doo · Reporting Dashboard Feb 2026 (Stand: 24.02.)</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet" />
<script src="config.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.3.1/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.3.1/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.12.7/Recharts.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.26.2/babel.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #06080F; color: #e1e7ef; font-family: 'DM Sans', system-ui, sans-serif; }
button, select, input { color: inherit; font-family: inherit; }
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: #0D1117; }
::-webkit-scrollbar-thumb { background: #1B2332; border-radius: 3px; }
.back-btn { position: fixed; top: 10px; left: 10px; z-index: 9999; background: #1a1d27; border: 1px solid #2a2d3a; color: #94a3b8; padding: 6px 14px; border-radius: 8px; font-size: 12px; cursor: pointer; text-decoration: none; transition: all .15s; }
.back-btn:hover { border-color: #F5C500; color: #F5C500; }
</style>

<style>

/* ═══ bee-doo Responsive + Lesbarkeit Fix ═══ */

/* === LESBARKEIT: Schriften aufhellen === */
/* Zu dunkle Grautöne auf Dark Theme aufhellen */
body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }

/* === TABLET (768px) === */
@media (max-width: 768px) {
  /* Grid → weniger Spalten */
  [style*="grid-template-columns"][style*="repeat"] { 
    grid-template-columns: repeat(2, 1fr) !important; 
  }
  [style*="gridTemplateColumns"] {
    grid-template-columns: repeat(2, 1fr) !important;
  }
  
  /* Flex-Container wrappen */
  [style*="display:flex"], [style*="display: flex"],
  [style*='display:"flex"'], [style*="display:'flex'"] {
    flex-wrap: wrap !important;
  }
  /* Ausnahme: Nav-Items und kleine Icon-Rows nicht wrappen */
  [style*="align-items:center"][style*="gap:4px"],
  [style*="alignItems:"center""][style*="gap:"4px""] {
    flex-wrap: nowrap !important;
  }
  
  /* Sidebar verkleinern */
  [style*="width:240px"], [style*="width: 240px"],
  [style*="width:260px"], [style*="width: 260px"],
  [style*="width:280px"], [style*="width: 280px"],
  [style*='width:"240px"'], [style*='width:"260px"'], [style*='width:"280px"'] {
    width: 200px !important;
    min-width: 200px !important;
  }
  
  /* Modals nicht breiter als Screen */
  .modal, [style*="width:480px"], [style*="width:520px"], [style*="width:560px"],
  [style*="width:600px"], [style*="width:640px"], [style*="width:700px"] {
    width: 95vw !important;
    max-width: 95vw !important;
  }
  
  /* Padding reduzieren */
  [style*="padding:40px"], [style*="padding:48px"], [style*="padding:32px"] {
    padding: 20px !important;
  }
  [style*="padding: 40px"], [style*="padding: 48px"], [style*="padding: 32px"] {
    padding: 20px !important;
  }
  
  /* Tabellen scrollbar */
  table { display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  
  /* Font-Size Minimum */
  * { min-height: 0; }
}

/* === MOBILE (480px) === */
@media (max-width: 480px) {
  /* Grid → 1 Spalte */
  [style*="grid-template-columns"], [style*="gridTemplateColumns"] { 
    grid-template-columns: 1fr !important; 
  }
  .grid { grid-template-columns: 1fr !important; }
  
  /* Sidebar ausblenden oder collapsieren */
  [style*="width:240px"], [style*="width: 240px"],
  [style*="width:260px"], [style*="width: 260px"],
  [style*="width:280px"], [style*="width: 280px"],
  [style*="width:200px"], [style*="width: 200px"],
  [style*='width:"240px"'], [style*='width:"260px"'], [style*='width:"280px"'],
  [style*='width:"200px"'] {
    position: fixed !important;
    left: -300px !important;
    z-index: 999 !important;
    transition: left 0.3s ease !important;
    width: 260px !important;
    height: 100vh !important;
    top: 0 !important;
  }
  
  /* Alle Flex-Container stacken */
  [style*="display:flex"], [style*="display: flex"],
  [style*='display:"flex"'] {
    flex-wrap: wrap !important;
  }
  [style*="flex-direction:row"], [style*="flexDirection:"row""],
  [style*="flex-direction: row"] {
    flex-direction: column !important;
  }
  
  /* Form-Elemente full width */
  input, select, textarea, .input-field {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    font-size: 16px !important; /* Prevents iOS zoom */
  }
  
  /* Buttons touch-friendly */
  button, .btn-primary, .btn-secondary, [role="button"] {
    min-height: 44px !important;
    min-width: 44px !important;
    font-size: 14px !important;
  }
  
  /* Padding stark reduzieren */
  [style*="padding:40px"], [style*="padding:48px"], [style*="padding:32px"],
  [style*="padding:28px"], [style*="padding:24px"],
  [style*="padding: 40px"], [style*="padding: 48px"], [style*="padding: 32px"],
  [style*="padding: 28px"], [style*="padding: 24px"] {
    padding: 12px !important;
  }
  
  /* Gap reduzieren */
  [style*="gap:24px"], [style*="gap:20px"], [style*="gap:28px"],
  [style*="gap: 24px"], [style*="gap: 20px"], [style*="gap: 28px"] {
    gap: 12px !important;
  }
  
  /* Font sizes - minimum 12px */
  [style*="font-size:8px"], [style*="font-size:9px"], [style*="font-size:10px"],
  [style*="font-size: 8px"], [style*="font-size: 9px"], [style*="font-size: 10px"],
  [style*="fontSize:8px"], [style*="fontSize:9px"], [style*="fontSize:10px"],
  [style*='fontSize:"8px"'], [style*='fontSize:"9px"'], [style*='fontSize:"10px"'] {
    font-size: 12px !important;
  }
  
  /* Bilder responsive */
  img { max-width: 100% !important; height: auto !important; }
  
  /* Fixed elements repositionieren */
  [style*="position:fixed"][style*="top:12px"][style*="left:12px"],
  [style*="position: fixed"][style*="top: 12px"][style*="left: 12px"] {
    top: 6px !important;
    left: 6px !important;
    font-size: 11px !important;
    padding: 4px 8px !important;
  }
  
  /* Logo kleiner */
  .logo { font-size: 32px !important; }
  
  /* Text wrap erzwingen */
  * { word-wrap: break-word !important; overflow-wrap: break-word !important; }
  [style*="white-space:nowrap"], [style*="white-space: nowrap"],
  [style*='whiteSpace:"nowrap"'] {
    white-space: normal !important;
  }
  
  /* Modals full width */
  .modal, [class*="modal"], [style*="width:480px"], [style*="width:520px"],
  [style*="width:560px"], [style*="width:600px"] {
    width: 96vw !important;
    max-width: 96vw !important;
    padding: 16px !important;
    margin: 8px !important;
  }
  
  /* Map containers */
  #map, .leaflet-container, [style*="height:100vh"] {
    height: calc(100vh - 60px) !important;
  }
  .map-toolbar {
    flex-direction: column !important;
    top: 6px !important;
    left: 6px !important;
    right: 6px !important;
  }
  .map-tool-btn {
    font-size: 11px !important;
    padding: 5px 10px !important;
  }
}

/* ═══ Lesbarkeit: Zu dunkle Farben aufhellen ═══ */
/* #0c1222 backgrounds → Schrift mindestens #8b95a5 */
[style*="color:#0c1222"], [style*="color: #0c1222"] { color: #8b95a5 !important; }
[style*="color:#151d30"], [style*="color: #151d30"] { color: #8b95a5 !important; }
[style*="color:#263354"], [style*="color: #263354"] { color: #7a8baa !important; }
[style*="color:#1c2640"], [style*="color: #1c2640"] { color: #8b95a5 !important; }
[style*="color:#334155"], [style*="color: #334155"] { color: #8b95a5 !important; }
[style*="color:#252530"], [style*="color: #252530"] { color: #8b95a5 !important; }
[style*='color:"#0c1222"'] { color: #8b95a5 !important; }
[style*='color:"#151d30"'] { color: #8b95a5 !important; }
[style*='color:"#263354"'] { color: #7a8baa !important; }
[style*='color:"#1c2640"'] { color: #8b95a5 !important; }
[style*='color:"#334155"'] { color: #8b95a5 !important; }
[style*='color:"#252530"'] { color: #8b95a5 !important; }

/* Grüntöne auf Dark besser lesbar machen */
[style*="color:#166534"], [style*="color: #166534"] { color: #34d399 !important; }
[style*='color:"#166534"'] { color: #34d399 !important; }

/* Generell: Alle font-sizes unter 10px auf mindestens 11px */

/* reporting.html specific */
@media (max-width: 768px) {
  canvas { max-width: 100% !important; height: auto !important; }
}
@media (max-width: 480px) {
  canvas { max-width: 100% !important; }
}
</style>
</head>
<body>
<a href="index.html" class="back-btn">← Launcher</a>
<div id="root"></div>
<script type="text/babel">
const { useState, useMemo } = React;
const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, PieChart, Pie, Cell, Legend, CartesianGrid, AreaChart, Area, ComposedChart, Line } = Recharts;


const C = {
  bg: "#06080F", card: "#0D1117", border: "#1B2332",
  text: "#E6EDF3", sec: "#8B949E", dim: "#484F58",
  amber: "#F0A030", green: "#3FB950", red: "#F85149", blue: "#58A6FF",
  purple: "#BC8CFF", pink: "#F778BA", cyan: "#56D4DD", orange: "#F0883E", teal: "#2EA043",
};
const CL = [C.amber, C.blue, C.green, C.red, C.purple, C.pink, C.cyan, C.orange, C.teal, "#A371F7", "#D2A8FF"];
const pct = (a, b) => b > 0 ? ((a / b) * 100).toFixed(1) : "0.0";
const fmt = n => typeof n === "number" ? n.toLocaleString("de-DE") : n;
const eur = n => n >= 1000000 ? `${(n/1000000).toFixed(2)}M €` : n >= 1000 ? `${(n/1000).toFixed(n>=100000?0:1)}k €` : `${fmt(n)} €`;

// ═══ SALES (Aufträge CSV – aktualisiert 24.02.2026) ═══
const SALES = {
  total: 171, aktiv: 138, storno: 33,
  nettoBrutto: 3885431, nettoAktiv: 3130973, nettoStorno: 754458,
  avgBrutto: 22722, avgNetto: 22688,
  fin: 158, bar: 13, speicher: 57,
  avgKwp: 9.5, avgModule: 20,
  sfVsSalesDaily: [
    { d: "01.02.", sf: 1, sales: 1 }, { d: "02.02.", sf: 79, sales: 7 },
    { d: "03.02.", sf: 80, sales: 6 }, { d: "04.02.", sf: 111, sales: 3 },
    { d: "05.02.", sf: 113, sales: 7 }, { d: "06.02.", sf: 101, sales: 8 },
    { d: "07.02.", sf: 26, sales: 5 }, { d: "08.02.", sf: 2, sales: 0 },
    { d: "09.02.", sf: 86, sales: 6 }, { d: "10.02.", sf: 109, sales: 7 },
    { d: "11.02.", sf: 109, sales: 13 }, { d: "12.02.", sf: 81, sales: 5 },
    { d: "13.02.", sf: 68, sales: 8 }, { d: "14.02.", sf: 4, sales: 4 },
    { d: "15.02.", sf: 0, sales: 1 }, { d: "16.02.", sf: 68, sales: 10 },
    { d: "17.02.", sf: 95, sales: 11 }, { d: "18.02.", sf: 97, sales: 13 },
    { d: "19.02.", sf: 78, sales: 10 }, { d: "20.02.", sf: 68, sales: 9 },
    { d: "21.02.", sf: 5, sales: 3 }, { d: "22.02.", sf: 6, sales: 4 },
    { d: "23.02.", sf: 143, sales: 11 },
  ],
  sfVsSalesWd: [
    { d: "Mo", sf: 376, sales: 34, rate: 9 }, { d: "Di", sf: 284, sales: 24, rate: 8 },
    { d: "Mi", sf: 317, sales: 29, rate: 9 }, { d: "Do", sf: 272, sales: 22, rate: 8 },
    { d: "Fr", sf: 237, sales: 25, rate: 11 }, { d: "Sa", sf: 35, sales: 12, rate: 34 },
  ],
  kwpDist: [{ name: "<8 kWp", v: 56 }, { name: "8–12 kWp", v: 49 }, { name: "≥12 kWp", v: 29 }],
  daily: [
    { d: "02.01.", v: 1, wd: "Fr", mon: "Jan" }, { d: "05.01.", v: 2, wd: "Mo", mon: "Jan" },
    { d: "06.01.", v: 5, wd: "Di", mon: "Jan" }, { d: "07.01.", v: 1, wd: "Mi", mon: "Jan" },
    { d: "08.01.", v: 4, wd: "Do", mon: "Jan" }, { d: "09.01.", v: 7, wd: "Fr", mon: "Jan" },
    { d: "10.01.", v: 3, wd: "Sa", mon: "Jan" }, { d: "12.01.", v: 6, wd: "Mo", mon: "Jan" },
    { d: "13.01.", v: 7, wd: "Di", mon: "Jan" }, { d: "14.01.", v: 6, wd: "Mi", mon: "Jan" },
    { d: "15.01.", v: 9, wd: "Do", mon: "Jan" }, { d: "16.01.", v: 4, wd: "Fr", mon: "Jan" },
    { d: "17.01.", v: 3, wd: "Sa", mon: "Jan" }, { d: "19.01.", v: 6, wd: "Mo", mon: "Jan" },
    { d: "20.01.", v: 6, wd: "Di", mon: "Jan" }, { d: "21.01.", v: 6, wd: "Mi", mon: "Jan" },
    { d: "22.01.", v: 6, wd: "Do", mon: "Jan" }, { d: "23.01.", v: 10, wd: "Fr", mon: "Jan" },
    { d: "24.01.", v: 2, wd: "Sa", mon: "Jan" }, { d: "26.01.", v: 7, wd: "Mo", mon: "Jan" },
    { d: "27.01.", v: 14, wd: "Di", mon: "Jan" }, { d: "28.01.", v: 5, wd: "Mi", mon: "Jan" },
    { d: "29.01.", v: 4, wd: "Do", mon: "Jan" }, { d: "30.01.", v: 6, wd: "Fr", mon: "Jan" },
    { d: "31.01.", v: 8, wd: "Sa", mon: "Jan" },
    { d: "01.02.", v: 1, wd: "So", mon: "Feb" }, { d: "02.02.", v: 7, wd: "Mo", mon: "Feb" },
    { d: "03.02.", v: 6, wd: "Di", mon: "Feb" }, { d: "04.02.", v: 3, wd: "Mi", mon: "Feb" },
    { d: "05.02.", v: 7, wd: "Do", mon: "Feb" }, { d: "06.02.", v: 8, wd: "Fr", mon: "Feb" },
    { d: "07.02.", v: 5, wd: "Sa", mon: "Feb" }, { d: "09.02.", v: 6, wd: "Mo", mon: "Feb" },
    { d: "10.02.", v: 7, wd: "Di", mon: "Feb" }, { d: "11.02.", v: 13, wd: "Mi", mon: "Feb" },
    { d: "12.02.", v: 5, wd: "Do", mon: "Feb" }, { d: "13.02.", v: 8, wd: "Fr", mon: "Feb" },
    { d: "14.02.", v: 4, wd: "Sa", mon: "Feb" }, { d: "15.02.", v: 1, wd: "So", mon: "Feb" },
    { d: "16.02.", v: 10, wd: "Mo", mon: "Feb" }, { d: "17.02.", v: 11, wd: "Di", mon: "Feb" },
    { d: "18.02.", v: 13, wd: "Mi", mon: "Feb" }, { d: "19.02.", v: 10, wd: "Do", mon: "Feb" },
    { d: "20.02.", v: 9, wd: "Fr", mon: "Feb" }, { d: "21.02.", v: 3, wd: "Sa", mon: "Feb" },
    { d: "22.02.", v: 4, wd: "So", mon: "Feb" }, { d: "23.02.", v: 11, wd: "Mo", mon: "Feb" },
  ],
  weekday: [
    { d: "Mo", v: 35, days: 6, avg: 5.8 }, { d: "Di", v: 48, days: 6, avg: 8.0 },
    { d: "Mi", v: 33, days: 6, avg: 5.5 }, { d: "Do", v: 34, days: 6, avg: 5.7 },
    { d: "Fr", v: 35, days: 6, avg: 5.8 }, { d: "Sa", v: 19, days: 6, avg: 3.2 },
  ],
  berater: [
    {n:"Stefan Hensel",s:9,net:231348,te:50,cl:35,ab:12,wvl:17,storno:1},
    {n:"Tayfun Süleymaniye",s:9,net:191800,te:35,cl:15,ab:11,wvl:2,storno:1},
    {n:"Gino Ulitzka",s:8,net:154945,te:62,cl:38,ab:15,wvl:13,storno:1},
    {n:"Fabian Hindenberg",s:5,net:106359,te:49,cl:21,ab:7,wvl:8,storno:1},
    {n:"Maxim Horten",s:5,net:102745,te:40,cl:29,ab:5,wvl:15,storno:0},
    {n:"Andreas Klee",s:4,net:100830,te:52,cl:29,ab:4,wvl:18,storno:0},
    {n:"Pascal Schallenberg",s:4,net:92290,te:19,cl:22,ab:5,wvl:10,storno:0},
    {n:"Jannis Pfeiffer",s:4,net:91145,te:18,cl:17,ab:4,wvl:10,storno:0},
    {n:"Martin Bott (Fachberater)",s:3,net:62700,te:4,cl:6,ab:3,wvl:2,storno:0},
    {n:"Kadir Danyildiz",s:3,net:61245,te:45,cl:19,ab:4,wvl:12,storno:0},
    {n:"Nino Rimmler",s:3,net:55160,te:45,cl:19,ab:2,wvl:15,storno:0},
    {n:"Philipp-T. Hannigk",s:3,net:48454,te:26,cl:29,ab:4,wvl:21,storno:0},
    {n:"Hartmut Seitz",s:2,net:49995,te:20,cl:16,ab:2,wvl:12,storno:0},
    {n:"Pascal Meier",s:2,net:49385,te:14,cl:11,ab:2,wvl:5,storno:0},
    {n:"Maximilian Koch",s:2,net:45458,te:20,cl:25,ab:2,wvl:12,storno:1},
    {n:"Kevin Kraus",s:2,net:45390,te:12,cl:9,ab:4,wvl:4,storno:0},
    {n:"Dimitri van Eeuwen",s:2,net:45342,te:26,cl:14,ab:2,wvl:10,storno:0},
    {n:"Klaus Vollmer",s:2,net:41000,te:33,cl:14,ab:0,wvl:11,storno:0},
    {n:"Farshad Nourouzi",s:2,net:40550,te:15,cl:9,ab:2,wvl:5,storno:0},
    {n:"Patrick Kalinowski",s:1,net:30195,te:37,cl:24,ab:1,wvl:12,storno:1},
    {n:"Christian Seifert",s:1,net:25495,te:10,cl:0,ab:0,wvl:0,storno:0},
    {n:"Marco Bringmann",s:1,net:23695,te:24,cl:8,ab:2,wvl:6,storno:0},
    {n:"Miguel Schader",s:1,net:23495,te:55,cl:10,ab:2,wvl:4,storno:1},
    {n:"Daniel Saweljew",s:1,net:23200,te:19,cl:12,ab:1,wvl:7,storno:0},
    {n:"Frank Reddig",s:1,net:22995,te:13,cl:16,ab:1,wvl:7,storno:1},
    {n:"Christoph Held",s:1,net:21895,te:3,cl:1,ab:1,wvl:0,storno:0},
    {n:"Bernd Krahwinkel",s:1,net:19900,te:34,cl:10,ab:1,wvl:1,storno:0},
    {n:"Janik Voß",s:1,net:18850,te:18,cl:3,ab:0,wvl:2,storno:0},
    {n:"Martin Bott",s:1,net:18700,te:29,cl:28,ab:4,wvl:16,storno:1},
    {n:"Lukas Kirschner",s:0,net:0,te:26,cl:0,ab:0,wvl:0,storno:0},
    {n:"Richard Winzent",s:0,net:0,te:23,cl:8,ab:1,wvl:4,storno:0},
    {n:"Ricardo Riedel",s:0,net:0,te:13,cl:1,ab:0,wvl:0,storno:0},
  ],
  quellen: [
    { n: "MVPP", s: 28, b: 32, e: 609473, eb: 699668, st: 4, leads: 323, rpl: 1742 },
    { n: "Omega", s: 14, b: 14, e: 311769, eb: 311769, st: 0, leads: 92, rpl: 2952 },
    { n: "Eigenlead", s: 9, b: 10, e: 214885, eb: 240000, st: 1, leads: 140, rpl: 1535 },
    { n: "SADD", s: 5, b: 7, e: 105115, eb: 155000, st: 2, leads: 1082, rpl: 97 },
    { n: "Empfehlung", s: 5, b: 6, e: 106037, eb: 130000, st: 1, leads: 13, rpl: 8157 },
    { n: "EzA", s: 1, b: 2, e: 25900, eb: 53800, st: 1, leads: 162, rpl: 160 },
    { n: "Int./Kunden", s: 2, b: 2, e: 20295, eb: 20295, st: 0, leads: 28, rpl: 725 },
    { n: "Enpal", s: 1, b: 1, e: 30195, eb: 30195, st: 0, leads: 897, rpl: 34 },
  ],
  quellenClose: [
    { n: "Empfehlung", sf: 15, s: 8, rate: 53 },
    { n: "Int./Kunden", sf: 7, s: 1, rate: 14 },
    { n: "MVPP", sf: 145, s: 36, rate: 25 },
    { n: "Omega", sf: 79, s: 16, rate: 20 },
    { n: "Eigenlead", sf: 54, s: 12, rate: 22 },
    { n: "SADD", sf: 67, s: 6, rate: 9 },
    { n: "Enpal", sf: 10, s: 1, rate: 10 },
    { n: "EzA", sf: 20, s: 2, rate: 10 },
  ],
  beraterTotal: [
    { n: "Gino Ulitzka", b: 33, s: 21, st: 12, e: 438540 },
    { n: "Tayfun Süleymaniye", b: 28, s: 23, st: 5, e: 464024 },
    { n: "Martin Bott", b: 18, s: 13, st: 5, e: 282537 },
    { n: "Stefan Hensel", b: 18, s: 13, st: 5, e: 338235 },
    { n: "Fabian Hindenberg", b: 12, s: 10, st: 2, e: 193329 },
    { n: "Pascal Schallenberg", b: 13, s: 10, st: 3, e: 227685 },
    { n: "Maxim Horten", b: 9, s: 7, st: 2, e: 152390 },
    { n: "Nino Rimmler", b: 12, s: 11, st: 1, e: 226085 },
    { n: "Philipp-T. Hannigk", b: 11, s: 10, st: 1, e: 187454 },
    { n: "Jannis Pfeiffer", b: 11, s: 8, st: 3, e: 180285 },
    { n: "Miguel Schader", b: 9, s: 8, st: 1, e: 177326 },
    { n: "Richard Winzent", b: 8, s: 7, st: 1, e: 136800 },
    { n: "Hartmut Seitz", b: 7, s: 7, st: 0, e: 139770 },
    { n: "Klaus Vollmer", b: 7, s: 7, st: 0, e: 162995 },
    { n: "Farshad Nourouzi", b: 7, s: 6, st: 1, e: 124395 },
    { n: "Bernd Krahwinkel", b: 7, s: 6, st: 1, e: 113440 },
    { n: "Andreas Klee", b: 5, s: 5, st: 0, e: 113580 },
    { n: "Kadir Danyildiz", b: 6, s: 2, st: 4, e: 37650 },
    { n: "Pascal Meier", b: 5, s: 4, st: 1, e: 81256 },
    { n: "Janik Voß", b: 7, s: 5, st: 2, e: 89216 },
    { n: "Marco Bringmann", b: 5, s: 2, st: 3, e: 44995 },
    { n: "Daniel Saweljew", b: 4, s: 2, st: 2, e: 39500 },
    { n: "Frank Reddig", b: 4, s: 3, st: 1, e: 66395 },
    { n: "Patrick Kalinowski", b: 3, s: 3, st: 0, e: 68845 },
    { n: "Maximilian Koch", b: 4, s: 3, st: 1, e: 62503 },
    { n: "Dimitri van Eeuwen", b: 3, s: 2, st: 1, e: 50542 },
    { n: "Kevin Kraus", b: 2, s: 2, st: 0, e: 45390 },
    { n: "Christian Seifert", b: 2, s: 2, st: 0, e: 43195 },
    { n: "Christoph Held", b: 2, s: 2, st: 0, e: 41795 },
    { n: "Lukas Kirschner", b: 2, s: 1, st: 1, e: 17000 },
  ],
  topEigenlead: [
    { n: "Pascal Schallenberg", jan: 6, feb: 1, total: 7 },
    { n: "Richard Winzent", jan: 6, feb: 0, total: 6 },
    { n: "Hartmut Seitz", jan: 3, feb: 0, total: 3 },
    { n: "Stefan Hensel", jan: 2, feb: 1, total: 3 },
    { n: "Christian Seifert", jan: 1, feb: 1, total: 2 },
    { n: "Jannis Pfeiffer", jan: 1, feb: 1, total: 2 },
    { n: "Kevin Kraus", jan: 0, feb: 2, total: 2 },
    { n: "Tayfun Süleymaniye", jan: 1, feb: 0, total: 1 },
    { n: "Fabian Hindenberg", jan: 1, feb: 0, total: 1 },
    { n: "Nino Rimmler", jan: 1, feb: 0, total: 1 },
  ],
  topEmpfehlung: [
    { n: "Gino Ulitzka", jan: 6, feb: 0, total: 6 },
    { n: "Tayfun Süleymaniye", jan: 3, feb: 1, total: 4 },
    { n: "Nino Rimmler", jan: 4, feb: 0, total: 4 },
    { n: "Dimitri van Eeuwen", jan: 1, feb: 1, total: 2 },
    { n: "Pascal Schallenberg", jan: 0, feb: 2, total: 2 },
    { n: "Richard Winzent", jan: 1, feb: 0, total: 1 },
    { n: "Philipp-T. Hannigk", jan: 1, feb: 0, total: 1 },
    { n: "Jannis Pfeiffer", jan: 1, feb: 0, total: 1 },
    { n: "Fabian Hindenberg", jan: 0, feb: 1, total: 1 },
  ],
  topSpeicher: [
    { n: "Stefan Hensel", jan: 4, feb: 5, total: 9 },
    { n: "Miguel Schader", jan: 5, feb: 1, total: 6 },
    { n: "Jannis Pfeiffer", jan: 4, feb: 1, total: 5 },
    { n: "Pascal Schallenberg", jan: 2, feb: 2, total: 4 },
    { n: "Nino Rimmler", jan: 3, feb: 1, total: 4 },
    { n: "Gino Ulitzka", jan: 2, feb: 1, total: 3 },
    { n: "Tayfun Süleymaniye", jan: 3, feb: 0, total: 3 },
    { n: "Martin Bott", jan: 2, feb: 1, total: 3 },
    { n: "Patrick Kalinowski", jan: 1, feb: 1, total: 2 },
    { n: "Philipp-T. Hannigk", jan: 1, feb: 1, total: 2 },
  ],
};

// ═══ LEADS ═══
const LEADS = {
  total: 3035,
  status: [
    { name: "Nicht erreicht", v: 695, fill: C.orange }, { name: "REKLAMATION", v: 627, fill: C.red },
    { name: "Nicht im PLZ", v: 549, fill: C.purple }, { name: "Terminiert", v: 454, fill: C.green },
    { name: "WVL", v: 215, fill: C.blue }, { name: "5x nicht err.", v: 169, fill: "#D29922" },
    { name: "Neuer Lead", v: 158, fill: C.cyan }, { name: "Sonstige", v: 168, fill: C.dim },
  ],
  dailyImport: [
    {d:"01.02.",mvpp:0,sadd:0,enpal:0,omega:0,eigen:1,sonst:498},
    {d:"02.02.",mvpp:5,sadd:142,enpal:169,omega:4,eigen:16,sonst:44},
    {d:"03.02.",mvpp:29,sadd:202,enpal:101,omega:11,eigen:11,sonst:23},
    {d:"04.02.",mvpp:41,sadd:0,enpal:88,omega:15,eigen:25,sonst:33},
    {d:"05.02.",mvpp:52,sadd:135,enpal:108,omega:8,eigen:39,sonst:17},
    {d:"06.02.",mvpp:50,sadd:164,enpal:69,omega:10,eigen:12,sonst:12},
    {d:"07.02.",mvpp:19,sadd:0,enpal:42,omega:2,eigen:9,sonst:0},
    {d:"08.02.",mvpp:0,sadd:0,enpal:0,omega:0,eigen:3,sonst:0},
    {d:"09.02.",mvpp:10,sadd:125,enpal:84,omega:16,eigen:4,sonst:18},
    {d:"10.02.",mvpp:52,sadd:227,enpal:92,omega:12,eigen:23,sonst:26},
    {d:"11.02.",mvpp:40,sadd:87,enpal:130,omega:14,eigen:10,sonst:24},
    {d:"12.02.",mvpp:28,sadd:113,enpal:89,omega:10,eigen:15,sonst:23},
    {d:"13.02.",mvpp:33,sadd:60,enpal:97,omega:10,eigen:9,sonst:30},
    {d:"14.02.",mvpp:23,sadd:0,enpal:9,omega:3,eigen:0,sonst:2},
    {d:"15.02.",mvpp:6,sadd:0,enpal:0,omega:0,eigen:1,sonst:0},
    {d:"16.02.",mvpp:5,sadd:54,enpal:78,omega:3,eigen:5,sonst:20},
  ],
  quellen: [
    { n: "SADD", total: 1082, term: 91, rekl: 174, ne: 191, plz: 524, wvl: 74 },
    { n: "Enpal", total: 987, term: 68, rekl: 278, ne: 345, plz: 42, wvl: 97 },
    { n: "beedoo", total: 493, term: 3, rekl: 181, ne: 264, plz: 8, wvl: 19 },
    { n: "MVPP", total: 323, term: 160, rekl: 5, ne: 30, plz: 0, wvl: 33 },
    { n: "EzA", total: 162, term: 17, rekl: 55, ne: 52, plz: 12, wvl: 23 },
    { n: "Eigenlead", total: 140, term: 66, rekl: 0, ne: 22, plz: 0, wvl: 4 },
    { n: "Omega", total: 92, term: 80, rekl: 1, ne: 0, plz: 0, wvl: 0 },
    { n: "Int./Kunden", total: 28, term: 11, rekl: 1, ne: 4, plz: 0, wvl: 0 },
    { n: "Empfehlung", total: 13, term: 6, rekl: 0, ne: 0, plz: 0, wvl: 0 },
  ],
};

// ═══ TERMINE Feb (DEDUP nach Leadkunde, DatumTermin Ende, 3 Typen) ═══
// Quoten: nur bis gestern (10.02.)!
const TERME = {
  kundenGesamt: 608, ohneAF: 381, alleAF: 227,
  stattBisGestern: 402, afBisGestern: 227,
  heuteAktiv: 57, zukunftAktiv: 645,
  dedup: 88, // Termine eingespart durch Dedup
  daily: [
    { d: "01.02.", v: 4, af: 0 }, { d: "02.02.", v: 32, af: 20 }, { d: "03.02.", v: 35, af: 20 },
    { d: "04.02.", v: 45, af: 19 }, { d: "05.02.", v: 40, af: 24 }, { d: "06.02.", v: 48, af: 28 },
    { d: "07.02.", v: 9, af: 9 }, { d: "08.02.", v: 4, af: 0 }, { d: "09.02.", v: 46, af: 20 },
    { d: "10.02.", v: 36, af: 21 }, { d: "11.02.", v: 53, af: 24 }, { d: "12.02.", v: 55, af: 17 },
    { d: "13.02.", v: 67, af: 6 }, { d: "14.02.", v: 21, af: 1 }, { d: "16.02.", v: 54, af: 4 },
    { d: "17.02.", v: 55, af: 8 }, { d: "18.02.", v: 61, af: 5 }, { d: "19.02.", v: 61, af: 2 },
    { d: "20.02.", v: 53, af: 4 }, { d: "21.02.", v: 21, af: 0 }, { d: "23.02.", v: 38, af: 4 },
    { d: "24.02.", v: 37, af: 1 }, { d: "25.02.", v: 39, af: 1 }, { d: "26.02.", v: 34, af: 1 },
    { d: "27.02.", v: 34, af: 1 }, { d: "28.02.", v: 11, af: 0 },
  ],
  berater: [
    { n: "Andreas Klee", t: 52, af: 7, sf: 16, afH: 1, sfR: 16, el: 0, jSf: 54, jAf: 39, jEl: 0 },
    { n: "Gino Ulitzka", t: 47, af: 5, sf: 20, afH: 1, sfR: 20, el: 1, jSf: 62, jAf: 21, jEl: 1 },
    { n: "Miguel Schader", t: 46, af: 13, sf: 1, afH: 2, sfR: 1, el: 0, jSf: 47, jAf: 41, jEl: 0 },
    { n: "Fabian Hindenberg", t: 44, af: 12, sf: 15, afH: 1, sfR: 15, el: 0, jSf: 33, jAf: 27, jEl: 2 },
    { n: "Nino Rimmler", t: 44, af: 13, sf: 16, afH: 1, sfR: 16, el: 0, jSf: 50, jAf: 36, jEl: 1 },
    { n: "Martin Bott", t: 43, af: 19, sf: 25, afH: 1, sfR: 25, el: 1, jSf: 54, jAf: 27, jEl: 1 },
    { n: "Kadir Danyildiz", t: 40, af: 3, sf: 14, afH: 1, sfR: 14, el: 0, jSf: 13, jAf: 4, jEl: 1 },
    { n: "Maxim Horten", t: 39, af: 11, sf: 21, afH: 1, sfR: 21, el: 3, jSf: 38, jAf: 34, jEl: 1 },
    { n: "Stefan Hensel", t: 36, af: 12, sf: 18, afH: 0, sfR: 18, el: 6, jSf: 41, jAf: 30, jEl: 3 },
    { n: "Tayfun Süleymaniye", t: 35, af: 18, sf: 15, afH: 4, sfR: 15, el: 4, jSf: 46, jAf: 42, jEl: 2 },
    { n: "Patrick Kalinowski", t: 32, af: 12, sf: 12, afH: 2, sfR: 12, el: 0, jSf: 31, jAf: 33, jEl: 0 },
    { n: "Bernd Krahwinkel", t: 32, af: 2, sf: 10, afH: 1, sfR: 10, el: 1, jSf: 9, jAf: 1, jEl: 2 },
    { n: "Philipp-T. Hannigk", t: 27, af: 20, sf: 19, afH: 1, sfR: 19, el: 0, jSf: 40, jAf: 35, jEl: 0 },
    { n: "Klaus Vollmer", t: 26, af: 6, sf: 10, afH: 1, sfR: 10, el: 13, jSf: 35, jAf: 10, jEl: 8 },
    { n: "Lukas Kirschner", t: 26, af: 10, sf: 11, afH: 1, sfR: 11, el: 0, jSf: 19, jAf: 33, jEl: 1 },
    { n: "Hartmut Seitz", t: 20, af: 2, sf: 11, afH: 0, sfR: 11, el: 2, jSf: 23, jAf: 9, jEl: 7 },
    { n: "Richard Winzent", t: 20, af: 5, sf: 4, afH: 3, sfR: 4, el: 21, jSf: 28, jAf: 10, jEl: 29 },
    { n: "Marco Bringmann", t: 19, af: 10, sf: 6, afH: 2, sfR: 6, el: 0, jSf: 25, jAf: 12, jEl: 0 },
    { n: "Daniel Saweljew", t: 18, af: 1, sf: 11, afH: 0, sfR: 11, el: 5, jSf: 7, jAf: 1, jEl: 2 },
    { n: "Dimitri van Eeuwen", t: 18, af: 5, sf: 10, afH: 0, sfR: 10, el: 0, jSf: 14, jAf: 8, jEl: 0 },
    { n: "Pascal Meier", t: 16, af: 7, sf: 8, afH: 1, sfR: 8, el: 0, jSf: 19, jAf: 29, jEl: 0 },
    { n: "Maximilian Koch", t: 15, af: 5, sf: 15, afH: 2, sfR: 15, el: 1, jSf: 15, jAf: 2, jEl: 0 },
    { n: "Jannis Pfeiffer", t: 14, af: 4, sf: 9, afH: 1, sfR: 9, el: 7, jSf: 26, jAf: 14, jEl: 3 },
    { n: "Pascal Schallenberg", t: 14, af: 1, sf: 17, afH: 0, sfR: 17, el: 17, jSf: 46, jAf: 17, jEl: 29 },
    { n: "Kevin Kraus", t: 13, af: 0, sf: 9, afH: 0, sfR: 9, el: 17, jSf: 10, jAf: 4, jEl: 8 },
    { n: "Farshad Nourouzi", t: 13, af: 4, sf: 3, afH: 1, sfR: 3, el: 0, jSf: 23, jAf: 9, jEl: 1 },
    { n: "Ricardo Riedel", t: 13, af: 0, sf: 6, afH: 0, sfR: 6, el: 12, jSf: 0, jAf: 0, jEl: 0 },
    { n: "Frank Reddig", t: 11, af: 5, sf: 15, afH: 2, sfR: 15, el: 1, jSf: 11, jAf: 7, jEl: 1 },
    { n: "Janik Voß", t: 10, af: 3, sf: 1, afH: 0, sfR: 1, el: 0, jSf: 10, jAf: 6, jEl: 0 },
    { n: "Christian Seifert", t: 9, af: 1, sf: 5, afH: 0, sfR: 5, el: 11, jSf: 4, jAf: 5, jEl: 7 },
    { n: "Sebastian Mansour", t: 8, af: 0, sf: 8, afH: 0, sfR: 8, el: 13, jSf: 14, jAf: 1, jEl: 7 },
    { n: "Christoph Held", t: 2, af: 1, sf: 1, afH: 0, sfR: 1, el: 0, jSf: 4, jAf: 12, jEl: 0 },

  ],
  terminiererJan: [
    { n: "Nadia Kucab", t: 61 }, { n: "Selin Aylikcioglu", t: 44 },
    { n: "Jenny Litke", t: 37 }, { n: "Celine Madlaine", t: 37 },
    { n: "Jasmin Hübner", t: 29 }, { n: "Mensure Baykan", t: 12 },
  ],
  terminierer: [
    { n: "Jasmin Hübner", t: 65 }, { n: "Nadia Kucab", t: 62 },
    { n: "Jenny Litke", t: 59 }, { n: "Selin Aylikcioglu", t: 57 },
    { n: "Mensure Baykan", t: 29 }, { n: "Celine Madlaine", t: 23 },
  ],
  terminiererTotal: [
    { n: "Jasmin Hübner", t: 65 }, { n: "Nadia Kucab", t: 62 },
    { n: "Jenny Litke", t: 59 }, { n: "Selin Aylikcioglu", t: 57 },
    { n: "Mensure Baykan", t: 29 }, { n: "Celine Madlaine", t: 23 },
  ],
  erstellung: [
    { d: "01.02.", v: 1, scouter: 0, cc: 1, sadd: 0, enpal: 0, eigen: 0, omega: 0, empf: 0, sonst: 0 },
    { d: "02.02.", v: 79, scouter: 27, cc: 7, sadd: 10, enpal: 2, eigen: 11, omega: 6, empf: 0, sonst: 16 },
    { d: "03.02.", v: 80, scouter: 11, cc: 3, sadd: 15, enpal: 18, eigen: 9, omega: 15, empf: 1, sonst: 8 },
    { d: "04.02.", v: 111, scouter: 32, cc: 9, sadd: 13, enpal: 10, eigen: 18, omega: 17, empf: 3, sonst: 9 },
    { d: "05.02.", v: 113, scouter: 37, cc: 3, sadd: 14, enpal: 19, eigen: 22, omega: 10, empf: 0, sonst: 8 },
    { d: "06.02.", v: 101, scouter: 30, cc: 5, sadd: 20, enpal: 10, eigen: 11, omega: 14, empf: 1, sonst: 10 },
    { d: "07.02.", v: 26, scouter: 0, cc: 5, sadd: 3, enpal: 6, eigen: 4, omega: 2, empf: 6, sonst: 0 },
    { d: "08.02.", v: 2, scouter: 0, cc: 0, sadd: 0, enpal: 0, eigen: 2, omega: 0, empf: 0, sonst: 0 },
    { d: "09.02.", v: 86, scouter: 18, cc: 5, sadd: 24, enpal: 11, eigen: 2, omega: 18, empf: 2, sonst: 6 },
    { d: "10.02.", v: 109, scouter: 39, cc: 4, sadd: 27, enpal: 3, eigen: 11, omega: 19, empf: 1, sonst: 5 },
    { d: "11.02.", v: 109, scouter: 29, cc: 8, sadd: 17, enpal: 15, eigen: 9, omega: 16, empf: 1, sonst: 14 },
    { d: "12.02.", v: 81, scouter: 19, cc: 8, sadd: 9, enpal: 14, eigen: 8, omega: 11, empf: 3, sonst: 9 },
  ],
  erstellungGesamt: 898,
  erstellungCC: [
    { d: "01.02.", cc: 1, andere: 0, cc_mvpp: 1, sadd: 0, enpal: 0, sonst: 0 },
    { d: "02.02.", cc: 30, andere: 47, cc_mvpp: 7, sadd: 8, enpal: 2, sonst: 13 },
    { d: "03.02.", cc: 41, andere: 38, cc_mvpp: 3, sadd: 14, enpal: 18, sonst: 6 },
    { d: "04.02.", cc: 37, andere: 71, cc_mvpp: 9, sadd: 12, enpal: 10, sonst: 6 },
    { d: "05.02.", cc: 41, andere: 71, cc_mvpp: 3, sadd: 14, enpal: 19, sonst: 5 },
    { d: "06.02.", cc: 39, andere: 59, cc_mvpp: 3, sadd: 20, enpal: 10, sonst: 6 },
    { d: "07.02.", cc: 13, andere: 12, cc_mvpp: 5, sadd: 2, enpal: 6, sonst: 0 },
    { d: "08.02.", cc: 0, andere: 2, cc_mvpp: 0, sadd: 0, enpal: 0, sonst: 0 },
    { d: "09.02.", cc: 45, andere: 39, cc_mvpp: 5, sadd: 23, enpal: 11, sonst: 6 },
    { d: "10.02.", cc: 37, andere: 72, cc_mvpp: 4, sadd: 27, enpal: 3, sonst: 3 },
    { d: "11.02.", cc: 47, andere: 60, cc_mvpp: 8, sadd: 15, enpal: 15, sonst: 9 },
    { d: "12.02.", cc: 0, andere: 2, cc_mvpp: 0, sadd: 0, enpal: 0, sonst: 0 },
  ],
  ccGesamt: 466,
  erstellungTerminiererJan: [
    { n: "Nadia Kucab", t: 107 }, { n: "Selin Aylikcioglu", t: 81 },
    { n: "Celine Madlaine", t: 77 }, { n: "Jasmin Hübner", t: 70 },
    { n: "Jenny Litke", t: 62 }, { n: "Mensure Baykan", t: 37 },
  ],
  erstellungTerminierer: [
    { n: "Jasmin Hübner", t: 61 }, { n: "Jenny Litke", t: 55 },
    { n: "Nadia Kucab", t: 52 }, { n: "Selin Aylikcioglu", t: 51 },
    { n: "Mensure Baykan", t: 27 }, { n: "Celine Madlaine", t: 23 },
  ],
  erstellungTerminiererTotal: [
    { n: "Nadia Kucab", t: 159 }, { n: "Selin Aylikcioglu", t: 132 },
    { n: "Jasmin Hübner", t: 131 }, { n: "Jenny Litke", t: 117 },
    { n: "Celine Madlaine", t: 100 }, { n: "Mensure Baykan", t: 64 },
  ],
};

// ═══ CALL CENTER DATA ═══
const CC = {
  agents: [
    { n: "Jasmin Hübner", erJan: 70, erFeb: 115, erTotal: 185, sfJan: 29, sfFeb: 30, sfTotal: 59, afJan: 13, afFeb: 26, afTotal: 39 },
    { n: "Nadia Kucab", erJan: 107, erFeb: 110, erTotal: 217, sfJan: 61, sfFeb: 27, sfTotal: 88, afJan: 14, afFeb: 22, afTotal: 36 },
    { n: "Selin Aylikcioglu", erJan: 81, erFeb: 96, erTotal: 177, sfJan: 44, sfFeb: 14, sfTotal: 58, afJan: 15, afFeb: 21, afTotal: 36 },
    { n: "Jenny Litke", erJan: 62, erFeb: 89, erTotal: 151, sfJan: 37, sfFeb: 25, sfTotal: 62, afJan: 8, afFeb: 23, afTotal: 31 },
    { n: "Celine Madlaine", erJan: 77, erFeb: 24, erTotal: 101, sfJan: 37, sfFeb: 7, sfTotal: 44, afJan: 19, afFeb: 5, afTotal: 24 },
    { n: "Mensure Baykan", erJan: 37, erFeb: 57, erTotal: 94, sfJan: 12, sfFeb: 20, sfTotal: 32, afJan: 7, afFeb: 6, afTotal: 13 },
  ],
  summary: {
    jan: { erstellt: 434, sf: 220, af: 158, afP: 42, at: 21, erAT: 20.7 },
    feb: { erstellt: 491, sf: 123, af: 103, afP: 46, at: 17, erAT: 28.9 },
    total: { erstellt: 925, sf: 343, af: 261 },
  },
  quellenFeb: [
    { n: "MVPP", v: 514 }, { n: "SADD", v: 274 }, { n: "Omega", v: 236 },
    { n: "Enpal - WP", v: 172 }, { n: "Eigenlead", v: 165 }, { n: "EzA", v: 67 },
  ],
  dailyFeb: [
    { d: "02.02.", t: 18, Jasmin: 3, Nadia: 3, Selin: 3, Jenny: 3, Mensure: 5, Celine: 1 },
    { d: "03.02.", t: 35, Jasmin: 8, Nadia: 6, Selin: 5, Jenny: 8, Mensure: 3, Celine: 5 },
    { d: "04.02.", t: 25, Jasmin: 5, Nadia: 3, Selin: 7, Jenny: 5, Mensure: 3, Celine: 2 },
    { d: "05.02.", t: 35, Jasmin: 10, Nadia: 6, Selin: 8, Jenny: 6, Mensure: 2, Celine: 3 },
    { d: "06.02.", t: 35, Jasmin: 10, Nadia: 4, Selin: 8, Jenny: 9, Mensure: 0, Celine: 4 },
    { d: "07.02.", t: 9, Jasmin: 0, Nadia: 9, Selin: 0, Jenny: 0, Mensure: 0, Celine: 0 },
    { d: "09.02.", t: 39, Jasmin: 7, Nadia: 8, Selin: 6, Jenny: 7, Mensure: 5, Celine: 6 },
    { d: "10.02.", t: 33, Jasmin: 8, Nadia: 8, Selin: 4, Jenny: 8, Mensure: 3, Celine: 2 },
    { d: "11.02.", t: 39, Jasmin: 10, Nadia: 5, Selin: 10, Jenny: 9, Mensure: 5, Celine: 0 },
    { d: "12.02.", t: 27, Jasmin: 4, Nadia: 10, Selin: 6, Jenny: 4, Mensure: 3, Celine: 0 },
    { d: "13.02.", t: 20, Jasmin: 3, Nadia: 5, Selin: 3, Jenny: 8, Mensure: 0, Celine: 1 },
    { d: "16.02.", t: 18, Jasmin: 6, Nadia: 3, Selin: 2, Jenny: 2, Mensure: 5, Celine: 0 },
    { d: "17.02.", t: 45, Jasmin: 8, Nadia: 11, Selin: 11, Jenny: 9, Mensure: 6, Celine: 0 },
    { d: "18.02.", t: 34, Jasmin: 6, Nadia: 7, Selin: 7, Jenny: 6, Mensure: 8, Celine: 0 },
    { d: "19.02.", t: 21, Jasmin: 8, Nadia: 5, Selin: 5, Jenny: 1, Mensure: 2, Celine: 0 },
    { d: "20.02.", t: 19, Jasmin: 8, Nadia: 6, Selin: 3, Jenny: 2, Mensure: 0, Celine: 0 },
    { d: "23.02.", t: 39, Jasmin: 11, Nadia: 11, Selin: 8, Jenny: 2, Mensure: 7, Celine: 0 },
  ],
  agentSales: [
    { n: "Nadia Kucab", b: 51, s: 8 }, { n: "Jasmin Hübner", b: 51, s: 4 },
    { n: "Selin Aylikcioglu", b: 45, s: 3 }, { n: "Jenny Litke", b: 39, s: 3 },
    { n: "Mensure Baykan", b: 32, s: 5 }, { n: "Celine Madlaine", b: 24, s: 3 },
  ],
  weekdayFeb: [
    { d: "Mo", Jasmin: 27, Nadia: 25, Selin: 19, Jenny: 14, Mensure: 22, Celine: 7, total: 114 },
    { d: "Di", Jasmin: 24, Nadia: 25, Selin: 20, Jenny: 25, Mensure: 12, Celine: 7, total: 113 },
    { d: "Mi", Jasmin: 21, Nadia: 15, Selin: 24, Jenny: 20, Mensure: 16, Celine: 2, total: 98 },
    { d: "Do", Jasmin: 22, Nadia: 21, Selin: 19, Jenny: 11, Mensure: 7, Celine: 3, total: 83 },
    { d: "Fr", Jasmin: 21, Nadia: 15, Selin: 14, Jenny: 19, Mensure: 0, Celine: 5, total: 74 },
    { d: "Sa", Jasmin: 0, Nadia: 9, Selin: 0, Jenny: 0, Mensure: 0, Celine: 0, total: 9 },
  ],
};

// ═══ ANALYSE ═══
const ANALYSE = {
  stornoQuelle: [
    { n: "Enpal - WP", brutto: 5, storno: 2, netto: 3, rate: 40 },
    { n: "MVPP", brutto: 64, storno: 16, netto: 48, rate: 25 },
    { n: "Int./Kunden", brutto: 4, storno: 1, netto: 3, rate: 25 },
    { n: "Einfach zum Angebot", brutto: 5, storno: 1, netto: 4, rate: 20 },
    { n: "Empfehlung", brutto: 21, storno: 4, netto: 17, rate: 19 },
    { n: "SADD", brutto: 17, storno: 3, netto: 14, rate: 18 },
    { n: "Eigenlead", brutto: 25, storno: 3, netto: 22, rate: 12 },
    { n: "Omega", brutto: 28, storno: 3, netto: 25, rate: 11 },
    { n: "Enpal", brutto: 1, storno: 0, netto: 1, rate: 0 },
    { n: "Bieling Empfehlung", brutto: 1, storno: 0, netto: 1, rate: 0 },
  ],
  stornoBerater: [
    { n: "Kadir Danyildiz", brutto: 4, storno: 2, rate: 50 },
    { n: "Fabian Hindenberg", brutto: 12, storno: 4, rate: 33 },
    { n: "Gino Ulitzka", brutto: 25, storno: 8, rate: 32 },
    { n: "Stefan Hensel", brutto: 16, storno: 5, rate: 31 },
    { n: "Pascal Schallenberg", brutto: 8, storno: 2, rate: 25 },
    { n: "Jannis Pfeiffer", brutto: 4, storno: 1, rate: 25 },
    { n: "Marco Bringmann", brutto: 5, storno: 1, rate: 20 },
    { n: "Tayfun Süleymaniye", brutto: 15, storno: 2, rate: 13 },
    { n: "Dimitri van Eeuwen", brutto: 9, storno: 1, rate: 11 },
    { n: "Martin Bott (Fachberater)", brutto: 10, storno: 1, rate: 10 },
    { n: "Andreas Klee", brutto: 7, storno: 0, rate: 0 },
    { n: "Nino Rimmler", brutto: 6, storno: 0, rate: 0 },
    { n: "Philipp-Torben Hannigk", brutto: 6, storno: 0, rate: 0 },
    { n: "Maxim Horten", brutto: 5, storno: 0, rate: 0 },
    { n: "Richard Winzent", brutto: 4, storno: 0, rate: 0 },
  ],
  stornoWd: [
    { d: "Mo", brutto: 45, storno: 10, rate: 22 },
    { d: "Di", brutto: 56, storno: 8, rate: 14 },
    { d: "Mi", brutto: 45, storno: 12, rate: 27 },
    { d: "Do", brutto: 39, storno: 10, rate: 26 },
    { d: "Fr", brutto: 47, storno: 12, rate: 26 },
    { d: "Sa", brutto: 24, storno: 5, rate: 21 },
  ],
  speedQuelle: [
    { n: "Eigenlead", avg: 6.8, median: 5, cnt: 24 },
    { n: "Empfehlung", avg: 6.1, median: 4, cnt: 19 },
    { n: "MVPP", avg: 10.7, median: 10, cnt: 40 },
    { n: "Omega", avg: 14.5, median: 13, cnt: 17 },
    { n: "SADD", avg: 14.6, median: 10, cnt: 5 },
    { n: "EzA", avg: 9.5, median: 12, cnt: 2 },
  ],
  afBerater: [
    { n: "Miguel Schader", sf: 2, af: 14, rate: 88 },
    { n: "Marco Bringmann", sf: 8, af: 10, rate: 56 },
    { n: "Tayfun Süleymaniye", sf: 16, af: 18, rate: 53 },
    { n: "Philipp-T. Hannigk", sf: 21, af: 22, rate: 51 },
    { n: "Pascal Meier", sf: 9, af: 9, rate: 50 },
    { n: "Patrick Kalinowski", sf: 14, af: 14, rate: 50 },
    { n: "Fabian Hindenberg", sf: 15, af: 14, rate: 48 },
    { n: "Lukas Kirschner", sf: 12, af: 11, rate: 48 },
    { n: "Nino Rimmler", sf: 17, af: 14, rate: 45 },
    { n: "Martin Bott", sf: 28, af: 23, rate: 45 },
    { n: "Stefan Hensel", sf: 20, af: 15, rate: 43 },
    { n: "Maxim Horten", sf: 22, af: 12, rate: 35 },
    { n: "Andreas Klee", sf: 20, af: 9, rate: 31 },
    { n: "Gino Ulitzka", sf: 24, af: 5, rate: 17 },
    { n: "Pascal Schallenberg", sf: 17, af: 2, rate: 11 },
    { n: "Daniel Saweljew", sf: 13, af: 1, rate: 7 },
  ],
  speicherQuelle: [
    { n: "Empfehlung", netto: 22, speicher: 9, rate: 41 },
    { n: "Omega", netto: 34, speicher: 11, rate: 32 },
    { n: "Eigenlead", netto: 32, speicher: 8, rate: 25 },
    { n: "SADD", netto: 20, speicher: 5, rate: 25 },
    { n: "MVPP", netto: 83, speicher: 17, rate: 20 },
    { n: "EzA", netto: 4, speicher: 0, rate: 0 },
  ],
  beraterQuelle: [
    { n: "Tayfun S.", MVPP: 15, Omega: 1, SADD: 1, Eigen: 1, Empf: 4, EzA: 1, total: 23 },
    { n: "Gino U.", MVPP: 8, Omega: 0, SADD: 4, Eigen: 1, Empf: 6, EzA: 1, total: 21 },
    { n: "Martin B.", MVPP: 4, Omega: 7, SADD: 1, Eigen: 1, Empf: 0, EzA: 0, total: 13 },
    { n: "Stefan H.", MVPP: 10, Omega: 0, SADD: 0, Eigen: 3, Empf: 0, EzA: 0, total: 13 },
    { n: "Nino R.", MVPP: 0, Omega: 2, SADD: 3, Eigen: 1, Empf: 4, EzA: 0, total: 11 },
    { n: "Pascal Sch.", MVPP: 0, Omega: 1, SADD: 0, Eigen: 7, Empf: 2, EzA: 0, total: 10 },
    { n: "Philipp-T. H.", MVPP: 3, Omega: 5, SADD: 0, Eigen: 0, Empf: 1, EzA: 0, total: 10 },
    { n: "Fabian H.", MVPP: 7, Omega: 1, SADD: 0, Eigen: 1, Empf: 1, EzA: 0, total: 10 },
    { n: "Miguel S.", MVPP: 6, Omega: 2, SADD: 0, Eigen: 0, Empf: 0, EzA: 0, total: 8 },
    { n: "Jannis P.", MVPP: 1, Omega: 4, SADD: 0, Eigen: 2, Empf: 1, EzA: 0, total: 8 },
    { n: "Richard W.", MVPP: 0, Omega: 0, SADD: 0, Eigen: 6, Empf: 1, EzA: 0, total: 7 },
    { n: "Hartmut S.", MVPP: 1, Omega: 3, SADD: 0, Eigen: 3, Empf: 0, EzA: 0, total: 7 },
  ],
};

// OMEGA data → see OM constant below


// ═══ TREND (Jan vs Feb) ═══
const TREND = {
  months: [
    { m: "Jan 26", leads: 4151, brutto: 199, netto: 147, storno: 52, stornoP: 26.1, umsatz: 3051607, terme_er: 1456, terme_sf: 859, af: 560, afP: 39.4, at: 21, cc: 590, andere: 866 },
    { m: "Feb 26", leads: 5597, brutto: 152, netto: 121, storno: 31, stornoP: 20.4, umsatz: 2757208, terme_er: 1530, terme_sf: 758, af: 603, afP: 79.6, at: 17, cc: 491, andere: 1039 },
  ],
  perAT: [
    { m: "Jan 26", brutto: 9.5, netto: 7.0, umsatz: 145314, terme_er: 69.3, terme_sf: 40.9 },
    { m: "Feb 26", brutto: 8.9, netto: 7.1, umsatz: 162189, terme_er: 90.0, terme_sf: 44.6 },
  ],
  topBeraterJan: [
    { n: "Gino Ulitzka", b: 25, s: 16, st: 9, e: 340895, sf: 62 },
    { n: "Tayfun Süleymaniye", b: 20, s: 16, st: 4, e: 318274, sf: 46 },
    { n: "Martin Bott", b: 16, s: 11, st: 5, e: 240937, sf: 54 },
    { n: "Stefan Hensel", b: 12, s: 7, st: 5, e: 175390, sf: 41 },
    { n: "Nino Rimmler", b: 9, s: 8, st: 1, e: 170925, sf: 50 },
    { n: "Jannis Pfeiffer", b: 9, s: 6, st: 3, e: 135190, sf: 26 },
    { n: "Richard Winzent", b: 8, s: 7, st: 1, e: 136800, sf: 28 },
    { n: "Fabian Hindenberg", b: 8, s: 7, st: 1, e: 134229, sf: 33 },
    { n: "Philipp-T. Hannigk", b: 8, s: 7, st: 1, e: 139000, sf: 40 },
    { n: "Pascal Schallenberg", b: 8, s: 6, st: 2, e: 135395, sf: 46 },
  ],
  topBeraterFeb: [
    { n: "Gino Ulitzka", b: 24, s: 16, st: 8, e: 390740, sf: 51 },
    { n: "Stefan Hensel", b: 14, s: 10, st: 4, e: 246103, sf: 43 },
    { n: "Tayfun Süleymaniye", b: 14, s: 12, st: 2, e: 277290, sf: 29 },
    { n: "Dimitri van Eeuwen", b: 9, s: 8, st: 1, e: 195617, sf: 28 },
    { n: "Maxim Horten", b: 3, s: 3, st: 0, e: 60345, sf: 18 },
    { n: "Pascal Schallenberg", b: 3, s: 2, st: 1, e: 73995, sf: 15 },
    { n: "Andreas Klee", b: 2, s: 2, st: 0, e: 71735, sf: 11 },
    { n: "Martin Bott", b: 2, s: 2, st: 0, e: 41600, sf: 19 },
  ],
  leadQuellen: [
    { q: "SADD", jan: 2338, feb: 1082 },
    { q: "MVPP", jan: 757, feb: 323 },
    { q: "Enpal", jan: 208, feb: 897 },
    { q: "Eigenlead", jan: 206, feb: 140 },
    { q: "EzA", jan: 337, feb: 162 },
    { q: "Omega", jan: 219, feb: 92 },
    { q: "Empfehlung", jan: 40, feb: 13 },
  ],
};

// ═══ ENPAL (dedup) ═══
const ENPAL = {
  // LMT Leads
  jan: { leads: 211, wp: 75, kl: 133, term: 9, ang: 6, rekl: 102, ne: 51 },
  feb: { leads: 973, wp: 915, kl: 58, term: 76, ang: 10, rekl: 317, ne5: 189, ne: 180, wvl: 107 },
  total: { leads: 1184 },
  // Termine Created
  terme: 108, termeWP: 98, termeKl: 10,
  termeAbg: 10, termeAF: 14, termeOffen: 84,
  sales: 1, salesNetto: 30195,
  // Daily lead import Feb
  dailyImport: [
    { d: "02.02.", wp: 164, kl: 5, t: 169 },
    { d: "03.02.", wp: 96, kl: 5, t: 101 },
    { d: "04.02.", wp: 73, kl: 15, t: 88 },
    { d: "05.02.", wp: 102, kl: 6, t: 108 },
    { d: "06.02.", wp: 60, kl: 9, t: 69 },
    { d: "07.02.", wp: 41, kl: 1, t: 42 },
    { d: "09.02.", wp: 82, kl: 2, t: 84 },
    { d: "10.02.", wp: 88, kl: 4, t: 92 },
    { d: "11.02.", wp: 125, kl: 5, t: 130 },
    { d: "12.02.", wp: 84, kl: 5, t: 89 },
  ],
  // Daily termine erstellt Feb
  dailyErstellt: [
    { d: "02.02.", wp: 0, kl: 2, t: 2 },
    { d: "03.02.", wp: 18, kl: 0, t: 18 },
    { d: "04.02.", wp: 8, kl: 2, t: 10 },
    { d: "05.02.", wp: 18, kl: 1, t: 19 },
    { d: "06.02.", wp: 7, kl: 3, t: 10 },
    { d: "07.02.", wp: 5, kl: 1, t: 6 },
    { d: "09.02.", wp: 11, kl: 0, t: 11 },
    { d: "10.02.", wp: 3, kl: 0, t: 3 },
    { d: "11.02.", wp: 14, kl: 1, t: 15 },
    { d: "12.02.", wp: 14, kl: 0, t: 14 },
  ],
  // Termine pro Tag (DatumTermin Beginn) – Vergangenheit+Zukunft
  dailyTermine: [
    { d: "03.02.", t: 1, abg: 0, af: 1, offen: 0 },
    { d: "05.02.", t: 1, abg: 1, af: 0, offen: 0 },
    { d: "09.02.", t: 3, abg: 2, af: 0, offen: 1 },
    { d: "10.02.", t: 3, abg: 2, af: 1, offen: 0 },
    { d: "11.02.", t: 5, abg: 2, af: 1, offen: 2 },
    { d: "12.02.", t: 7, abg: 3, af: 2, offen: 2 },
    { d: "13.02.", t: 5, abg: 0, af: 0, offen: 5 },
    { d: "14.02.", t: 1, abg: 0, af: 0, offen: 1 },
    { d: "16.02.", t: 8, abg: 0, af: 1, offen: 7 },
    { d: "17.02.", t: 9, abg: 0, af: 3, offen: 6 },
    { d: "18.02.", t: 7, abg: 0, af: 2, offen: 5 },
    { d: "19.02.", t: 6, abg: 0, af: 0, offen: 6 },
    { d: "20.02.", t: 10, abg: 0, af: 0, offen: 10 },
    { d: "21.02.", t: 2, abg: 0, af: 0, offen: 2 },
    { d: "23.02.", t: 5, abg: 0, af: 2, offen: 3 },
    { d: "24.02.", t: 8, abg: 0, af: 1, offen: 7 },
    { d: "25.02.", t: 5, abg: 0, af: 0, offen: 5 },
    { d: "26.02.", t: 7, abg: 0, af: 0, offen: 7 },
    { d: "27.02.", t: 6, abg: 0, af: 0, offen: 6 },
    { d: "28.02.", t: 1, abg: 0, af: 0, offen: 1 },
  ],
  leadStatus: [
    { name: "REKLAMATION", v: 317, fill: C.red }, { name: "5× nicht err.", v: 189, fill: "#D29922" },
    { name: "nicht erreicht", v: 180, fill: C.orange }, { name: "WVL", v: 107, fill: C.blue },
    { name: "Terminiert", v: 76, fill: C.green }, { name: "Nicht im PLZ", v: 49, fill: C.purple },
    { name: "Angebot", v: 10, fill: C.cyan }, { name: "Sonstige", v: 45, fill: C.dim },
  ],
  berater: [
    { n: "Gino Ulitzka", t: 20 }, { n: "Janik Voß", t: 14 }, { n: "Patrick Kalinowski", t: 13 },
    { n: "Andreas Klee", t: 12 }, { n: "Bernd Krahwinkel", t: 11 }, { n: "Kadir Danyildiz", t: 8 },
    { n: "Maxim Horten", t: 5 }, { n: "Fabian Hindenberg", t: 4 }, { n: "Sonstige", t: 21 },
  ],
  terminierer: [
    { n: "Jasmin Hübner", t: 24 }, { n: "Nadia Kucab", t: 22 }, { n: "Selin Aylikcioglu", t: 20 },
    { n: "Jenny Litke", t: 19 }, { n: "Celine Madlaine", t: 10 }, { n: "Mensure Baykan", t: 5 },
    { n: "Sonstige (VB)", t: 8 },
  ],
  // Abschluss-Ergebnisse der 10 stattgef.
  abschluss: [
    { n: "WVL Überleger", v: 3 }, { n: "WVL Frau nicht da", v: 2 }, { n: "Kein Interesse", v: 2 },
    { n: "Sale", v: 1 }, { n: "WVL Gegenangebot", v: 1 }, { n: "T.n.M. Dachbelag", v: 1 },
  ],
  // CC Agent Enpal-spezifische Conversion (LMT Feb)
  ccEnpal: [
    { n: "Selin Aylikcioglu", leads: 89, term: 16, rekl: 44, rate: 18.0, reklP: 49 },
    { n: "Jasmin Hübner", leads: 72, term: 11, rekl: 46, rate: 15.3, reklP: 64 },
    { n: "Jenny Litke", leads: 116, term: 16, rekl: 50, rate: 13.8, reklP: 43 },
    { n: "Celine Madlaine", leads: 38, term: 5, rekl: 21, rate: 13.2, reklP: 55 },
    { n: "Nadia Kucab", leads: 161, term: 16, rekl: 103, rate: 9.9, reklP: 64 },
    { n: "Mensure Baykan", leads: 85, term: 4, rekl: 32, rate: 4.7, reklP: 38 },
  ],
  // Lead→Termin Speed (Stunden)
  speed: {
    median: 18.6, avg: 42.3, matches: 108,
    unter24h: 60, unter24hP: 56, unter48h: 86, unter48hP: 80, ueber72h: 10,
    buckets: [
      { n: "<4h", v: 0 }, { n: "4–12h", v: 6 }, { n: "12–24h", v: 54 },
      { n: "24–48h", v: 26 }, { n: "48–72h", v: 12 }, { n: ">72h", v: 10 },
    ],
  },
  // Pipeline: WVL + NE nachfassbar
  pipeline: {
    wvl: 107, wvlU3d: 34, wvl3to7d: 21, wvlU7d: 52, wvlAvg: 5,
    ne: 180, ne5: 189, neTotal: 369, neU3d: 93, ne3to7d: 85, neU7d: 191, neAvg: 6,
  },
  // Benchmark: Enpal vs MVPP vs Gesamt
  benchmark: [
    { n: "MVPP", leads: 351, term: 184, termP: 52.4, rekl: 5, reklP: 1.4, color: "#6366F1" },
    { n: "Gesamt", leads: 3569, term: 623, termP: 17.5, rekl: 770, reklP: 21.6, color: "#94A3B8" },
    { n: "Enpal", leads: 973, term: 86, termP: 8.8, rekl: 317, reklP: 32.6, color: "#F97316" },
  ],
  // Wochentag
  wochentag: [
    { d: "Mo", t: 16, abg: 2, af: 3, offen: 11 }, { d: "Di", t: 21, abg: 2, af: 6, offen: 13 },
    { d: "Mi", t: 17, abg: 2, af: 3, offen: 12 }, { d: "Do", t: 21, abg: 4, af: 2, offen: 15 },
    { d: "Fr", t: 21, abg: 0, af: 0, offen: 21 }, { d: "Sa", t: 4, abg: 0, af: 0, offen: 4 },
  ],
  // PLZ-Gebiete (Top 12 mit ≥25 Leads)
  plz: [
    { n: "41xxx", leads: 43, term: 6, rate: 14.0 }, { n: "44xxx", leads: 51, term: 7, rate: 13.7 },
    { n: "51xxx", leads: 30, term: 4, rate: 13.3 }, { n: "40xxx", leads: 31, term: 4, rate: 12.9 },
    { n: "53xxx", leads: 36, term: 4, rate: 11.1 }, { n: "42xxx", leads: 29, term: 3, rate: 10.3 },
    { n: "47xxx", leads: 29, term: 3, rate: 10.3 }, { n: "35xxx", leads: 83, term: 8, rate: 9.6 },
    { n: "45xxx", leads: 45, term: 4, rate: 8.9 }, { n: "52xxx", leads: 34, term: 3, rate: 8.8 },
    { n: "27xxx", leads: 47, term: 4, rate: 8.5 }, { n: "26xxx", leads: 136, term: 8, rate: 5.9 },
    { n: "28xxx", leads: 69, term: 3, rate: 4.3 }, { n: "49xxx", leads: 65, term: 1, rate: 1.5 },
  ],
  // AF-Gründe
  afGruende: [
    { n: "Kein Interesse", v: 5 }, { n: "Techn. ungeeignet", v: 3 },
    { n: "Anderer Anbieter", v: 2 }, { n: "Sprachprobleme", v: 1 }, { n: "Sonstige", v: 3 },
  ],
};

// ═══ SCOUTER (MVPP Außendienst) ═══
// Kosten: (3.000€ Brutto + Bonus) × 1,21 AG × 1,12 Urlaub + Auto (individuell)
// Bonus = 10€/Lead (LMT Feb) + 40€/SF (Scouty+Closed) + 200€/Sale
const SCOUTER_MONTHLY = {
  jan: [
    { n: "Thomas Herrmann", typ: "A", leads: 166, sales: 5, sf: 0, auto: 0, kosten: 5759 },
    { n: "Fabian Ricken", typ: "A", leads: 63, sales: 4, sf: 0, auto: 1000, kosten: 6421 },
    { n: "Robin Kricke", typ: "A", leads: 80, sales: 7, sf: 0, auto: 450, kosten: 6888 },
    { n: "Cinar Onk", typ: "A", leads: 112, sales: 1, sf: 0, auto: 0, kosten: 4404 },
    { n: "Norbert Pap", typ: "A", leads: 45, sales: 2, sf: 0, auto: 0, kosten: 4743 },
    { n: "Anmar Ashraf", typ: "HGB", leads: 46, sales: 1, sf: 0, auto: 0, kosten: 200 },
    { n: "Ayhan Celik", typ: "A", leads: 62, sales: 2, sf: 0, auto: 0, kosten: 4743 },
    { n: "Selçuk Özkaya", typ: "A", leads: 36, sales: 8, sf: 0, auto: 1000, kosten: 7776 },
    { n: "Alexander Luxat", typ: "A", leads: 0, sales: 0, sf: 0, auto: 1000, kosten: 5066 },
    { n: "Christian Neukirch", typ: "A", leads: 11, sales: 4, sf: 0, auto: 0, kosten: 5421 },
    { n: "Danilo Duric", typ: "HGB", leads: 34, sales: 0, sf: 0, auto: 0, kosten: 0 },
    { n: "Constanze Hamm-Schaub", typ: "HGB", leads: 11, sales: 7, sf: 0, auto: 0, kosten: 1400 },
    { n: "Dilara Durgun", typ: "HGB", leads: 3, sales: 0, sf: 0, auto: 0, kosten: 0 },
  ],
  feb: [
    { n: "Thomas Herrmann", typ: "A", leads: 62, sales: 5, sf: 5, er: 46, scouty: 37, cc: 9, afRate: 22, auto: 0, kosten: 5759 },
    { n: "Fabian Ricken", typ: "A", leads: 39, sales: 2, sf: 1, er: 40, scouty: 35, cc: 5, afRate: 12, auto: 1000, kosten: 5743 },
    { n: "Robin Kricke", typ: "A", leads: 20, sales: 6, sf: 8, er: 32, scouty: 26, cc: 6, afRate: 28, auto: 450, kosten: 6548 },
    { n: "Cinar Onk", typ: "A", leads: 46, sales: 1, sf: 5, er: 27, scouty: 20, cc: 7, afRate: 30, auto: 0, kosten: 4404 },
    { n: "Norbert Pap", typ: "A", leads: 21, sales: 0, sf: 0, er: 26, scouty: 25, cc: 1, afRate: 50, auto: 0, kosten: 4066 },
    { n: "Anmar Ashraf", typ: "HGB", leads: 29, sales: 4, sf: 3, er: 26, scouty: 23, cc: 3, afRate: 8, auto: 0, kosten: 1100 },
    { n: "Ayhan Celik", typ: "A", leads: 19, sales: 1, sf: 3, er: 21, scouty: 17, cc: 4, afRate: 38, auto: 0, kosten: 4404 },
    { n: "Selçuk Özkaya", typ: "A", leads: 32, sales: 3, sf: 0, er: 20, scouty: 19, cc: 1, afRate: 20, auto: 1000, kosten: 6083 },
    { n: "Alexander Luxat", typ: "A", leads: 47, sales: 1, sf: 2, er: 19, scouty: 14, cc: 5, afRate: 5, auto: 1000, kosten: 5404 },
    { n: "Christian Neukirch", typ: "A", leads: 8, sales: 3, sf: 2, er: 10, scouty: 8, cc: 2, afRate: 10, auto: 0, kosten: 5083 },
    { n: "Danilo Duric", typ: "HGB", leads: 14, sales: 0, sf: 0, er: 10, scouty: 9, cc: 1, afRate: 40, auto: 0, kosten: 0 },
    { n: "Constanze Hamm-Schaub", typ: "HGB", leads: 4, sales: 0, sf: 1, er: 5, scouty: 3, cc: 2, afRate: 20, auto: 0, kosten: 100 },
    { n: "Dilara Durgun", typ: "HGB", leads: 5, sales: 0, sf: 2, er: 4, scouty: 4, cc: 0, afRate: 0, auto: 0, kosten: 200 },
  ],
};
// Total = sum of Jan + Feb per scouter
SCOUTER_MONTHLY.total = SCOUTER_MONTHLY.jan.map((j, i) => {
  const f = SCOUTER_MONTHLY.feb[i];
  return { n: j.n, typ: j.typ, leads: j.leads+f.leads, sales: j.sales+f.sales, sf: j.sf+(f.sf||0), auto: j.auto+f.auto, kosten: j.kosten+f.kosten, er: f.er||0, scouty: f.scouty||0, cc: f.cc||0, afRate: f.afRate||0 };
});
const sumData = (arr) => arr.reduce((a,s) => ({ leads: a.leads+s.leads, sales: a.sales+s.sales, sf: a.sf+s.sf, kosten: a.kosten+s.kosten, auto: a.auto+s.auto, er: a.er+(s.er||0), scouty: a.scouty+(s.scouty||0), cc: a.cc+(s.cc||0) }), { leads:0, sales:0, sf:0, kosten:0, auto:0, er:0, scouty:0, cc:0 });

// ═══ VERTRIEBLER ═══
// Angestellte: 3.000€ Gehalt + Provision (0-7 Sales: 500€/Sale, 8+: 700€/Sale rückwirkend) + Eigenlead 400€ + Empfehlung 300€ + Speicher 150€
// Alles (Gehalt+Bonus) × 1,21 AG × 1,12 Urlaub + Auto (individuell, nicht alle)
// HGB: 200€/Sale + 50€/EzA-Lead
const VB_MONTHLY = {
  jan: [
    { n: "Kadir Danyildiz", typ: "A", sales: 1, eigenlead: 0, empfehlung: 0, speicher: 0, vbK: 4743, scK: 0, kosten: 4743, mvppAng: 0, omega: 0, sadd: 1, other: 0 },
    { n: "Maximilian Koch", typ: "A", sales: 1, eigenlead: 0, empfehlung: 0, speicher: 0, vbK: 4743, scK: 1152, kosten: 5895, mvppAng: 1, omega: 0, sadd: 0, other: 0 },
    { n: "Jannis Pfeiffer", typ: "A", sales: 6, eigenlead: 1, empfehlung: 1, speicher: 4, vbK: 10893, scK: 0, kosten: 10893, mvppAng: 0, omega: 4, sadd: 0, other: 0 },
    { n: "Miguel Schader", typ: "A", sales: 7, eigenlead: 0, empfehlung: 0, speicher: 5, vbK: 10825, scK: 7860, kosten: 18685, mvppAng: 4, omega: 2, sadd: 0, other: 1 },
    { n: "Bernd Krahwinkel", typ: "A", sales: 5, eigenlead: 0, empfehlung: 0, speicher: 0, vbK: 8454, scK: 3936, kosten: 12390, mvppAng: 4, omega: 1, sadd: 0, other: 0 },
    { n: "Pascal Meier", typ: "A", sales: 3, eigenlead: 0, empfehlung: 0, speicher: 0, vbK: 7098, scK: 0, kosten: 7098, mvppAng: 0, omega: 0, sadd: 0, other: 3 },
    { n: "Andreas Klee", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Christian Seifert", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Christoph Held", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Daniel Saweljew", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Dimitri van Eeuwen", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Fabian Hindenberg", typ: "HGB", sales: 5, kosten: 1000 },
    { n: "Farshad Nourouzi", typ: "HGB", sales: 4, kosten: 800 },
    { n: "Frank Reddig", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Gino Ulitzka", typ: "HGB", sales: 16, eza: 1, kosten: 3250 },
    { n: "Hartmut Seitz", typ: "HGB", sales: 5, kosten: 1000 },
    { n: "Janik Voß", typ: "HGB", sales: 4, kosten: 800 },
    { n: "Kevin Kraus", typ: "HGB", sales: 0, kosten: 0 },
    { n: "Klaus Vollmer", typ: "HGB", sales: 7, kosten: 1400 },
    { n: "Lukas Kirschner", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Marco Bringmann", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Martin Bott", typ: "HGB", sales: 11, kosten: 2200 },
    { n: "Martin Bott (FB)", typ: "HGB", sales: 0, kosten: 0 },
    { n: "Maxim Horten", typ: "HGB", sales: 3, eza: 1, kosten: 650 },
    { n: "Nils Horn", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Nino Rimmler", typ: "HGB", sales: 8, kosten: 1600 },
    { n: "Pascal Schallenberg", typ: "HGB", sales: 6, kosten: 1200 },
    { n: "Patrick Kalinowski", typ: "HGB", sales: 2, eza: 1, kosten: 450 },
    { n: "Philipp-Torben Hannigk", typ: "HGB", sales: 7, kosten: 1400 },
    { n: "Richard Winzent", typ: "HGB", sales: 7, kosten: 1400 },
    { n: "Stefan Hensel", typ: "HGB", sales: 7, kosten: 1400 },
    { n: "Tayfun Süleymaniye", typ: "HGB", sales: 15, kosten: 3000 },
  ],
  feb: [
    { n: "Kadir Danyildiz", typ: "A", sales: 1, eigenlead: 0, empfehlung: 0, speicher: 0, vbK: 4743, scK: 5404, kosten: 10147, mvppAng: 1, omega: 0, sadd: 0, other: 0 },
    { n: "Maximilian Koch", typ: "A", sales: 2, eigenlead: 0, empfehlung: 0, speicher: 1, vbK: 5625, scK: 2304, kosten: 7929, mvppAng: 2, omega: 0, sadd: 0, other: 0 },
    { n: "Jannis Pfeiffer", typ: "A", sales: 2, eigenlead: 1, empfehlung: 0, speicher: 1, vbK: 7167, scK: 1152, kosten: 8319, mvppAng: 1, omega: 0, sadd: 0, other: 0 },
    { n: "Miguel Schader", typ: "A", sales: 1, eigenlead: 0, empfehlung: 0, speicher: 1, vbK: 5946, scK: 1152, kosten: 7098, mvppAng: 1, omega: 0, sadd: 0, other: 0 },
    { n: "Bernd Krahwinkel", typ: "A", sales: 1, eigenlead: 1, empfehlung: 0, speicher: 0, vbK: 6285, scK: 0, kosten: 6285, mvppAng: 0, omega: 0, sadd: 0, other: 0 },
    { n: "Pascal Meier", typ: "A", sales: 1, eigenlead: 0, empfehlung: 0, speicher: 0, vbK: 5743, scK: 0, kosten: 5743, mvppAng: 0, omega: 0, sadd: 0, other: 1 },
    { n: "Andreas Klee", typ: "HGB", sales: 3, kosten: 600 },
    { n: "Christian Seifert", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Christoph Held", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Daniel Saweljew", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Dimitri van Eeuwen", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Fabian Hindenberg", typ: "HGB", sales: 5, kosten: 1000 },
    { n: "Farshad Nourouzi", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Frank Reddig", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Gino Ulitzka", typ: "HGB", sales: 5, kosten: 1000 },
    { n: "Hartmut Seitz", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Janik Voß", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Kevin Kraus", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Klaus Vollmer", typ: "HGB", sales: 0, kosten: 0 },
    { n: "Lukas Kirschner", typ: "HGB", sales: 0, kosten: 0 },
    { n: "Marco Bringmann", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Martin Bott", typ: "HGB", sales: 2, kosten: 400 },
    { n: "Martin Bott (FB)", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Maxim Horten", typ: "HGB", sales: 4, kosten: 800 },
    { n: "Nils Horn", typ: "HGB", sales: 0, kosten: 0 },
    { n: "Nino Rimmler", typ: "HGB", sales: 3, kosten: 600 },
    { n: "Pascal Schallenberg", typ: "HGB", sales: 4, kosten: 800 },
    { n: "Patrick Kalinowski", typ: "HGB", sales: 1, kosten: 200 },
    { n: "Philipp-Torben Hannigk", typ: "HGB", sales: 3, kosten: 600 },
    { n: "Richard Winzent", typ: "HGB", sales: 0, kosten: 0 },
    { n: "Stefan Hensel", typ: "HGB", sales: 6, kosten: 1200 },
    { n: "Tayfun Süleymaniye", typ: "HGB", sales: 8, eza: 1, kosten: 1650 },
  ],
};
VB_MONTHLY.total = VB_MONTHLY.jan.map((j, i) => {
  const f = VB_MONTHLY.feb[i];
  return { n: j.n, typ: j.typ, sales: j.sales+f.sales, kosten: j.kosten+f.kosten, vbK: (j.vbK||0)+(f.vbK||0), scK: (j.scK||0)+(f.scK||0), eigenlead: (j.eigenlead||0)+(f.eigenlead||0), empfehlung: (j.empfehlung||0)+(f.empfehlung||0), speicher: (j.speicher||0)+(f.speicher||0), mvppAng: (j.mvppAng||0)+(f.mvppAng||0), omega: (j.omega||0)+(f.omega||0), sadd: (j.sadd||0)+(f.sadd||0), other: (j.other||0)+(f.other||0) };
});
const sumVB = (arr) => arr.reduce((a,s) => ({ sales: a.sales+s.sales, kosten: a.kosten+s.kosten }), { sales:0, kosten:0 });


// ═══ ANGESTELLTE (Combined) ═══
const ANG_DATA = {
  jan: {
    scouter: [
      { n: "Selçuk Özkaya", leads: 36, genSales: 8, sf: 0, auto: 1000, kosten: 7776, kpg: 972 },
      { n: "Robin Kricke", leads: 80, genSales: 7, sf: 0, auto: 450, kosten: 6888, kpg: 984 },
      { n: "Thomas Herrmann", leads: 166, genSales: 5, sf: 0, auto: 0, kosten: 5759, kpg: 1152 },
      { n: "Christian Neukirch", leads: 11, genSales: 4, sf: 0, auto: 0, kosten: 5421, kpg: 1355 },
      { n: "Fabian Ricken", leads: 63, genSales: 4, sf: 0, auto: 1000, kosten: 6421, kpg: 1605 },
      { n: "Ayhan Celik", leads: 62, genSales: 2, sf: 0, auto: 0, kosten: 4743, kpg: 2372 },
      { n: "Norbert Pap", leads: 45, genSales: 2, sf: 0, auto: 0, kosten: 4743, kpg: 2372 },
      { n: "Cinar Onk", leads: 112, genSales: 1, sf: 0, auto: 0, kosten: 4404, kpg: 4404 },
      { n: "Alexander Luxat", leads: 0, genSales: 0, sf: 0, auto: 1000, kosten: 5066, kpg: 0 },
    ],
    vb: [
      { n: "Kadir Danyildiz", leads: 18, sales: 1, el: 0, emp: 0, sp: 0, vbK: 4743, scK: 0, kosten: 4743, mvppAng: 0, omega: 0, sadd: 1, other: 0, auto: 0 },
      { n: "Maximilian Koch", leads: 17, sales: 1, el: 0, emp: 0, sp: 0, vbK: 4743, scK: 1152, kosten: 5895, mvppAng: 1, omega: 0, sadd: 0, other: 0, auto: 0 },
      { n: "Jannis Pfeiffer", leads: 10, sales: 6, el: 1, emp: 1, sp: 4, vbK: 10893, scK: 0, kosten: 10893, mvppAng: 0, omega: 4, sadd: 0, other: 0, auto: 1000 },
      { n: "Miguel Schader", leads: 2, sales: 7, el: 0, emp: 0, sp: 5, vbK: 10825, scK: 7860, kosten: 18685, mvppAng: 4, omega: 2, sadd: 0, other: 1, auto: 1000 },
      { n: "Bernd Krahwinkel", leads: 7, sales: 5, el: 0, emp: 0, sp: 0, vbK: 8454, scK: 3936, kosten: 12390, mvppAng: 4, omega: 1, sadd: 0, other: 0, auto: 1000 },
      { n: "Pascal Meier", leads: 7, sales: 3, el: 0, emp: 0, sp: 0, vbK: 7098, scK: 0, kosten: 7098, mvppAng: 0, omega: 0, sadd: 0, other: 3, auto: 1000 },
    ],
  },
  feb: {
    scouter: [
      { n: "Robin Kricke", leads: 20, genSales: 6, sf: 8, auto: 450, kosten: 6548, kpg: 1091 },
      { n: "Thomas Herrmann", leads: 62, genSales: 5, sf: 5, auto: 0, kosten: 5759, kpg: 1152 },
      { n: "Christian Neukirch", leads: 8, genSales: 3, sf: 2, auto: 0, kosten: 5083, kpg: 1694 },
      { n: "Selçuk Özkaya", leads: 32, genSales: 3, sf: 0, auto: 1000, kosten: 6083, kpg: 2028 },
      { n: "Fabian Ricken", leads: 39, genSales: 2, sf: 1, auto: 1000, kosten: 5743, kpg: 2872 },
      { n: "Ayhan Celik", leads: 19, genSales: 1, sf: 3, auto: 0, kosten: 4404, kpg: 4404 },
      { n: "Alexander Luxat", leads: 47, genSales: 1, sf: 2, auto: 1000, kosten: 5404, kpg: 5404 },
      { n: "Cinar Onk", leads: 46, genSales: 1, sf: 5, auto: 0, kosten: 4404, kpg: 4404 },
      { n: "Norbert Pap", leads: 21, genSales: 0, sf: 0, auto: 0, kosten: 4066, kpg: 0 },
    ],
    vb: [
      { n: "Kadir Danyildiz", leads: 9, sales: 1, el: 0, emp: 0, sp: 0, vbK: 4743, scK: 5404, kosten: 10147, mvppAng: 1, omega: 0, sadd: 0, other: 0, auto: 0 },
      { n: "Maximilian Koch", leads: 3, sales: 2, el: 0, emp: 0, sp: 1, vbK: 5625, scK: 2304, kosten: 7929, mvppAng: 2, omega: 0, sadd: 0, other: 0, auto: 0 },
      { n: "Jannis Pfeiffer", leads: 3, sales: 2, el: 1, emp: 0, sp: 1, vbK: 7167, scK: 1152, kosten: 8319, mvppAng: 1, omega: 0, sadd: 0, other: 0, auto: 1000 },
      { n: "Miguel Schader", leads: 2, sales: 1, el: 0, emp: 0, sp: 1, vbK: 5946, scK: 1152, kosten: 7098, mvppAng: 1, omega: 0, sadd: 0, other: 0, auto: 1000 },
      { n: "Bernd Krahwinkel", leads: 8, sales: 1, el: 1, emp: 0, sp: 0, vbK: 6285, scK: 0, kosten: 6285, mvppAng: 0, omega: 0, sadd: 0, other: 0, auto: 1000 },
      { n: "Pascal Meier", leads: 1, sales: 1, el: 0, emp: 0, sp: 0, vbK: 5743, scK: 0, kosten: 5743, mvppAng: 0, omega: 0, sadd: 0, other: 1, auto: 1000 },
    ],
  },
};
ANG_DATA.total = {
  scouter: ANG_DATA.jan.scouter.map((j, i) => {
    const f = ANG_DATA.feb.scouter[i];
    return { n: j.n, leads: j.leads+f.leads, genSales: j.genSales+f.genSales, sf: (j.sf||0)+(f.sf||0), auto: j.auto, kosten: j.kosten+f.kosten, kpg: (j.genSales+f.genSales) > 0 ? Math.round((j.kosten+f.kosten)/(j.genSales+f.genSales)) : 0 };
  }),
  vb: ANG_DATA.jan.vb.map((j, i) => {
    const f = ANG_DATA.feb.vb[i];
    return { n: j.n, leads: j.leads+f.leads, sales: j.sales+f.sales, el: j.el+f.el, emp: j.emp+f.emp, sp: j.sp+f.sp, vbK: j.vbK+f.vbK, scK: j.scK+f.scK, kosten: j.kosten+f.kosten, mvppAng: j.mvppAng+f.mvppAng, omega: j.omega+f.omega, sadd: j.sadd+f.sadd, other: j.other+f.other, auto: j.auto };
  }),
};

// Old SCOUTER_TOTAL removed - now using SCOUTER_MONTHLY + sumData()

// ═══ LMT LEAD DATA (7.720 Leads aus LMT-Export) ═══
const LMT = {
  jan: {
    total: 4151,
    quellen: [
      { q: "SADD", t: 2338, term: 80, ang: 75, ab: 4, nplz: 1112, rekl: 427, ne5: 424, ne: 40, wvl: 124, ki: 13, neu: 2 },
      { q: "MVPP", t: 757, term: 177, ang: 99, ab: 25, nplz: 0, rekl: 3, ne5: 125, ne: 30, wvl: 75, ki: 164, neu: 1 },
      { q: "Einfach zum Angebot", t: 337, term: 28, ang: 26, ab: 1, nplz: 18, rekl: 135, ne5: 69, ne: 7, wvl: 45, ki: 1, neu: 0 },
      { q: "Omega", t: 219, term: 45, ang: 70, ab: 7, nplz: 0, rekl: 12, ne5: 0, ne: 2, wvl: 3, ki: 0, neu: 87 },
      { q: "Eigenlead", t: 206, term: 95, ang: 47, ab: 18, nplz: 0, rekl: 1, ne5: 5, ne: 11, wvl: 8, ki: 8, neu: 24 },
      { q: "Enpal", t: 133, term: 8, ang: 6, ab: 0, nplz: 3, rekl: 60, ne5: 21, ne: 3, wvl: 23, ki: 0, neu: 0 },
      { q: "Enpal - WP", t: 75, term: 1, ang: 0, ab: 0, nplz: 1, rekl: 39, ne5: 25, ne: 2, wvl: 2, ki: 0, neu: 0 },
      { q: "Empfehlung", t: 40, term: 22, ang: 17, ab: 14, nplz: 0, rekl: 0, ne5: 0, ne: 0, wvl: 0, ki: 0, neu: 0 },
      { q: "Int./Kunden", t: 34, term: 12, ang: 4, ab: 3, nplz: 2, rekl: 6, ne5: 0, ne: 2, wvl: 0, ki: 0, neu: 7 },
      { q: "Angebots-guru", t: 8, term: 2, ang: 0, ab: 0, nplz: 4, rekl: 1, ne5: 0, ne: 0, wvl: 1, ki: 0, neu: 0 },
    ],
    cc: [
      { n: "Celine Madlaine", t: 237, term: 12, ang: 14, ab: 1, nplz: 79, rekl: 54, ne5: 1 },
      { n: "Jasmin Hübner", t: 238, term: 19, ang: 18, ab: 1, nplz: 36, rekl: 103, ne5: 4 },
      { n: "Jenny Litke", t: 509, term: 11, ang: 14, ab: 1, nplz: 304, rekl: 107, ne5: 1 },
      { n: "Mensure Baykan", t: 255, term: 14, ang: 11, ab: 0, nplz: 128, rekl: 47, ne5: 0 },
      { n: "Nadia Kucab", t: 656, term: 29, ang: 17, ab: 2, nplz: 245, rekl: 176, ne5: 1 },
      { n: "Selin Aylikcioglu", t: 576, term: 32, ang: 16, ab: 2, nplz: 304, rekl: 139, ne5: 0 },
    ],
    scouter: [
      { n: "Thomas Herrmann", t: 166, term: 20, ang: 15, ab: 3, rekl: 1, ne5: 43, ne: 9, wvl: 17 },
      { n: "Cinar Onk", t: 112, term: 13, ang: 7, ab: 1, rekl: 0, ne5: 29, ne: 3, wvl: 13 },
      { n: "Robin Kricke", t: 80, term: 18, ang: 21, ab: 6, rekl: 0, ne5: 7, ne: 1, wvl: 18 },
      { n: "Fabian Ricken", t: 63, term: 14, ang: 15, ab: 1, rekl: 0, ne5: 5, ne: 6, wvl: 6 },
      { n: "Ayhan Celik", t: 62, term: 19, ang: 4, ab: 0, rekl: 0, ne5: 8, ne: 1, wvl: 8 },
      { n: "Norbert Pap", t: 45, term: 20, ang: 6, ab: 0, rekl: 0, ne5: 1, ne: 1, wvl: 0 },
      { n: "Selçuk Özkaya", t: 36, term: 14, ang: 4, ab: 2, rekl: 1, ne5: 5, ne: 1, wvl: 4 },
      { n: "Christian Neukirch", t: 11, term: 5, ang: 3, ab: 2, rekl: 0, ne5: 1, ne: 1, wvl: 0 },
      { n: "Alexander Luxat", t: 0, term: 0, ang: 0, ab: 0, rekl: 0, ne5: 0, ne: 0, wvl: 0 },
    ],
  },
  feb: {
    total: 5597,
    quellen: [
      { q: "SADD", t: 1837, term: 144, ang: 38, ab: 6, nplz: 825, rekl: 343, ne5: 242, ne: 79, wvl: 136, ki: 11, neu: 1 },
      { q: "Enpal - WP", t: 1795, term: 96, ang: 27, ab: 5, nplz: 131, rekl: 572, ne5: 425, ne: 264, wvl: 179, ki: 34, neu: 45 },
      { q: "MVPP", t: 564, term: 232, ang: 40, ab: 21, nplz: 0, rekl: 7, ne5: 33, ne: 27, wvl: 76, ki: 98, neu: 8 },
      { q: "beedoo", t: 494, term: 2, ang: 1, ab: 0, nplz: 8, rekl: 183, ne5: 0, ne: 268, wvl: 18, ki: 8, neu: 0 },
      { q: "Einfach zum Angebot", t: 295, term: 34, ang: 5, ab: 1, nplz: 26, rekl: 98, ne5: 62, ne: 23, wvl: 36, ki: 3, neu: 6 },
      { q: "Eigenlead", t: 203, term: 86, ang: 34, ab: 15, nplz: 0, rekl: 0, ne5: 0, ne: 21, wvl: 6, ki: 12, neu: 24 },
      { q: "Omega", t: 155, term: 123, ang: 16, ab: 6, nplz: 0, rekl: 8, ne5: 0, ne: 1, wvl: 1, ki: 0, neu: 0 },
      { q: "Enpal", t: 111, term: 16, ang: 1, ab: 1, nplz: 1, rekl: 46, ne5: 11, ne: 6, wvl: 23, ki: 2, neu: 0 },
      { q: "Angebots-guru", t: 60, term: 3, ang: 1, ab: 0, nplz: 12, rekl: 18, ne5: 9, ne: 9, wvl: 8, ki: 0, neu: 0 },
      { q: "Int./Kunden", t: 41, term: 12, ang: 4, ab: 1, nplz: 0, rekl: 1, ne5: 0, ne: 4, wvl: 2, ki: 1, neu: 16 },
      { q: "Empfehlung", t: 34, term: 11, ang: 6, ab: 13, nplz: 0, rekl: 0, ne5: 0, ne: 0, wvl: 0, ki: 0, neu: 4 },
      { q: "Enpal Direct", t: 7, term: 0, ang: 0, ab: 0, nplz: 0, rekl: 0, ne5: 0, ne: 0, wvl: 0, ki: 0, neu: 7 },
      { q: "Bieling Empfehlung", t: 1, term: 0, ang: 0, ab: 1, nplz: 0, rekl: 0, ne5: 0, ne: 0, wvl: 0, ki: 0, neu: 0 },
    ],
    cc: [
      { n: "Celine Madlaine", t: 62, term: 5, ang: 0, ab: 0, nplz: 8, rekl: 26, ne5: 0 },
      { n: "Jasmin Hübner", t: 281, term: 37, ang: 6, ab: 0, nplz: 52, rekl: 115, ne5: 0 },
      { n: "Jenny Litke", t: 449, term: 57, ang: 4, ab: 0, nplz: 197, rekl: 113, ne5: 2 },
      { n: "Mensure Baykan", t: 305, term: 30, ang: 7, ab: 0, nplz: 92, rekl: 66, ne5: 0 },
      { n: "Nadia Kucab", t: 592, term: 46, ang: 7, ab: 0, nplz: 148, rekl: 299, ne5: 0 },
      { n: "Selin Aylikcioglu", t: 488, term: 43, ang: 1, ab: 0, nplz: 235, rekl: 126, ne5: 0 },
    ],
    scouter: [
      { n: "Thomas Herrmann", t: 95, term: 27, ang: 5, ab: 0, rekl: 3, ne5: 10, ne: 14, wvl: 16 },
      { n: "Alexander Luxat", t: 85, term: 33, ang: 6, ab: 2, rekl: 2, ne5: 7, ne: 10, wvl: 12 },
      { n: "Fabian Ricken", t: 72, term: 44, ang: 1, ab: 4, rekl: 3, ne5: 1, ne: 2, wvl: 5 },
      { n: "Cinar Onk", t: 60, term: 14, ang: 4, ab: 2, rekl: 2, ne5: 7, ne: 9, wvl: 10 },
      { n: "Robin Kricke", t: 48, term: 25, ang: 9, ab: 1, rekl: 1, ne5: 1, ne: 1, wvl: 4 },
      { n: "Selçuk Özkaya", t: 43, term: 22, ang: 1, ab: 1, rekl: 1, ne5: 3, ne: 3, wvl: 5 },
      { n: "Norbert Pap", t: 28, term: 6, ang: 8, ab: 0, rekl: 0, ne5: 1, ne: 2, wvl: 4 },
      { n: "Ayhan Celik", t: 22, term: 6, ang: 4, ab: 2, rekl: 0, ne5: 1, ne: 1, wvl: 2 },
      { n: "Christian Neukirch", t: 8, term: 0, ang: 1, ab: 3, rekl: 0, ne5: 0, ne: 0, wvl: 1 },
    ],
  },
};
const lmtSum = (a, b) => {
  const map = {};
  [...a, ...b].forEach(q => {
    const k = q.q || q.n;
    if (!map[k]) map[k] = { ...q };
    else Object.keys(q).forEach(x => { if (x !== 'q' && x !== 'n') map[k][x] = (map[k][x]||0) + (q[x]||0); });
  });
  return Object.values(map);
};
LMT.total = {
  total: LMT.jan.total + LMT.feb.total,
  quellen: lmtSum(LMT.jan.quellen, LMT.feb.quellen),
  cc: LMT.jan.cc.map((j, i) => {
    const f = LMT.feb.cc[i];
    return { n: j.n, t: j.t+f.t, term: j.term+f.term, ang: j.ang+f.ang, ab: j.ab+f.ab, nplz: j.nplz+f.nplz, rekl: j.rekl+f.rekl, ne5: j.ne5+f.ne5 };
  }),
  scouter: LMT.jan.scouter.map(j => {
    const f = LMT.feb.scouter.find(s => s.n === j.n) || { t:0, term:0, ang:0, ab:0, rekl:0, ne5:0, ne:0, wvl:0 };
    return { n: j.n, t: j.t+f.t, term: j.term+f.term, ang: j.ang+f.ang, ab: j.ab+f.ab, rekl: j.rekl+f.rekl, ne5: j.ne5+f.ne5, ne: j.ne+f.ne, wvl: j.wvl+f.wvl };
  }),
};

// ═══ UI ═══
const KPI = ({ label, value, sub, color = C.amber, small }) => (
  <div style={{ background: C.card, borderRadius: 14, padding: small?"14px 16px":"18px 22px", border: `1px solid ${C.border}`, flex: "1 1 0", minWidth: small?120:140 }}>
    <div style={{ fontSize: 10, color: C.sec, fontWeight: 600, letterSpacing: ".06em", textTransform: "uppercase", marginBottom: 5 }}>{label}</div>
    <div style={{ fontSize: small?22:28, fontWeight: 800, color, lineHeight: 1 }}>{value}</div>
    {sub && <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>{sub}</div>}
  </div>
);
const TT = ({ active, payload, label }) => {
  if (!active || !payload?.length) return null;
  return (
    <div style={{ background: "#1B2332", border: `1px solid ${C.border}`, borderRadius: 10, padding: "10px 14px", boxShadow: "0 12px 40px rgba(0,0,0,.5)" }}>
      <div style={{ color: C.text, fontWeight: 700, fontSize: 13, marginBottom: 4 }}>{label}</div>
      {payload.map((p,i) => (
        <div key={i} style={{ color: p.color||C.text, fontSize: 12, display: "flex", gap: 6, alignItems: "center" }}>
          <span style={{ width: 8, height: 8, borderRadius: "50%", background: p.color, flexShrink: 0 }}/>
          {p.name}: <strong style={{ color: C.text }}>{typeof p.value==="number"?fmt(p.value):p.value}</strong>
        </div>
      ))}
    </div>
  );
};
const Sec = ({ title, children }) => (
  <div style={{ background: C.card, borderRadius: 14, padding: "20px 24px", border: `1px solid ${C.border}` }}>
    <h3 style={{ color: C.text, fontSize: 16, fontWeight: 700, margin: "0 0 16px" }}>{title}</h3>
    {children}
  </div>
);
const Badge = ({ v, color }) => (
  <span style={{ background: color+"18", color, padding: "3px 9px", borderRadius: 6, fontWeight: 700, fontSize: 12 }}>{v}</span>
);
const Alert = ({ color, icon, children }) => (
  <div style={{ background: color+"08", borderRadius: 10, padding: "12px 16px", border: `1px solid ${color}20`, display: "flex", gap: 10, alignItems: "flex-start" }}>
    <span style={{ fontSize: 16, flexShrink: 0 }}>{icon}</span>
    <div style={{ fontSize: 12, color: C.sec, lineHeight: 1.6 }}>{children}</div>
  </div>
);

// ═══ TAB: ÜBERSICHT ═══
const TabOverview = () => {
  const F = FORECAST;
  const pctDone = Math.round(F.daysElapsed / F.daysTotal * 100);
  const salesPct = Math.round(SALES.aktiv / F.forecastSales * 100);
  return (
  <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>

    {/* FORECAST BANNER */}
    <div style={{ background: `linear-gradient(135deg, ${C.green}08, ${C.amber}06)`, borderRadius: 14, padding: "18px 22px", border: `1px solid ${C.green}20` }}>
      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: 12 }}>
        <div>
          <div style={{ fontSize: 13, color: C.sec, fontWeight: 600 }}>MONATS-FORECAST · {pctDone}% des Monats</div>
          <div style={{ fontSize: 28, fontWeight: 800, color: C.green, fontFamily: "'JetBrains Mono',monospace" }}>{eur(F.forecastNetto)}</div>
          <div style={{ fontSize: 12, color: C.sec }}>{F.forecastSales} Sales Prognose · Ø {F.salesPerDay.toFixed(1)}/Tag · {F.daysRemaining} Tage verbleibend</div>
        </div>
        <div style={{ display: "flex", gap: 16 }}>
          <div style={{ textAlign: "center" }}>
            <div style={{ fontSize: 10, color: C.sec }}>AKTUELL</div>
            <div style={{ fontSize: 22, fontWeight: 800, color: C.amber }}>{SALES.aktiv}</div>
            <div style={{ fontSize: 10, color: C.dim }}>{eur(SALES.nettoAktiv)}</div>
          </div>
          <div style={{ width: 1, background: C.border }}/>
          <div style={{ textAlign: "center" }}>
            <div style={{ fontSize: 10, color: C.sec }}>FORECAST</div>
            <div style={{ fontSize: 22, fontWeight: 800, color: C.green }}>{F.forecastSales}</div>
            <div style={{ fontSize: 10, color: C.dim }}>{eur(F.forecastNetto)}</div>
          </div>
        </div>
      </div>
      <div style={{ marginTop: 10, height: 8, background: C.border, borderRadius: 4, overflow: "hidden" }}>
        <div style={{ width: `${salesPct}%`, height: "100%", background: `linear-gradient(90deg, ${C.green}, ${C.amber})`, borderRadius: 4, transition: "width .3s" }}/>
      </div>
      <div style={{ display: "flex", justifyContent: "space-between", fontSize: 10, color: C.dim, marginTop: 4 }}>
        <span>W1: {F.w1}s · W2: {F.w2}s · W3: {F.w3}s</span>
        <span>{salesPct}% des Forecasts erreicht</span>
      </div>
    </div>

    {/* DYNAMIC KPIs */}
    <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
      <KPI label="Leads Feb" value={fmt(LEAD_STATS.total)} sub={`Ø ${LEAD_STATS.avgPerDay}/Tag`}/>
      <KPI label="Terme Feb" value={fmt(TERME.kundenGesamt)} sub={`${TERME.ohneAF} offen+SF · ${TERME.alleAF} AF · ${TERME.dedup} dedup`} color={C.blue}/>
      <KPI label="Stattgefunden" value={fmt(TERME.stattBisGestern)} sub={`+ ${TERME.afBisGestern} ausgefallen`} color={C.cyan}/>
      <KPI label="Sales Brutto" value={SALES.total} sub={`${SALES.storno} Storno (${SALES.stornoQuote}%)`} color={C.amber}/>
      <KPI label="Sales Netto" value={SALES.aktiv} sub={`${pct(SALES.aktiv,TERME.stattBisGestern)}% Abschlussquote`} color={C.green}/>
      <KPI label="Umsatz Netto" value={eur(SALES.nettoAktiv)} sub={`Brutto ${eur(SALES.nettoBrutto)} · Ø ${eur(SALES.avgNetto)}`} color={C.amber}/>
    </div>

    {/* WVL PIPELINE */}
    <Sec title={"📋 WVL Pipeline · " + WVL.total + " offene WVL"}>
      <div style={{ display: "flex", gap: 16, flexWrap: "wrap", marginBottom: 12 }}>
        <div style={{ flex: "1 1 200px" }}>
          <div style={{ display: "flex", gap: 8, flexWrap: "wrap" }}>
            {WVL.types.map((t,i) => <div key={i} style={{ background: t.color+"12", border: `1px solid ${t.color}25`, borderRadius: 10, padding: "8px 14px", flex: "1 1 120px" }}><div style={{ fontSize: 10, color: t.color }}>{t.name}</div><div style={{ fontSize: 22, fontWeight: 800, fontFamily: "'JetBrains Mono',monospace" }}>{t.value}</div></div>)}
          </div>
          <div style={{ marginTop: 12, display: "flex", gap: 8 }}>
            <div style={{ background: C.red+"12", borderRadius: 8, padding: "6px 12px", flex: 1, textAlign: "center" }}><div style={{ fontSize: 9, color: C.red }}>{">"} 7 Tage</div><div style={{ fontSize: 18, fontWeight: 800, color: C.red }}>{WVL.age.o7d}</div></div>
            <div style={{ background: C.amber+"12", borderRadius: 8, padding: "6px 12px", flex: 1, textAlign: "center" }}><div style={{ fontSize: 9, color: C.amber }}>3–7 Tage</div><div style={{ fontSize: 18, fontWeight: 800, color: C.amber }}>{WVL.age.m3_7d}</div></div>
            <div style={{ background: C.green+"12", borderRadius: 8, padding: "6px 12px", flex: 1, textAlign: "center" }}><div style={{ fontSize: 9, color: C.green }}>{"<"} 3 Tage</div><div style={{ fontSize: 18, fontWeight: 800, color: C.green }}>{WVL.age.u3d}</div></div>
          </div>
        </div>
        <div style={{ flex: "1 1 280px" }}>
          <div style={{ fontSize: 11, color: C.sec, marginBottom: 6 }}>WVL pro Berater (Top 12)</div>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(3, 1fr)", gap: 4 }}>
            {WVL.byVB.map((b,i) => <div key={i} style={{ display: "flex", justifyContent: "space-between", padding: "2px 6px", background: i%2===0?"transparent":C.card+"60", borderRadius: 4, fontSize: 11 }}><span style={{ color: C.sec }}>{b.n.split(" ").pop()}</span><span style={{ fontWeight: 700, fontFamily: "'JetBrains Mono',monospace" }}>{b.v}</span></div>)}
          </div>
        </div>
      </div>
      <Alert color={C.amber} icon="💡">
        <strong>{WVL.age.o7d} WVL {">"} 7 Tage</strong> drohen zu verfallen. Bei {Math.round(WVL.convEst*100)}% Nachfass-Conversion = <strong style={{ color: C.green }}>~{Math.round(WVL.total*WVL.convEst)} zusätzliche Sales</strong> möglich ({eur(Math.round(WVL.total*WVL.convEst*SALES.avgNetto))} Umsatz).
      </Alert>
    </Sec>

    {/* SCOUT↔VB MATRIX */}
    <Sec title="🔗 Scout↔VB Paarungs-Matrix (Vergangenheit)">
      <div style={{ overflowX: "auto", borderRadius: 10, border: `1px solid ${C.border}` }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11, minWidth: 650 }}>
          <thead><tr style={{ background: C.card }}>
            {["Scout","VB","Terme","SF","AF","AF%","Sales","Netto"].map((h,i) =>
              <th key={h} style={{ padding: "6px 6px", textAlign: i>1?"right":"left", color: C.sec, fontWeight: 600, borderBottom: `2px solid ${C.border}`, fontSize: 10, textTransform: "uppercase" }}>{h}</th>
            )}
          </tr></thead>
          <tbody>{SCOUT_VB_MATRIX.map((p,i) => {
            const afp = p.te>0?Math.round(p.af/p.te*100):0;
            const isGood = p.sales>=2;
            const isBad = afp>=60 && p.te>=5;
            return (
            <tr key={i} style={{ background: isBad?C.red+"06":isGood?C.green+"06":i%2===0?"transparent":C.card+"60" }}>
              <td style={{ padding: "4px 6px", fontWeight: 600, color: C.purple }}>{p.sc}</td>
              <td style={{ padding: "4px 6px", fontWeight: 600, color: "#fff" }}>{p.vb}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace" }}>{p.te}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace", color: C.cyan }}>{p.sf}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace", color: C.red }}>{p.af}</td>
              <td style={{ padding: "4px 6px", textAlign: "right" }}><Badge v={`${afp}%`} color={afp>=60?C.red:afp>=40?C.amber:C.green}/></td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontWeight: 700, color: p.sales>0?C.green:C.dim }}>{p.sales||"–"}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace", color: p.net>0?C.green:C.dim }}>{p.net>0?eur(p.net):"–"}</td>
            </tr>);
          })}</tbody>
        </table>
      </div>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 6 }}>
        🟢 Top: Ashraf→Hensel (99k€/4s), Neukirch→Ulitzka (77k€/4s), Kricke→Horten (35k€/2s) · 🔴 Toxisch: Pap→Kirschner (22T/0SF), Herrmann→Schader (8T/75%AF)
      </div>
    </Sec>

    {/* LEAD QUELLEN EFFIZIENZ */}
    <Sec title="🎯 Lead-Quellen Effizienz">
      <div style={{ overflowX: "auto" }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11, minWidth: 500 }}>
          <thead><tr style={{ background: C.card }}>
            {["Quelle","Leads","Terminiert","Rate","Rekl.","!PLZ"].map((h,i) =>
              <th key={h} style={{ padding: "6px 6px", textAlign: i>0?"right":"left", color: C.sec, fontWeight: 600, borderBottom: `2px solid ${C.border}`, fontSize: 10, textTransform: "uppercase" }}>{h}</th>
            )}
          </tr></thead>
          <tbody>{LEAD_STATS.bySource.filter(s=>s.leads>=50).map((s,i) => (
            <tr key={i} style={{ background: i%2===0?"transparent":C.card+"60" }}>
              <td style={{ padding: "4px 6px", fontWeight: 600, color: "#fff" }}>{s.name}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace" }}>{fmt(s.leads)}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace", color: C.cyan }}>{s.term||"–"}</td>
              <td style={{ padding: "4px 6px", textAlign: "right" }}>{s.termRate>0?<Badge v={`${s.termRate}%`} color={s.termRate>=50?C.green:s.termRate>=15?C.amber:C.red}/>:"–"}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace", color: s.rekl>0?C.red:C.dim }}>{s.rekl||"–"}</td>
              <td style={{ padding: "4px 6px", textAlign: "right", fontFamily: "'JetBrains Mono',monospace", color: s.nplz>0?C.red:C.dim }}>{s.nplz||"–"}</td>
            </tr>
          ))}</tbody>
        </table>
      </div>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 6 }}>
        SADD: 1.309 Leads aber nur 9% terminiert (630 !PLZ, 227 Rekl.) · Omega: 97% Term-Rate (effizienteste Quelle) · Enpal-WP: 32% Reklamation
      </div>
    </Sec>

    <Sec title="📥 Täglicher Lead-Import nach Quelle">
      <ResponsiveContainer width="100%" height={220}>
        <BarChart data={LEADS.dailyImport}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
          <Tooltip content={<TT/>}/>
          <Bar dataKey="sadd" stackId="a" fill={C.red} name="SADD"/>
          <Bar dataKey="enpal" stackId="a" fill={C.orange} name="Enpal"/>
          <Bar dataKey="mvpp" stackId="a" fill={C.amber} name="MVPP"/>
          <Bar dataKey="eigen" stackId="a" fill={C.green} name="Eigenlead"/>
          <Bar dataKey="omega" stackId="a" fill={C.blue} name="Omega"/>
          <Bar dataKey="sonst" stackId="a" fill={C.dim} name="Sonstige" radius={[4,4,0,0]}/>
        </BarChart>
      </ResponsiveContainer>
    </Sec>

    <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
      <div style={{ flex: "2 1 480px" }}>
        <Sec title="📈 Sales pro Tag (Netto, Jan + Feb)">
          <div style={{ fontSize: 11, color: C.dim, marginBottom: 6 }}>DatumAngenommen · TOP: 27.01. (14), 11.02. (13), 23.01. (10), 10.02. (10)</div>
          <ResponsiveContainer width="100%" height={250}>
            <ComposedChart data={SALES.daily}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 9 }} axisLine={false} interval={1}/>
              <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="v" name="Netto Sales" radius={[4,4,0,0]} barSize={16}>
                {SALES.daily.map((d,i) => <Cell key={i} fill={d.mon==="Jan"?C.blue:C.green}/>)}
              </Bar>
            </ComposedChart>
          </ResponsiveContainer>
          <div style={{ display:"flex",gap:16,marginTop:4,fontSize:11,color:C.sec }}>
            <span>🔵 Januar</span><span>🟢 Februar</span>
          </div>
        </Sec>
      </div>
      <div style={{ flex: "1 1 260px" }}>
        <Sec title="📊 Stattgef. vs. Sales/Tag (Feb)">
          <ResponsiveContainer width="100%" height={250}>
            <ComposedChart data={SALES.sfVsSalesDaily}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 9 }}/>
              <YAxis yAxisId="left" tick={{ fill: C.sec, fontSize: 10 }}/>
              <Tooltip content={<TT/>}/>
              <Bar yAxisId="left" dataKey="sf" fill={C.blue} name="Stattgef." radius={[4,4,0,0]} barSize={14} opacity={0.5}/>
              <Bar yAxisId="left" dataKey="sales" fill={C.green} name="Sales" radius={[4,4,0,0]} barSize={14}/>
            </ComposedChart>
          </ResponsiveContainer>
        </Sec>
      </div>
    </div>
  </div>
  );
};

// ═══ TAB: SALES ═══
const TabSales = () => {
  const data = useMemo(() => [...SALES.berater].filter(b=>b.b>0).sort((a,b) => b.b-a.b), []);
  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
        {[...SALES.berater].filter(b=>b.b>0).sort((a,b)=>b.b-a.b).slice(0,5).map((b,i) => (
          <div key={i} style={{ background: C.card, borderRadius: 12, padding: "16px 20px", border: `1px solid ${i===0?C.amber+"40":C.border}`, flex: "1 1 170px", minWidth: 170 }}>
            <div style={{ fontSize: 10, color: C.dim }}>#{i+1}</div>
            <div style={{ fontSize: 14, fontWeight: 800, color: C.text }}>{b.n}</div>
            <div style={{ display: "flex", gap: 8, alignItems: "baseline", marginTop: 6 }}>
              <span style={{ fontSize: 13, color: C.amber, fontWeight: 700 }}>{b.b} Brutto</span>
              <span style={{ fontSize: 13, color: C.green, fontWeight: 700 }}>{b.s} Netto</span>
            </div>
            <div style={{ display: "flex", gap: 8, alignItems: "baseline", marginTop: 4 }}>
              <span style={{ fontSize: 13, color: C.amber, fontWeight: 700 }}>{eur(b.eb)}</span>
              {b.st>0 && <span style={{ fontSize: 12, color: C.red }}>{b.st} Storno</span>}
            </div>
            <div style={{ fontSize: 11, color: C.dim, marginTop: 2 }}>
              {b.sf} Kunden · {b.sf>0?(b.s/b.sf*100).toFixed(0):0}% Quote · {b.kwp} kWp
            </div>
          </div>
        ))}
      </div>

      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 350px" }}>
          <Sec title="📆 Wochentag: Ø Sales/Tag (Jan+Feb)">
            <ResponsiveContainer width="100%" height={220}>
              <BarChart data={SALES.weekday}>
                <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 12 }} axisLine={false}/>
                <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
                <Tooltip content={<TT/>}/>
                <Bar dataKey="avg" name="Ø Netto/Tag" fill={C.green} radius={[6,6,0,0]} barSize={30}>
                  {SALES.weekday.map((d,i) => <Cell key={i} fill={d.avg>=7?C.green:d.avg>=5?C.amber:C.red}/>)}
                </Bar>
                <Bar dataKey="v" name="Sales gesamt" fill={C.blue} radius={[6,6,0,0]} barSize={30} opacity={0.4}/>
              </BarChart>
            </ResponsiveContainer>
            <div style={{ fontSize: 11, color: C.sec, marginTop: 6 }}>
              <strong style={{ color: C.green }}>Di = Ø 8,0</strong> stärkster Tag (48 Sales). <strong style={{ color: C.red }}>Sa = Ø 3,2</strong> schwächster (19 Sales).
            </div>
          </Sec>
        </div>
        <div style={{ flex: "1 1 350px" }}>
          <Sec title="⚡ Anlagengrößen">
            <ResponsiveContainer width="100%" height={180}>
              <PieChart><Pie data={SALES.kwpDist} cx="50%" cy="50%" outerRadius={70} innerRadius={35} dataKey="v" paddingAngle={3} stroke="none">
                <Cell fill={C.cyan}/><Cell fill={C.blue}/><Cell fill={C.purple}/>
              </Pie><Tooltip content={<TT/>}/><Legend wrapperStyle={{ fontSize: 11 }}/></PieChart>
            </ResponsiveContainer>
          </Sec>
        </div>
      </div>

      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 400px" }}>
          <Sec title="🎯 Abschluss% (dedup, bis gestern)">
            <ResponsiveContainer width="100%" height={280}>
              <BarChart data={SALES.quellenClose} layout="vertical" margin={{ left: 90 }}>
                <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                <XAxis type="number" domain={[0,50]} unit="%" tick={{ fill: C.sec, fontSize: 11 }}/>
                <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={80}/>
                <Tooltip formatter={v=>`${v}%`} contentStyle={{ background: "#1B2332", border: `1px solid ${C.border}`, borderRadius: 10 }}/>
                <Bar dataKey="rate" name="Abschluss%" radius={[0,4,4,0]} background={false}>
                  {SALES.quellenClose.map((e,i) => <Cell key={i} fill={e.rate>=20?C.green:e.rate>=10?C.amber:C.red}/>)}
                </Bar>
              </BarChart>
            </ResponsiveContainer>
          </Sec>
        </div>
        <div style={{ flex: "1 1 400px" }}>
          <Sec title="💶 Revenue pro Lead">
            <ResponsiveContainer width="100%" height={280}>
              <BarChart data={SALES.quellen} layout="vertical" margin={{ left: 90 }}>
                <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
                <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={80}/>
                <Tooltip formatter={v=>`${eur(v)}`} contentStyle={{ background: "#1B2332", border: `1px solid ${C.border}`, borderRadius: 10 }}/>
                <Bar dataKey="rpl" name="€/Lead" radius={[0,6,6,0]}>
                  {SALES.quellen.map((e,i) => <Cell key={i} fill={e.rpl>=1000?C.green:e.rpl>=100?C.amber:C.red}/>)}
                </Bar>
              </BarChart>
            </ResponsiveContainer>
          </Sec>
        </div>
      </div>

      <div style={{ background: C.card, borderRadius: 14, padding: "18px 24px", border: `1px solid ${C.blue}20` }}>
        <div style={{ fontSize: 15, fontWeight: 700, color: C.blue, marginBottom: 8 }}>📡 OMEGA Kosten (dedup)</div>
        <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
          <KPI small label="Kunden (o.AF)" value="192" color={C.blue}/>
          <KPI small label="Stattgef. bis ges." value="50" sub="× 300€" color={C.cyan}/>
          <KPI small label="Kosten" value={eur(15000)} color={C.red}/>
          <KPI small label="Sales" value="7" sub={eur(178784)} color={C.green}/>
          <KPI small label="€/Sale" value={eur(2143)} color={C.amber}/>
          <KPI small label="ROI" value={`${Math.round(178784/15000)}x`} color={C.green}/>
        </div>
      </div>

      <Sec title="📋 Sales-Tabelle (dedup)">
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Berater","Brutto","Netto","HR","Abschl.%","Storno","St.%","Speicher+","Eigen","Empf.","Prov.","Ø kWp"].map(h => (
                <th key={h} style={{ padding: "9px 7px", textAlign: "left", color: C.sec, fontWeight: 600, fontSize: 9, textTransform: "uppercase" }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{data.map((b,i) => {
              const stR=b.b>0?(b.st/b.b*100):0, clR=b.sf>0&&b.s>0?(b.s/b.sf*100):0;
              return (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                  <td style={{ padding: "7px", color: C.text, fontWeight: 600 }}>{b.n}</td>
                  <td style={{ padding: "7px", color: C.amber, fontWeight: 800, fontSize: 16 }}>{b.b}</td>
                  <td style={{ padding: "7px", color: C.green, fontWeight: 800, fontSize: 16 }}>{b.s}</td>
                  <td style={{ padding: "7px", color: C.sec, fontStyle: "italic", fontSize: 12 }}>{b.b>0?Math.round(b.b*(20/8)):"–"}</td>
                  <td style={{ padding: "7px" }}>{clR>0?<Badge v={`${clR.toFixed(0)}%`} color={clR>30?C.green:clR>15?C.amber:C.sec}/>:"–"}</td>
                  <td style={{ padding: "7px", color: b.st>0?C.red:C.dim }}>{b.st||"–"}</td>
                  <td style={{ padding: "7px" }}>{b.st>0?<Badge v={`${stR.toFixed(0)}%`} color={stR>20?C.red:C.orange}/>:<span style={{color:C.dim}}>–</span>}</td>
                  <td style={{ padding: "7px", color: b.sp>0?C.teal:C.dim, fontWeight: b.sp>0?700:400 }}>{b.sp||"–"}</td>
                  <td style={{ padding: "7px", color: b.eigen>0?C.green:C.dim, fontWeight: b.eigen>0?700:400 }}>{b.eigen||"–"}</td>
                  <td style={{ padding: "7px", color: b.empf>0?C.pink:C.dim, fontWeight: b.empf>0?700:400 }}>{b.empf||"–"}</td>
                  <td style={{ padding: "7px", color: C.amber, fontWeight: 700 }}>{b.prov>0?eur(b.prov):"–"}</td>
                  <td style={{ padding: "7px", color: C.cyan }}>{b.kwp>0?b.kwp:"–"}</td>
                </tr>
              );
            })}</tbody>
          </table>
        </div>
      </Sec>
    </div>
  );
};

// ═══ TAB: LEADQUELLEN ═══
const TabQuellen = () => {
  const [period, setPeriod] = React.useState("feb");
  const lmt = period==="jan"?LMT.jan:period==="total"?LMT.total:LMT.feb;
  const qData = lmt.quellen.map(q => {
    const qual = q.t - (q.nplz||0) - (q.rekl||0);
    const termRate = q.t > 0 ? (q.term+q.ang) / q.t * 100 : 0;
    const qualRate = q.t > 0 ? qual / q.t * 100 : 0;
    const waste = q.t > 0 ? ((q.nplz||0)+(q.rekl||0)) / q.t * 100 : 0;
    const sale = SALES.quellen.find(s=>s.n===q.q || (q.q==="Einfach zum Angebot"&&s.n==="EzA") || (q.q==="Int./Kunden"&&s.n==="Int./Kunden"));
    return { ...q, qual, termRate, qualRate, waste, sales: sale?.s||0, salesB: sale?.b||0 };
  });
  const PBtn = ({k,l}) => <button onClick={()=>setPeriod(k)} style={{ padding:"5px 14px",borderRadius:8,border:`1px solid ${period===k?C.amber:C.border}`,background:period===k?C.amber+"18":"transparent",color:period===k?C.amber:C.sec,fontSize:11,fontWeight:600,cursor:"pointer" }}>{l}</button>;
  const totals = qData.reduce((a,q) => ({ t: a.t+q.t, term: a.term+q.term, ang: a.ang+q.ang, ab: a.ab+q.ab, nplz: a.nplz+(q.nplz||0), rekl: a.rekl+(q.rekl||0) }), { t:0, term:0, ang:0, ab:0, nplz:0, rekl:0 });

  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
      <div style={{ display:"flex",gap:6,marginBottom:4 }}>
        <PBtn k="feb" l="Februar"/><PBtn k="jan" l="Januar"/><PBtn k="total" l="Total"/>
        <span style={{ marginLeft: 12, fontSize: 11, color: C.dim, alignSelf: "center" }}>Daten: LMT-Export ({fmt(lmt.total)} Leads)</span>
      </div>
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
        <KPI label="Leads gesamt" value={fmt(totals.t)} color={C.cyan}/>
        <KPI label="Terminiert+Angebot" value={fmt(totals.term+totals.ang)} sub={`${(totals.t>0?(totals.term+totals.ang)/totals.t*100:0).toFixed(1)}%`} color={C.green}/>
        <KPI label="AB erstellt" value={fmt(totals.ab)} sub={`${(totals.t>0?totals.ab/totals.t*100:0).toFixed(1)}%`} color={C.green}/>
        <KPI label="Waste (!PLZ+REKL)" value={fmt(totals.nplz+totals.rekl)} sub={`${(totals.t>0?(totals.nplz+totals.rekl)/totals.t*100:0).toFixed(0)}%`} color={C.red}/>
      </div>

      <Sec title="🔀 Lead-Funnel pro Quelle (LMT)">
        <ResponsiveContainer width="100%" height={Math.max(280, qData.filter(q=>q.t>=8).length*32)}>
          <BarChart data={qData.filter(q=>q.t>=8).sort((a,b)=>b.t-a.t)} layout="vertical" margin={{ left: 110 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis type="category" dataKey="q" tick={{ fill: C.sec, fontSize: 11 }} width={100}/>
            <Tooltip content={<TT/>}/>
            <Bar dataKey="ab" stackId="s" fill={C.green} name="AB erstellt"/>
            <Bar dataKey="ang" stackId="s" fill="#3FB950AA" name="Angebot"/>
            <Bar dataKey="term" stackId="s" fill={C.cyan} name="Terminiert"/>
            <Bar dataKey="wvl" stackId="s" fill={C.blue} name="WVL"/>
            <Bar dataKey="ne" stackId="s" fill={C.orange} name="Nicht err."/>
            <Bar dataKey="ne5" stackId="s" fill="#D29922" name="5× nicht err."/>
            <Bar dataKey="rekl" stackId="s" fill={C.red} name="REKL"/>
            <Bar dataKey="nplz" stackId="s" fill={C.purple} name="!PLZ" radius={[0,4,4,0]}/>
          </BarChart>
        </ResponsiveContainer>
      </Sec>

      <Sec title="🎯 Terminierungsrate vs. Waste-Rate">
        <ResponsiveContainer width="100%" height={Math.max(260, qData.filter(q=>q.t>=8).length*30)}>
          <BarChart data={qData.filter(q=>q.t>=8).sort((a,b)=>b.termRate-a.termRate)} layout="vertical" margin={{ left: 110 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis type="number" domain={[0,100]} unit="%" tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis type="category" dataKey="q" tick={{ fill: C.sec, fontSize: 11 }} width={100}/>
            <Tooltip formatter={v=>`${v.toFixed(1)}%`} contentStyle={{ background: "#1B2332", border: `1px solid ${C.border}`, borderRadius: 10 }}/>
            <Bar dataKey="termRate" name="Term.+Angebot %" radius={[0,6,6,0]}>
              {qData.filter(q=>q.t>=8).sort((a,b)=>b.termRate-a.termRate).map((e,i) => <Cell key={i} fill={e.termRate>50?C.green:e.termRate>15?C.amber:C.red}/>)}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
      </Sec>

      <Sec title="📋 Quellendetail (LMT Leads → Conversion)">
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Quelle","Leads","Qual.","Qual%","Term.+Angebot","Term%","AB","!PLZ","REKL","Waste%","NE5"].map(h => (
                <th key={h} style={{ padding: "7px 5px", textAlign: h==="Quelle"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 9, textTransform: "uppercase" }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{qData.sort((a,b)=>b.t-a.t).map((q,i) => (
              <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: i%2===0?"transparent":`${C.card}60` }}>
                <td style={{ padding: "6px 5px", color: C.text, fontWeight: 600, fontSize: 11 }}>{q.q}</td>
                <td style={{ padding: "6px 5px", textAlign: "right", fontWeight: 700 }}>{fmt(q.t)}</td>
                <td style={{ padding: "6px 5px", textAlign: "right", color: C.blue }}>{fmt(q.qual)}</td>
                <td style={{ padding: "6px 5px", textAlign: "right" }}><Badge v={`${q.qualRate.toFixed(0)}%`} color={q.qualRate>80?C.green:q.qualRate>50?C.amber:C.red}/></td>
                <td style={{ padding: "6px 5px", textAlign: "right", color: C.green, fontWeight: 700 }}>{q.term+q.ang}</td>
                <td style={{ padding: "6px 5px", textAlign: "right" }}><Badge v={`${q.termRate.toFixed(1)}%`} color={q.termRate>50?C.green:q.termRate>15?C.amber:C.red}/></td>
                <td style={{ padding: "6px 5px", textAlign: "right", color: q.ab>0?C.green:C.dim, fontWeight: 700 }}>{q.ab||"–"}</td>
                <td style={{ padding: "6px 5px", textAlign: "right", color: (q.nplz||0)>0?C.purple:C.dim }}>{q.nplz||"–"}</td>
                <td style={{ padding: "6px 5px", textAlign: "right", color: (q.rekl||0)>0?C.red:C.dim }}>{q.rekl||"–"}</td>
                <td style={{ padding: "6px 5px", textAlign: "right" }}><Badge v={`${q.waste.toFixed(0)}%`} color={q.waste>40?C.red:q.waste>15?C.amber:C.green}/></td>
                <td style={{ padding: "6px 5px", textAlign: "right", color: (q.ne5||0)>0?C.orange:C.dim }}>{q.ne5||"–"}</td>
              </tr>
            ))}</tbody>
            <tfoot><tr style={{ borderTop: `2px solid ${C.green}`, fontWeight: 700, background: `${C.green}08` }}>
              <td style={{ padding: "7px 5px", color: C.green }}>GESAMT</td>
              <td style={{ padding: "7px 5px", textAlign: "right" }}>{fmt(totals.t)}</td>
              <td style={{ padding: "7px 5px", textAlign: "right", color: C.blue }}>{fmt(totals.t-totals.nplz-totals.rekl)}</td>
              <td style={{ padding: "7px 5px", textAlign: "right" }}><Badge v={`${((totals.t-totals.nplz-totals.rekl)/totals.t*100).toFixed(0)}%`} color={C.amber}/></td>
              <td style={{ padding: "7px 5px", textAlign: "right", color: C.green }}>{totals.term+totals.ang}</td>
              <td style={{ padding: "7px 5px", textAlign: "right" }}><Badge v={`${((totals.term+totals.ang)/totals.t*100).toFixed(1)}%`} color={C.amber}/></td>
              <td style={{ padding: "7px 5px", textAlign: "right", color: C.green }}>{totals.ab}</td>
              <td style={{ padding: "7px 5px", textAlign: "right", color: C.purple }}>{fmt(totals.nplz)}</td>
              <td style={{ padding: "7px 5px", textAlign: "right", color: C.red }}>{fmt(totals.rekl)}</td>
              <td colSpan={2}/>
            </tr></tfoot>
          </table>
        </div>
        <div style={{ fontSize: 10, color: C.dim, marginTop: 6 }}>Qual = Leads − !PLZ − REKL · Term.+Angebot = Terminiert + Angebot erstellt/angenommen · Waste = (!PLZ + REKL) / Leads</div>
      </Sec>

      <Sec title="🏃 Scouter Lead-Qualität (LMT MVPP)">
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Scouter","Leads","Term.","Angebot","AB","Term%","NE5","WVL"].map(h => (
                <th key={h} style={{ padding: "6px 5px", textAlign: h==="Scouter"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 9 }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{(period==="jan"?LMT.jan:period==="total"?LMT.total:LMT.feb).scouter.filter(s=>s.t>0).sort((a,b)=>(b.term+b.ang)/(b.t||1)-(a.term+a.ang)/(a.t||1)).map((s,i) => {
              const r = s.t>0?(s.term+s.ang)/s.t*100:0;
              return (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                  <td style={{ padding: "5px", fontWeight: 600, fontSize: 11 }}>{s.n}</td>
                  <td style={{ padding: "5px", textAlign: "right", color: C.blue }}>{s.t}</td>
                  <td style={{ padding: "5px", textAlign: "right", color: C.green, fontWeight: 700 }}>{s.term}</td>
                  <td style={{ padding: "5px", textAlign: "right", color: C.cyan }}>{s.ang||"–"}</td>
                  <td style={{ padding: "5px", textAlign: "right", color: s.ab>0?C.green:C.dim, fontWeight: 700 }}>{s.ab||"–"}</td>
                  <td style={{ padding: "5px", textAlign: "right" }}><Badge v={`${r.toFixed(0)}%`} color={r>60?C.green:r>30?C.amber:C.red}/></td>
                  <td style={{ padding: "5px", textAlign: "right", color: s.ne5>0?C.orange:C.dim }}>{s.ne5||"–"}</td>
                  <td style={{ padding: "5px", textAlign: "right", color: s.wvl>0?C.blue:C.dim }}>{s.wvl||"–"}</td>
                </tr>
              );
            })}</tbody>
          </table>
        </div>
        <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>MVPP-Leads: 0% PLZ-Ausfall (vs. SADD 48%) · Höchste Qualität aller Quellen</div>
      </Sec>
    </div>
  );
};

// ═══ TAB: BERATER ═══
const TabBerater = () => {
  const [bp, setBp] = React.useState("feb");
  const atMap = { jan: 23, feb: 8, total: 31 };
  const possMap = { jan: 80.5, feb: 28, total: 108.5 };
  const at = atMap[bp]; const poss = possMap[bp];
  const merged = useMemo(() => {
    return TERME.berater.map(tb => {
      const sb = SALES.berater.find(s => tb.n.startsWith(s.n.slice(0,12)));
      const sbt = SALES.beraterTotal.find(s => tb.n.startsWith(s.n.slice(0,12)));
      const jB=(sbt?.b||0)-(sb?.b||0), jS=(sbt?.s||0)-(sb?.s||0), jSt=(sbt?.st||0)-(sb?.st||0), jE=(sbt?.e||0)-(sb?.e||0);
      return { ...tb, fB:sb?.b||0, fS:sb?.s||0, fSt:sb?.st||0, fE:sb?.e||0, fKwp:sb?.kwp||0, fSp:sb?.sp||0, fEigen:sb?.eigen||0, fEmpf:sb?.empf||0, fProv:sb?.prov||0,
        jB, jS, jSt, jE, tB:sbt?.b||0, tS:sbt?.s||0, tSt:sbt?.st||0, tE:sbt?.e||0 };
    });
  }, []);
  const sorted = useMemo(() => {
    const bk = bp==="jan"?"jB":bp==="feb"?"fB":"tB";
    return [...merged].sort((a,b) => (b[bk]||0)-(a[bk]||0));
  }, [merged, bp]);
  const gv = (b) => {
    if(bp==="jan") return {br:b.jB,ne:b.jS,st:b.jSt,sf:b.jSf||0,sfR:b.jSf||0,el:b.jEl||0,kwp:0,sp:0,eigen:0,empf:0,prov:0};
    if(bp==="feb") return {br:b.fB,ne:b.fS,st:b.fSt,sf:b.sf,sfR:b.sfR,el:b.el||0,kwp:b.fKwp,sp:b.fSp,eigen:b.fEigen,empf:b.fEmpf,prov:b.fProv};
    return {br:b.tB,ne:b.tS,st:b.tSt,sf:(b.jSf||0)+b.sf,sfR:(b.jSf||0)+b.sfR,el:(b.jEl||0)+(b.el||0),kwp:b.fKwp,sp:b.fSp,eigen:b.fEigen,empf:b.fEmpf,prov:b.fProv};
  };
  const zeroSales = bp==="feb" ? sorted.filter(b => b.fS===0 && b.sf>=4) : [];
  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>

      {zeroSales.length > 0 && (
        <Alert color={C.red} icon="⚠️">
          <strong style={{ color: C.red }}>0 Sales trotz stattgef. Kunden (bis gestern):</strong>{" "}
          {zeroSales.map(b => `${b.n} (${b.sf} Kunden)`).join(", ")}
        </Alert>
      )}

      <div style={{ display:"flex",gap:8,alignItems:"center",marginBottom:8 }}>
        <span style={{ fontSize: 14, fontWeight: 700, color: C.sec }}>📋 Berater-Tabelle</span>
        {[["jan","Januar"],["feb","Februar"],["total","Total"]].map(([k,l])=>(
          <button key={k} onClick={()=>setBp(k)} style={{ padding:"5px 14px",borderRadius:8,border:"none",cursor:"pointer",
            background:bp===k?C.green:"transparent",color:bp===k?"#06080F":C.sec,fontWeight:bp===k?800:500,fontSize:12 }}>{l}</button>
        ))}
        <span style={{ fontSize: 10, color: C.dim, marginLeft: 8 }}>{bp==="jan"?"23 AT":bp==="feb"?"8 AT (bis gestern)":"31 AT"}</span>
      </div>
      <Sec title="">
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Berater","Brutto","Netto","HR","Storno","Abschl.%","St.%","Stattg.","Auslast.","Speicher+","Eigen","Empf.","EL gen.","EL mögl.","Prov.","Ø kWp"].map(h => (
                <th key={h} style={{ padding: "8px 5px", textAlign: "left", color: C.sec, fontWeight: 600, fontSize: 9, textTransform: "uppercase" }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{sorted.map((b,i) => {
              const v = gv(b);
              const clR=v.sf>0&&v.ne>0?(v.ne/v.sf*100):0, stR=v.br>0?(v.st/v.br*100):0;
              const ausl = v.sfR > 0 ? (v.sfR / poss * 100) : 0;
              const auslRatio = v.sfR / poss;
              const potEL = Math.round((1 - auslRatio) * 3 * at);
              const elUnder = potEL > v.el;
              return (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                  <td style={{ padding: "7px 5px", color: C.text, fontWeight: 600 }}>{b.n}</td>
                  <td style={{ padding: "7px 5px", color: C.amber, fontWeight: 800, fontSize: 15 }}>{v.br||"–"}</td>
                  <td style={{ padding: "7px 5px", color: C.green, fontWeight: 800, fontSize: 15 }}>{v.ne||"–"}</td>
                  <td style={{ padding: "7px 5px", color: C.sec, fontStyle: "italic", fontSize: 12 }}>{v.br>0?Math.round(v.br*(20/at)):"–"}</td>
                  <td style={{ padding: "7px 5px", color: v.st>0?C.red:C.dim }}>{v.st||"–"}</td>
                  <td style={{ padding: "7px 5px" }}>{clR>0?<Badge v={`${clR.toFixed(0)}%`} color={clR>30?C.green:clR>15?C.amber:C.sec}/>:<span style={{color:C.dim}}>–</span>}</td>
                  <td style={{ padding: "7px 5px" }}>{v.st>0?<Badge v={`${stR.toFixed(0)}%`} color={stR>20?C.red:C.orange}/>:<span style={{color:C.dim}}>–</span>}</td>
                  <td style={{ padding: "7px 5px", color: C.cyan }}>{v.sf||"–"}</td>
                  <td style={{ padding: "7px 5px" }}>{ausl>0?<Badge v={`${ausl.toFixed(0)}%`} color={ausl>70?C.green:ausl>40?C.amber:C.red}/>:<span style={{color:C.dim}}>–</span>}</td>
                  <td style={{ padding: "7px 5px", color: v.sp>0?C.teal:C.dim, fontWeight: v.sp>0?700:400 }}>{v.sp||"–"}</td>
                  <td style={{ padding: "7px 5px", color: v.eigen>0?C.green:C.dim, fontWeight: v.eigen>0?700:400 }}>{v.eigen||"–"}</td>
                  <td style={{ padding: "7px 5px", color: v.empf>0?C.pink:C.dim, fontWeight: v.empf>0?700:400 }}>{v.empf||"–"}</td>
                  <td style={{ padding: "7px 5px", fontWeight: 700 }}>{elUnder ? <span style={{ color: C.red, fontSize: 16 }} title={`Potenzial: ${potEL} EL (nur ${v.el} generiert)`}>✘ {v.el||0}</span> : <span style={{ color: v.el>0?C.orange:C.dim }}>{v.el||"–"}</span>}</td>
                  <td style={{ padding: "7px 5px", color: C.dim, fontSize: 11 }}>{potEL}</td>
                  <td style={{ padding: "7px 5px", color: C.amber, fontWeight: 700 }}>{v.prov>0?eur(v.prov):"–"}</td>
                  <td style={{ padding: "7px 5px", color: C.cyan }}>{v.kwp>0?v.kwp:"–"}</td>
                </tr>
              );
            })}</tbody>
          </table>
        </div>
      </Sec>
      <Sec title="🏆 Berater – Sales Total (Jan + Feb)">
        <div style={{ fontSize: 11, color: C.dim, marginBottom: 8 }}>269 Brutto · 208 Netto · 61 Storno · 4,39M € Umsatz</div>
        <ResponsiveContainer width="100%" height={Math.max(500, SALES.beraterTotal.length*22)}>
          <BarChart data={SALES.beraterTotal} layout="vertical" margin={{ left: 150 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={140}/>
            <Tooltip content={<TT/>}/>
            <Bar dataKey="b" fill={C.amber} name="Brutto"/>
            <Bar dataKey="s" fill={C.green} name="Netto"/>
            <Bar dataKey="st" fill={C.red} name="Storno"/>
          </BarChart>
        </ResponsiveContainer>
      </Sec>

      {(() => {
        const [rp, setRp] = React.useState("total");
        const dk = rp==="jan"?"jan":rp==="feb"?"feb":"total";
        const sortBy = (arr) => [...arr].sort((a,b) => b[dk]-a[dk]).filter(x=>x[dk]>0);
        const eigenSorted = sortBy(SALES.topEigenlead);
        const empfSorted = sortBy(SALES.topEmpfehlung);
        const spSorted = sortBy(SALES.topSpeicher);
        const sumE = (k) => SALES.topEigenlead.reduce((s,x)=>s+x[k],0);
        const sumEm = (k) => SALES.topEmpfehlung.reduce((s,x)=>s+x[k],0);
        const sumSp = (k) => SALES.topSpeicher.reduce((s,x)=>s+x[k],0);
        return (<>
          <div style={{ display:"flex",gap:8,margin:"16px 0 8px" }}>
            {[["jan","Januar"],["feb","Februar"],["total","Total"]].map(([k,l])=>(
              <button key={k} onClick={()=>setRp(k)} style={{ padding:"6px 16px",borderRadius:8,border:"none",cursor:"pointer",
                background:rp===k?C.green:"transparent",color:rp===k?"#06080F":C.sec,fontWeight:rp===k?800:500,fontSize:13 }}>{l}</button>
            ))}
          </div>
          <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
            <div style={{ flex: "1 1 300px" }}>
              <Sec title={`🏠 Top Eigenleads (${rp==="jan"?"Jan":rp==="feb"?"Feb":"Jan+Feb"} Netto)`}>
                <div style={{ fontSize: 11, color: C.dim, marginBottom: 6 }}>{rp==="jan"?sumE("jan"):rp==="feb"?sumE("feb"):sumE("total")} Eigenleads</div>
                <ResponsiveContainer width="100%" height={Math.max(200, eigenSorted.length*28)}>
                  <BarChart data={eigenSorted} layout="vertical" margin={{ left: 140 }}>
                    <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                    <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
                    <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={130}/>
                    <Tooltip content={<TT/>}/>
                    <Bar dataKey={rp==="feb"?"_hide":"jan"} stackId="a" fill={C.blue} name="Jan" radius={rp==="jan"?[0,6,6,0]:[0,0,0,0]}/>
                    <Bar dataKey={rp==="jan"?"_hide":"feb"} stackId="a" fill={C.green} name="Feb" radius={[0,6,6,0]}/>
                  </BarChart>
                </ResponsiveContainer>
              </Sec>
            </div>
            <div style={{ flex: "1 1 300px" }}>
              <Sec title={`🤝 Top Empfehlungen (${rp==="jan"?"Jan":rp==="feb"?"Feb":"Jan+Feb"} Netto)`}>
                <div style={{ fontSize: 11, color: C.dim, marginBottom: 6 }}>{rp==="jan"?sumEm("jan"):rp==="feb"?sumEm("feb"):sumEm("total")} Empfehlungen</div>
                <ResponsiveContainer width="100%" height={Math.max(200, empfSorted.length*28)}>
                  <BarChart data={empfSorted} layout="vertical" margin={{ left: 140 }}>
                    <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                    <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
                    <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={130}/>
                    <Tooltip content={<TT/>}/>
                    <Bar dataKey={rp==="feb"?"_hide":"jan"} stackId="a" fill={C.blue} name="Jan" radius={rp==="jan"?[0,6,6,0]:[0,0,0,0]}/>
                    <Bar dataKey={rp==="jan"?"_hide":"feb"} stackId="a" fill={C.green} name="Feb" radius={[0,6,6,0]}/>
                  </BarChart>
                </ResponsiveContainer>
              </Sec>
            </div>
          </div>
          <Sec title={`🔋 Top Speichererweiterungen (${rp==="jan"?"Jan":rp==="feb"?"Feb":"Jan+Feb"} Netto)`}>
            <div style={{ fontSize: 11, color: C.dim, marginBottom: 6 }}>{rp==="jan"?sumSp("jan"):rp==="feb"?sumSp("feb"):sumSp("total")} Speichererweiterungen{rp==="total"?" · 25% aller Netto-Sales":""}</div>
            <ResponsiveContainer width="100%" height={Math.max(200, spSorted.length*28)}>
              <BarChart data={spSorted} layout="vertical" margin={{ left: 140 }}>
                <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
                <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={130}/>
                <Tooltip content={<TT/>}/>
                <Bar dataKey={rp==="feb"?"_hide":"jan"} stackId="a" fill={C.blue} name="Jan" radius={rp==="jan"?[0,6,6,0]:[0,0,0,0]}/>
                    <Bar dataKey={rp==="jan"?"_hide":"feb"} stackId="a" fill={C.green} name="Feb" radius={[0,6,6,0]}/>
              </BarChart>
            </ResponsiveContainer>
          </Sec>
        </>);
      })()}
    </div>
  );
};


// ═══ TAB: CALL CENTER ═══
const TabCC = () => {
  const [period, setPeriod] = React.useState("feb");
  const agentColors = { "Jasmin Hübner": "#58A6FF", "Nadia Kucab": "#3FB950", "Selin Aylikcioglu": "#F0A030", "Jenny Litke": "#F85149", "Mensure Baykan": "#BC8CFF", "Celine Madlaine": "#39D2C0" };
  const s = CC.summary;
  const cur = period==="jan"?s.jan:period==="total"?s.total:s.feb;
  const PBtn = ({k,l}) => <button onClick={()=>setPeriod(k)} style={{ padding:"5px 14px",borderRadius:8,border:`1px solid ${period===k?C.cyan:C.border}`,background:period===k?C.cyan+"18":"transparent",color:period===k?C.cyan:C.sec,fontSize:11,fontWeight:600,cursor:"pointer" }}>{l}</button>;

  return (
    <div>
      <div style={{ display:"flex",gap:6,marginBottom:16 }}>
        <PBtn k="feb" l="Februar"/><PBtn k="jan" l="Januar"/><PBtn k="total" l="Total"/>
      </div>

      <div style={{ display: "flex", gap: 12, flexWrap: "wrap", marginBottom: 20 }}>
        <KPI label="Termine erstellt" value={cur.erstellt} sub={cur.erAT?`${cur.erAT}/AT bei ${cur.at} AT`:""} color={C.cyan}/>
        <KPI label="Stattgefunden" value={cur.sf} sub={cur.af?`+ ${cur.af} AF`:""} color={C.green}/>
        <KPI label="Ausgefallen-Quote" value={`${cur.afP||Math.round(cur.af/(cur.sf+cur.af)*100)}%`} sub={`${cur.af} ausgefallen`} color={cur.afP>40?C.red:C.amber}/>
        {period==="feb" && <KPI label="Ø Erstellt/AT" value="32,9" sub="vs. Jan 20,7 (+59%)" color={C.green}/>}
        {period==="jan" && <KPI label="Ø Erstellt/AT" value="20,7" sub="21 Arbeitstage" color={C.cyan}/>}
      </div>

      <Sec title="👩‍💼 Agenten-Performance">
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 13 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Agent","Erstellt","Stattgef.","Ausgef.","Ausgef.%","Ø/AT","Sales B","Sales N"].map(h => (
                <th key={h} style={{ textAlign: h==="Agent"?"left":"center", padding: "8px 6px", color: C.sec, fontWeight: 600, fontSize: 11 }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{CC.agents.map((a,i) => {
              const er = period==="jan"?a.erJan:period==="total"?a.erTotal:a.erFeb;
              const sf = period==="jan"?a.sfJan:period==="total"?a.sfTotal:a.sfFeb;
              const af = period==="jan"?a.afJan:period==="total"?a.afTotal:a.afFeb;
              const afP = (sf+af)>0?Math.round(af/(sf+af)*100):0;
              const at = period==="jan"?21:period==="total"?29:8;
              const erAT = (er/at).toFixed(1);
              const sale = CC.agentSales.find(s=>s.n===a.n);
              return (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                  <td style={{ padding: "8px 6px", fontWeight: 600 }}><span style={{ display:"inline-block",width:8,height:8,borderRadius:4,background:agentColors[a.n]||C.sec,marginRight:8 }}/>{a.n}</td>
                  <td style={{ textAlign:"center",padding:"8px 6px",color:C.cyan,fontWeight:800,fontSize:15 }}>{er}</td>
                  <td style={{ textAlign:"center",padding:"8px 6px",color:C.green,fontWeight:700 }}>{sf}</td>
                  <td style={{ textAlign:"center",padding:"8px 6px",color:af>15?C.red:C.amber }}>{af}</td>
                  <td style={{ textAlign:"center",padding:"8px 6px" }}><Badge v={`${afP}%`} color={afP>45?C.red:afP>35?C.amber:C.green}/></td>
                  <td style={{ textAlign:"center",padding:"8px 6px",color:C.sec,fontSize:12 }}>{erAT}</td>
                  <td style={{ textAlign:"center",padding:"8px 6px",color:C.amber,fontWeight:700 }}>{sale?sale.b:"–"}</td>
                  <td style={{ textAlign:"center",padding:"8px 6px",color:C.green,fontWeight:700 }}>{sale?sale.s:"–"}</td>
                </tr>
              );
            })}</tbody>
            <tfoot><tr style={{ borderTop: `2px solid ${C.border}`, fontWeight: 700 }}>
              <td style={{ padding: "8px 6px" }}>Gesamt</td>
              <td style={{ textAlign:"center",padding:"8px 6px",color:C.cyan }}>{cur.erstellt}</td>
              <td style={{ textAlign:"center",padding:"8px 6px",color:C.green }}>{cur.sf}</td>
              <td style={{ textAlign:"center",padding:"8px 6px",color:C.amber }}>{cur.af||CC.agents.reduce((s,a)=>s+(period==="jan"?a.afJan:period==="total"?a.afTotal:a.afFeb),0)}</td>
              <td style={{ textAlign:"center",padding:"8px 6px" }}><Badge v={`${cur.afP||Math.round((cur.af||0)/(cur.sf+(cur.af||0))*100)}%`} color={C.amber}/></td>
              <td style={{ textAlign:"center",padding:"8px 6px",color:C.sec,fontSize:12 }}>{cur.erAT||(cur.erstellt/29).toFixed(1)}</td>
              <td style={{ textAlign:"center",padding:"8px 6px",color:C.amber,fontWeight:700 }}>11</td>
              <td style={{ textAlign:"center",padding:"8px 6px",color:C.green,fontWeight:700 }}>8</td>
            </tr></tfoot>
          </table>
        </div>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 6 }}>Sales = Aufträge deren Kunde durch diesen CC-Agenten terminiert wurde</div>
      </Sec>

      <Sec title="📆 Erstellte Termine pro Wochentag (Feb)">
        <ResponsiveContainer width="100%" height={300}>
          <BarChart data={CC.weekdayFeb}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 12 }}/>
            <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
            <Tooltip content={<TT/>}/>
            {Object.entries(agentColors).map(([name,color]) => (
              <Bar key={name} dataKey={name.split(" ")[0]} stackId="a" fill={color} name={name}/>
            ))}
          </BarChart>
        </ResponsiveContainer>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>Di stärkster Tag (68) · Mi 64 · Do 62 · Sa nur Nadia (9)</div>
      </Sec>

      <Sec title="📊 Erstellte Termine – Agenten pro Tag (letzte 7 Tage)">
        <ResponsiveContainer width="100%" height={350}>
          <BarChart data={CC.dailyFeb.slice(-7)} margin={{ left: 0 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
            <Tooltip content={<TT/>}/>
            {Object.entries(agentColors).map(([name,color]) => (
              <Bar key={name} dataKey={name.split(" ")[0]} stackId="a" fill={color} name={name}/>
            ))}
          </BarChart>
        </ResponsiveContainer>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>07.02. = Samstag (nur Nadia im Dienst) · Stärkste Tage: 09.02. (39) + 11.02. (39)</div>
      </Sec>

      <Sec title="📞 Leadquellen der CC-Termine (Feb)">
        <ResponsiveContainer width="100%" height={250}>
          <BarChart data={CC.quellenFeb} layout="vertical" margin={{ left: 80 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={70}/>
            <Tooltip content={<TT/>}/>
            <Bar dataKey="v" name="Termine" radius={[0,6,6,0]}>
              {CC.quellenFeb.map((_,i) => <Cell key={i} fill={[C.blue,C.green,C.amber,C.purple,C.orange,C.dim][i]}/>)}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>SADD 44% · Enpal 34% · EzA 10% · MVPP 9%</div>
      </Sec>

      <Sec title="📈 Jan vs. Feb Vergleich">
        <ResponsiveContainer width="100%" height={300}>
          <BarChart data={[
            { m: "Jan (21 AT)", erstellt: 434, sf: 220, af: 158, erAT: 20.7 },
            { m: "Feb (9 AT)", erstellt: 296, sf: 117, af: 76, erAT: 32.9 },
          ]} margin={{ left: 0 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis dataKey="m" tick={{ fill: C.sec, fontSize: 12 }}/>
            <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
            <Tooltip content={<TT/>}/>
            <Bar dataKey="erstellt" fill={C.cyan} name="Erstellt" radius={[6,6,0,0]}/>
            <Bar dataKey="sf" fill={C.green} name="Stattgefunden" radius={[6,6,0,0]}/>
            <Bar dataKey="af" fill={C.red} name="Ausgefallen" radius={[6,6,0,0]}/>
          </BarChart>
        </ResponsiveContainer>
        <div style={{ display: "flex", gap: 12, flexWrap: "wrap", marginTop: 12 }}>
          <KPI small label="Erstellt/AT" value="+59%" sub="20,7 → 32,9" color={C.green}/>
          <KPI small label="Ausgefallen-Quote" value="−3 pp" sub="42% → 39%" color={C.green}/>
          <KPI small label="SF/AT" value="+24%" sub="10,5 → 13,0" color={C.green}/>
        </div>
      </Sec>

      <Sec title="📊 Lead-Qualifizierung (LMT-Daten)">
        <div style={{ fontSize: 11, color: C.sec, marginBottom: 10 }}>Wie viele LMT-Leads hat jeder Agent bearbeitet und mit welcher Conversion terminiert?</div>
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Agent","Leads","Term.+Angebot","Term%","AB","!PLZ","REKL","Waste%"].map(h => (
                <th key={h} style={{ textAlign: h==="Agent"?"left":"right", padding: "7px 6px", color: C.sec, fontWeight: 600, fontSize: 10 }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{(() => {
              const ccData = period==="jan"?LMT.jan.cc:period==="total"?LMT.total.cc:LMT.feb.cc;
              return ccData.map((a,i) => {
                const r = a.t>0?(a.term+a.ang)/a.t*100:0;
                const w = a.t>0?(a.nplz+a.rekl)/a.t*100:0;
                return (
                  <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                    <td style={{ padding: "6px", fontWeight: 600 }}><span style={{ display:"inline-block",width:8,height:8,borderRadius:4,background:agentColors[a.n]||C.sec,marginRight:8 }}/>{a.n}</td>
                    <td style={{ textAlign:"right",padding:"6px",fontWeight:700 }}>{a.t}</td>
                    <td style={{ textAlign:"right",padding:"6px",color:C.green,fontWeight:700 }}>{a.term+a.ang}</td>
                    <td style={{ textAlign:"right",padding:"6px" }}><Badge v={`${r.toFixed(1)}%`} color={r>10?C.green:r>5?C.amber:C.red}/></td>
                    <td style={{ textAlign:"right",padding:"6px",color:a.ab>0?C.green:C.dim }}>{a.ab||"–"}</td>
                    <td style={{ textAlign:"right",padding:"6px",color:C.purple }}>{a.nplz}</td>
                    <td style={{ textAlign:"right",padding:"6px",color:C.red }}>{a.rekl}</td>
                    <td style={{ textAlign:"right",padding:"6px" }}><Badge v={`${w.toFixed(0)}%`} color={w>50?C.red:w>30?C.amber:C.green}/></td>
                  </tr>
                );
              });
            })()}</tbody>
          </table>
        </div>
        <div style={{ fontSize: 10, color: C.dim, marginTop: 6 }}>Waste = (!PLZ + REKL) / Leads · Hoher Waste-Anteil = viele unqualifizierte Leads zugewiesen (oft SADD/Enpal)</div>
      </Sec>
    </div>
  );
};

// ═══ TAB: ANALYSE ═══
const TabAnalyse = () => {
  const avgStorno = Math.round(61/269*100); // 61 storno / 269 brutto total
  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 24 }}>
      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <KPI label="Storno gesamt" value="61" sub="von 269 Brutto · 22,7%" color={C.red}/>
        <KPI label="Eigenleads Storno" value="11%" sub="4 von 36 · Bester Wert" color={C.green}/>
        <KPI label="EzA Storno" value="56%" sub="5 von 9 · Schlechtester" color={C.red}/>
        <KPI label="Ø Speed Eigenlead" value="6,8d" sub="Median 5d · Schnellste Quelle" color={C.green}/>
      </div>

      <Sec title="🔴 Storno-Rate pro Leadquelle (Jan+Feb)">
        <ResponsiveContainer width="100%" height={250}>
          <BarChart data={ANALYSE.stornoQuelle} layout="vertical" margin={{ left: 100 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis type="number" unit="%" domain={[0,60]} tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={90}/>
            <Tooltip content={<TT/>}/>
            <Bar dataKey="rate" name="Storno-Rate %" radius={[0,6,6,0]}>
              {ANALYSE.stornoQuelle.map((d,i) => <Cell key={i} fill={d.rate>30?C.red:d.rate>20?C.amber:C.green}/>)}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>
          <strong style={{ color: C.red }}>EzA 56%</strong> und <strong style={{ color: C.red }}>SADD 35%</strong> höchste Storno · <strong style={{ color: C.green }}>Eigenlead 11%</strong> stabilste Quelle
        </div>
      </Sec>

      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 400px" }}>
          <Sec title="🔴 Storno-Rate pro Berater (≥2 Storno)">
            <ResponsiveContainer width="100%" height={340}>
              <BarChart data={ANALYSE.stornoBerater} layout="vertical" margin={{ left: 140 }}>
                <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                <XAxis type="number" unit="%" domain={[0,85]} tick={{ fill: C.sec, fontSize: 11 }}/>
                <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={130}/>
                <Tooltip content={<TT/>}/>
                <Bar dataKey="rate" name="Storno-Rate %" radius={[0,6,6,0]}>
                  {ANALYSE.stornoBerater.map((d,i) => <Cell key={i} fill={d.rate>40?C.red:d.rate>25?C.amber:C.green}/>)}
                </Bar>
              </BarChart>
            </ResponsiveContainer>
            <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>
              <strong style={{ color: C.red }}>Kadir 80%</strong> (4/5) · <strong style={{ color: C.red }}>Marco 75%</strong> (3/4) · Gino 12 Storno absolut meiste
            </div>
          </Sec>
        </div>
      </div>

      <Sec title="📉 Ausgefallen-Quote pro Berater (Feb, ≥5 Termine)">
        <ResponsiveContainer width="100%" height={Math.max(300, ANALYSE.afBerater.length*22)}>
          <BarChart data={ANALYSE.afBerater} layout="vertical" margin={{ left: 145 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
            <XAxis type="number" unit="%" domain={[0,100]} tick={{ fill: C.sec, fontSize: 11 }}/>
            <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={135}/>
            <Tooltip content={<TT/>}/>
            <Bar dataKey="rate" name="Ausgefallen %" radius={[0,6,6,0]}>
              {ANALYSE.afBerater.map((d,i) => <Cell key={i} fill={d.rate>50?C.green:d.rate>35?C.amber:C.red}/>)}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>
          <strong style={{ color: C.red }}>Miguel 88%</strong> Ausgefallen – fast alle Termine ausgefallen · <strong style={{ color: C.green }}>Daniel 7%</strong> + Pascal Sch. 11% beste Werte
        </div>
      </Sec>

      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 400px" }}>
          <Sec title="🔋 Speicher-Upsell pro Leadquelle">
            <ResponsiveContainer width="100%" height={230}>
              <BarChart data={ANALYSE.speicherQuelle} layout="vertical" margin={{ left: 100 }}>
                <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                <XAxis type="number" unit="%" domain={[0,50]} tick={{ fill: C.sec, fontSize: 11 }}/>
                <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={90}/>
                <Tooltip content={<TT/>}/>
                <Bar dataKey="rate" name="Speicher-Quote %" radius={[0,6,6,0]}>
                  {ANALYSE.speicherQuelle.map((d,i) => <Cell key={i} fill={d.rate>30?C.green:d.rate>15?C.amber:C.red}/>)}
                </Bar>
              </BarChart>
            </ResponsiveContainer>
            <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>
              <strong style={{ color: C.green }}>Empfehlung 41%</strong> beste Upsell-Quote · <strong style={{ color: C.green }}>Omega 32%</strong> · MVPP nur 20%
            </div>
          </Sec>
        </div>
        <div style={{ flex: "1 1 400px" }}>
          <Sec title="📊 Quellen-Scorecard">
            <div style={{ overflowX: "auto" }}>
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
                <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
                  {["Quelle","Netto","Storno%","Speed Ø","Speicher%"].map(h => (
                    <th key={h} style={{ padding: "6px 8px", textAlign: h==="Quelle"?"left":"center", color: C.sec, fontSize: 10, fontWeight: 600 }}>{h}</th>
                  ))}
                </tr></thead>
                <tbody>{ANALYSE.stornoQuelle.map((q,i) => {
                  const sp = ANALYSE.speicherQuelle.find(s=>s.n===q.n);
                  const sd = ANALYSE.speedQuelle.find(s=>s.n===q.n);
                  return (
                    <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                      <td style={{ padding: "6px 8px", fontWeight: 600 }}>{q.n}</td>
                      <td style={{ textAlign: "center", padding: "6px", color: C.green, fontWeight: 700 }}>{q.netto}</td>
                      <td style={{ textAlign: "center", padding: "6px" }}><Badge v={`${q.rate}%`} color={q.rate>30?C.red:q.rate>20?C.amber:C.green}/></td>
                      <td style={{ textAlign: "center", padding: "6px", color: sd&&sd.avg<10?C.green:C.red }}>{sd?`${sd.avg.toFixed(1)}d`:"–"}</td>
                      <td style={{ textAlign: "center", padding: "6px" }}><Badge v={`${sp?sp.rate:0}%`} color={sp&&sp.rate>25?C.green:C.amber}/></td>
                    </tr>
                  );
                })}</tbody>
              </table>
            </div>
            <div style={{ fontSize: 11, color: C.dim, marginTop: 6 }}>Eigenlead = Bester Gesamtwert: 11% Storno, 6,8d Speed, 25% Speicher</div>
          </Sec>
        </div>
      </div>

      <Sec title="🧩 Berater × Quelle Matrix (Top 12, Netto Jan+Feb)">
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Berater","Total","MVPP","Omega","SADD","Eigen","Empf.","EzA"].map(h => (
                <th key={h} style={{ padding: "6px 8px", textAlign: h==="Berater"?"left":"center", color: C.sec, fontSize: 10, fontWeight: 600 }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{ANALYSE.beraterQuelle.map((b,i) => (
              <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                <td style={{ padding: "6px 8px", fontWeight: 600 }}>{b.n}</td>
                <td style={{ textAlign: "center", padding: "6px", color: C.green, fontWeight: 800, fontSize: 14 }}>{b.total}</td>
                {["MVPP","Omega","SADD","Eigen","Empf","EzA"].map(q => {
                  const v = b[q]||0;
                  const maxV = Math.max(...ANALYSE.beraterQuelle.map(x=>x[q]||0));
                  const bg = v>0 ? `rgba(${q==="MVPP"?"99,102,241":q==="Omega"?"249,115,22":q==="SADD"?"239,68,68":q==="Eigen"?"34,197,94":q==="Empf"?"236,72,153":"168,85,247"}, ${Math.min(v/Math.max(maxV,1)*0.4+0.1,0.5)})` : "transparent";
                  return <td key={q} style={{ textAlign: "center", padding: "6px", background: bg, fontWeight: v>3?700:400, color: v>0?C.text:C.dim }}>{v||"·"}</td>;
                })}
              </tr>
            ))}</tbody>
          </table>
        </div>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 6 }}>
          Tayfun & Gino MVPP-Kings · Martin Bott = Omega-Spezialist · Pascal Sch. & Richard W. = Eigenlead-Maschinen
        </div>
      </Sec>
    </div>
  );
};


// ═══ TAB: TREND ═══
const TabTrend = () => (
  <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
    <div style={{ background: `linear-gradient(135deg, ${C.purple}12, ${C.cyan}08)`, borderRadius: 14, padding: "18px 24px", border: `1px solid ${C.purple}25` }}>
      <span style={{ fontSize: 20, fontWeight: 800, color: C.text }}>📈 Trend – Jan vs. Feb 2026</span>
      <div style={{ fontSize: 12, color: C.sec }}>Jan (21 AT komplett) vs. Feb (7 AT bisher) · Hochrechnung pro Arbeitstag</div>
    </div>

    <Sec title="🔢 Monatszahlen absolut">
      <ResponsiveContainer width="100%" height={280}>
        <BarChart data={TREND.months}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="m" tick={{ fill: C.sec, fontSize: 12 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 11 }}/>
          <Bar dataKey="brutto" fill={C.amber} name="Brutto Sales"/>
          <Bar dataKey="netto" fill={C.green} name="Netto Sales"/>
          <Bar dataKey="storno" fill={C.red} name="Storno"/>
        </BarChart>
      </ResponsiveContainer>
    </Sec>

    <Sec title="⚡ Pro Arbeitstag (normalisiert)">
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap", marginBottom: 16 }}>
        {TREND.perAT.map((p,i) => (
          <div key={i} style={{ background: C.card, borderRadius: 12, padding: "14px 18px", border: `1px solid ${C.border}`, flex: "1 1 200px" }}>
            <div style={{ fontSize: 14, fontWeight: 800, color: C.text, marginBottom: 8 }}>{p.m}</div>
            <div style={{ display: "flex", gap: 14, flexWrap: "wrap", fontSize: 12 }}>
              <div><span style={{ color: C.amber, fontWeight: 700 }}>{p.brutto}</span> <span style={{ color: C.sec }}>Brutto/AT</span></div>
              <div><span style={{ color: C.green, fontWeight: 700 }}>{p.netto}</span> <span style={{ color: C.sec }}>Netto/AT</span></div>
              <div><span style={{ color: C.cyan, fontWeight: 700 }}>{eur(p.umsatz)}</span> <span style={{ color: C.sec }}>Umsatz/AT</span></div>
              <div><span style={{ color: C.blue, fontWeight: 700 }}>{p.terme_er.toFixed(0)}</span> <span style={{ color: C.sec }}>Terme erst./AT</span></div>
              <div><span style={{ color: C.purple, fontWeight: 700 }}>{p.terme_sf.toFixed(0)}</span> <span style={{ color: C.sec }}>Stattg./AT</span></div>
            </div>
          </div>
        ))}
      </div>
      <ResponsiveContainer width="100%" height={240}>
        <BarChart data={TREND.perAT}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="m" tick={{ fill: C.sec, fontSize: 12 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 11 }}/>
          <Bar dataKey="brutto" fill={C.amber} name="Brutto/AT"/>
          <Bar dataKey="netto" fill={C.green} name="Netto/AT"/>
        </BarChart>
      </ResponsiveContainer>
    </Sec>

    <Sec title="📉 Stornoquote">
      <ResponsiveContainer width="100%" height={200}>
        <BarChart data={TREND.months}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="m" tick={{ fill: C.sec, fontSize: 12 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false} unit="%"/>
          <Tooltip content={<TT/>}/>
          <Bar dataKey="stornoP" fill={C.red} name="Stornoquote %" radius={[6,6,0,0]} barSize={60}/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 11, color: C.sec, marginTop: 4 }}>Jan: 26,1% (52/199) → Feb: 14,5% (9/62) – deutliche Verbesserung</div>
    </Sec>

    <Sec title="📦 Leadquellen-Shift">
      <ResponsiveContainer width="100%" height={300}>
        <BarChart data={TREND.leadQuellen} layout="vertical" margin={{ left: 80 }}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
          <YAxis type="category" dataKey="q" tick={{ fill: C.sec, fontSize: 12 }} width={70}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 11 }}/>
          <Bar dataKey="jan" fill={C.blue} name="Jan"/>
          <Bar dataKey="feb" fill={C.cyan} name="Feb (bisher)"/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 11, color: C.sec, marginTop: 4 }}>Enpal explodiert: 208 → 897 (+331%) · SADD halbiert: 2338 → 1082</div>
    </Sec>

    <Sec title="🏆 Top Berater – Jan vs. Feb (Brutto)">
      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        {[{title:"Jan 2026 (21 AT)",data:TREND.topBeraterJan},{title:"Feb 2026 (7 AT)",data:TREND.topBeraterFeb}].map((block,bi) => (
          <div key={bi} style={{ flex: "1 1 320px" }}>
            <div style={{ fontSize: 13, fontWeight: 700, color: C.text, marginBottom: 8 }}>{block.title}</div>
            <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
              <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
                {["Berater","B","N","St","Umsatz"].map(h => <th key={h} style={{ padding: "6px 4px", textAlign: "left", color: C.sec, fontWeight: 600, fontSize: 9, textTransform: "uppercase" }}>{h}</th>)}
              </tr></thead>
              <tbody>{block.data.map((b,i) => (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                  <td style={{ padding: "5px 4px", color: C.text, fontWeight: 600 }}>{b.n}</td>
                  <td style={{ padding: "5px 4px", color: C.amber, fontWeight: 700 }}>{b.b}</td>
                  <td style={{ padding: "5px 4px", color: C.green, fontWeight: 700 }}>{b.s}</td>
                  <td style={{ padding: "5px 4px", color: b.st>0?C.red:C.dim }}>{b.st||"–"}</td>
                  <td style={{ padding: "5px 4px", color: C.cyan }}>{eur(b.e)}</td>
                </tr>
              ))}</tbody>
            </table>
          </div>
        ))}
      </div>
    </Sec>

    <Sec title="📞 CC vs. Andere – Jan vs. Feb">
      <ResponsiveContainer width="100%" height={220}>
        <BarChart data={TREND.months}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="m" tick={{ fill: C.sec, fontSize: 12 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }} axisLine={false}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 11 }}/>
          <Bar dataKey="cc" fill={C.cyan} name="Call Center"/>
          <Bar dataKey="andere" fill={C.sec} name="Andere (Scouter/Omega/Eigen/Empf)" opacity={0.5}/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 11, color: C.sec, marginTop: 4 }}>CC-Anteil: Jan {(590/1456*100).toFixed(0)}% → Feb {(289/803*100).toFixed(0)}% · Feb CC pro AT: {(289/7).toFixed(0)} vs Jan: {(590/21).toFixed(0)}</div>
    </Sec>
  </div>
);

// ═══ TAB: ENPAL ═══
const SB_URL = window.BEEDOO_CONFIG?.SB_URL || 'https://hqzpemfaljxcysyqssng.supabase.co';
const SB_SRV = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhxenBlbWZhbGp4Y3lzeXFzc25nIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MTMzNTM5NywiZXhwIjoyMDg2OTExMzk3fQ.MJ3cyAAquE8DK2ngzfIIn4bTpQ8_H9DaeJ3YTlBdFz4';

async function syncEnpalToSupabase(E) {
  const label = new Date().toLocaleString('de-DE');
  // Build rows from ENPAL data object
  const rows = [];
  // KPI summary row
  rows.push({ type:'kpi', monat:'Feb 2026', leads_feb: E.feb.leads, leads_jan: E.jan.leads,
    terminiert: E.feb.term + E.feb.ang, termine_erstellt: E.terme,
    stattgefunden: E.termeAbg, ausgefallen: E.termeAF, offen: E.termeOffen,
    sales: E.sales, sales_netto: E.salesNetto,
    reklamation: E.feb.rekl, ne5: E.feb.ne5||0, ne: E.feb.ne, wvl: E.feb.wvl||0,
    wp_leads: E.feb.wp, klassisch_leads: E.feb.kl });
  // Daily import rows
  E.dailyImport.forEach(d => rows.push({ type:'daily_import', datum:d.d, wp:d.wp, kl:d.kl, total:d.t }));
  // Daily termine erstellt
  E.dailyErstellt.forEach(d => rows.push({ type:'daily_erstellt', datum:d.d, wp:d.wp, kl:d.kl, total:d.t }));
  // Daily termine sf/af/offen
  E.dailyTermine.forEach(d => rows.push({ type:'daily_termine', datum:d.d, stattgef:d.abg, ausgef:d.af, offen:d.offen, total:d.t }));
  // Berater
  E.berater.forEach(b => rows.push({ type:'berater', name:b.n, termine:b.t }));
  // CC Enpal agents
  E.ccEnpal.forEach(b => rows.push({ type:'cc_agent', name:b.n, leads:b.leads, terminiert:b.term, rekl:b.rekl, rate:b.rate }));
  // Lead speed
  E.speed.buckets.forEach(b => rows.push({ type:'speed_bucket', name:b.n, count:b.v }));
  rows.push({ type:'speed_summary', median:E.speed.median, avg:E.speed.avg, unter24h_pct:E.speed.unter24hP });
  // Abschluss
  E.abschluss.forEach(b => rows.push({ type:'abschluss', name:b.n, count:b.v }));
  // Lead status
  E.leadStatus.forEach(s => rows.push({ type:'lead_status', name:s.name, count:s.v }));
  // Benchmark
  E.benchmark.forEach(b => rows.push({ type:'benchmark', name:b.n, leads:b.leads, term:b.term, termP:b.termP, rekl:b.rekl, reklP:b.reklP }));
  // Pipeline
  rows.push({ type:'pipeline', wvl:E.pipeline.wvl, wvlU3d:E.pipeline.wvlU3d, wvl3to7d:E.pipeline.wvl3to7d, wvlU7d:E.pipeline.wvlU7d, ne:E.pipeline.ne, ne5:E.pipeline.ne5, neTotal:E.pipeline.neTotal, neU3d:E.pipeline.neU3d, ne3to7d:E.pipeline.ne3to7d, neU7d:E.pipeline.neU7d });
  // Wochentag
  E.wochentag.forEach(w => rows.push({ type:'wochentag', name:w.d, stattgef:w.abg, ausgef:w.af, offen:w.offen }));
  // PLZ
  E.plz.forEach(p => rows.push({ type:'plz', name:p.n, leads:p.leads, term:p.term, rate:p.rate }));
  // Terminierer
  E.terminierer.forEach(t => rows.push({ type:'terminierer', name:t.n, termine:t.t }));
  // AF-Gründe
  E.afGruende.forEach(a => rows.push({ type:'af_grund', name:a.n, count:a.v }));

  // Delete existing reporting rows + insert fresh
  await fetch(SB_URL + '/rest/v1/enpal_leads?import_label=like.REPORTING*', {
    method: 'DELETE',
    headers: { 'apikey': SB_SRV, 'Authorization': 'Bearer ' + SB_SRV }
  });
  const payload = rows.map(r => ({ import_label: 'REPORTING::' + label, row_data: r }));
  for (let i = 0; i < payload.length; i += 500) {
    const res = await fetch(SB_URL + '/rest/v1/enpal_leads', {
      method: 'POST',
      headers: { 'apikey': SB_SRV, 'Authorization': 'Bearer ' + SB_SRV, 'Content-Type': 'application/json', 'Prefer': 'return=minimal' },
      body: JSON.stringify(payload.slice(i, i+500))
    });
    if (!res.ok) throw new Error(await res.text());
  }
  return label;
}

const TabEnpal = () => {
  const E = ENPAL;
  const febLeads = E.feb.leads;
  const termRate = (E.feb.term + E.feb.ang) / febLeads * 100;
  const wasteRate = (E.feb.rekl + (E.feb.ne5||0)) / febLeads * 100;
  const [syncing, setSyncing] = React.useState(false);
  const [syncStatus, setSyncStatus] = React.useState(null);

  const doSync = async () => {
    setSyncing(true); setSyncStatus(null);
    try {
      const label = await syncEnpalToSupabase(E);
      setSyncStatus({ ok: true, label });
    } catch(e) {
      setSyncStatus({ ok: false, msg: e.message });
    }
    setSyncing(false);
    setTimeout(() => setSyncStatus(null), 8000);
  };

  return (
  <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
    <div style={{ background: `linear-gradient(135deg, ${C.orange}12, ${C.red}08)`, borderRadius: 14, padding: "18px 24px", border: `1px solid ${C.orange}25`, display:"flex", alignItems:"center", justifyContent:"space-between", flexWrap:"wrap", gap:12 }}>
      <div>
        <span style={{ fontSize: 20, fontWeight: 800, color: C.text }}>⚡ Enpal Partner-Reporting</span>
        <div style={{ fontSize: 12, color: C.sec }}>Enpal gesamt (WP + klassisch) · LMT + Created + Closed · Feb 2026</div>
      </div>
      <div style={{ display:"flex", alignItems:"center", gap:10 }}>
        {syncStatus?.ok && <span style={{ fontSize:12, color:"#22c55e", fontWeight:600 }}>✓ Enpal-Board aktualisiert · {syncStatus.label}</span>}
        {syncStatus && !syncStatus.ok && <span style={{ fontSize:12, color:"#ef4444" }}>✗ Fehler: {syncStatus.msg}</span>}
        <button onClick={doSync} disabled={syncing} style={{ background: syncing ? "#263354" : "#f97316", color:"#fff", border:"none", borderRadius:8, padding:"9px 18px", fontWeight:700, fontSize:13, cursor: syncing ? "not-allowed" : "pointer", fontFamily:"inherit", opacity: syncing ? .7 : 1 }}>
          {syncing ? "⏳ Wird übertragen..." : "📤 Zu Enpal senden"}
        </button>
      </div>
    </div>

    {/* KPIs */}
    <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
      <KPI label="Enpal Leads Feb" value={fmt(febLeads)} sub={`WP: ${fmt(E.feb.wp)} · Klass.: ${E.feb.kl} · Jan: ${E.jan.leads}`} color={C.orange}/>
      <KPI label="Terminiert+Ang" value={fmt(E.feb.term + E.feb.ang)} sub={`${termRate.toFixed(1)}% Rate · Jan: ${E.jan.term+E.jan.ang}`} color={C.green}/>
      <KPI label="Terme erstellt" value={fmt(E.terme)} sub={`WP: ${E.termeWP} · Klass.: ${E.termeKl}`} color={C.cyan}/>
      <KPI label="Stattgef./Ausgef." value={`${E.termeAbg}/${E.termeAF}`} sub={`${E.termeOffen} offen · Ausgef. ${Math.round(E.termeAF/(E.termeAbg+E.termeAF)*100)}%`} color={C.amber}/>
      <KPI label="Sales" value={E.sales} sub={`${eur(E.salesNetto)} · P. Kalinowski`} color={E.sales>0?C.green:C.red}/>
      <KPI label="Waste" value={`${wasteRate.toFixed(0)}%`} sub={`${fmt(E.feb.rekl)} REKL + ${fmt(E.feb.ne5||0)} NE5`} color={C.red}/>
    </div>

    {/* Daily Lead Import */}
    <Sec title="📥 Täglicher Enpal Lead-Import (Feb)">
      <ResponsiveContainer width="100%" height={240}>
        <BarChart data={E.dailyImport}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 11 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 10 }}/>
          <Bar dataKey="wp" stackId="a" fill={C.orange} name="Enpal WP"/>
          <Bar dataKey="kl" stackId="a" fill={C.amber} name="Enpal klassisch" radius={[4,4,0,0]}/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>Ø {Math.round(E.dailyImport.reduce((a,d)=>a+d.t,0)/E.dailyImport.length)}/Tag · <strong style={{ color: C.orange }}>94% WP-Leads</strong> · Peaks: 02.02. (169), 11.02. (130)</div>
    </Sec>

    {/* Daily Termine erstellt */}
    <Sec title="📆 Termine erstellt pro Tag (Feb)">
      <ResponsiveContainer width="100%" height={220}>
        <BarChart data={E.dailyErstellt}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 11 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 10 }}/>
          <Bar dataKey="wp" stackId="a" fill={C.orange} name="WP-Termine"/>
          <Bar dataKey="kl" stackId="a" fill={C.amber} name="Klass.-Terme" radius={[4,4,0,0]}/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>Ø {Math.round(E.dailyErstellt.reduce((a,d)=>a+d.t,0)/E.dailyErstellt.length)}/Tag · {E.terme} gesamt · 91% WP-Termine</div>
    </Sec>

    {/* Daily Termine SF/AF */}
    <Sec title="📊 Termine pro Tag – Stattgef./Ausgef./Offen (DatumTermin Beginn)">
      <ResponsiveContainer width="100%" height={280}>
        <BarChart data={E.dailyTermine}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 10 }} interval={0} angle={-45} textAnchor="end" height={50}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 10 }}/>
          <Bar dataKey="abg" stackId="a" fill={C.green} name="Stattgefunden"/>
          <Bar dataKey="af" stackId="a" fill={C.red} name="Ausgefallen"/>
          <Bar dataKey="offen" stackId="a" fill={C.blue} name="Offen" radius={[4,4,0,0]}/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>
        Bis 12.02.: {E.termeAbg} stattgef., {E.termeAF} ausgef. · <strong style={{ color: C.blue }}>Ab 13.02.: {E.termeOffen} offene Termine</strong> – Ergebnisse folgen
      </div>
    </Sec>

    <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
      <div style={{ flex: "1 1 360px" }}>
        <Sec title={`📊 Leadstatus Feb (${fmt(febLeads)} = 100%)`}>
          <ResponsiveContainer width="100%" height={260}>
            <PieChart><Pie data={E.leadStatus} cx="50%" cy="50%" outerRadius={90} innerRadius={48} dataKey="v" paddingAngle={1.5} stroke="none">
              {E.leadStatus.map((e,i) => <Cell key={i} fill={e.fill}/>)}
            </Pie><Tooltip content={<TT/>}/><Legend wrapperStyle={{ fontSize: 10 }}/></PieChart>
          </ResponsiveContainer>
          <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>{Math.round(E.feb.rekl/febLeads*100)}% Reklamation + {Math.round((E.feb.ne5+E.feb.ne)/febLeads*100)}% nicht erreichbar · nur {termRate.toFixed(1)}% terminiert</div>
        </Sec>
      </div>
      <div style={{ flex: "1 1 360px" }}>
        <Sec title="🔻 Funnel">
          {[
            { s: "Leads (LMT)", v: febLeads, c: C.dim },
            { s: "Qualifiziert", v: febLeads - E.feb.rekl - (E.feb.ne5||0), c: C.purple },
            { s: "Terminiert+Ang", v: E.feb.term + E.feb.ang, c: C.cyan },
            { s: "Terme erstellt", v: E.terme, c: C.blue },
            { s: "Stattgef.", v: E.termeAbg, c: C.amber },
            { s: "Sales", v: E.sales, c: C.green },
          ].map((f,i) => {
            const w = Math.max((f.v/febLeads)*100, 3);
            return (
              <div key={i} style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 6 }}>
                <div style={{ width: 110, textAlign: "right", fontSize: 11, color: C.sec }}>{f.s}</div>
                <div style={{ flex: 1 }}>
                  <div style={{ width: `${w}%`, height: 26, background: f.c, borderRadius: 6, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 11, fontWeight: 800, color: i===0?C.text:"#06080F", minWidth: 30 }}>{fmt(f.v)}</div>
                </div>
              </div>
            );
          })}
          <div style={{ display: "flex", gap: 8, flexWrap: "wrap", marginTop: 8 }}>
            <KPI small label="Lead→Term" value={`${termRate.toFixed(1)}%`} color={C.cyan}/>
            <KPI small label="Term→Stattg." value={`${E.terme>0?Math.round(E.termeAbg/E.terme*100):0}%`} color={C.amber}/>
            <KPI small label="Stattg.→Sale" value={`${E.termeAbg>0?Math.round(E.sales/E.termeAbg*100):0}%`} color={C.green}/>
          </div>
        </Sec>
      </div>
    </div>

    <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
      <div style={{ flex: "1 1 400px" }}>
        <Sec title="👤 Berater (Termine)">
          <ResponsiveContainer width="100%" height={Math.max(E.berater.length*32, 200)}>
            <BarChart data={E.berater} layout="vertical" margin={{ left: 130 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={120}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="t" name="Termine" radius={[0,6,6,0]}>
                {E.berater.map((_,i) => <Cell key={i} fill={CL[i%CL.length]}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </Sec>
      </div>
      <div style={{ flex: "1 1 400px" }}>
        <Sec title="📞 Terminiert von (CC + VB)">
          <ResponsiveContainer width="100%" height={Math.max(E.terminierer.length*32, 200)}>
            <BarChart data={E.terminierer} layout="vertical" margin={{ left: 130 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={120}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="t" name="Termine" radius={[0,6,6,0]}>
                {E.terminierer.map((_,i) => <Cell key={i} fill={CL[i%CL.length]}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </Sec>
      </div>
    </div>

    {/* ═══ 1. CC-Agent Enpal Conversion ═══ */}
    <Sec title="👩‍💼 CC-Agent Enpal-Conversion (LMT Feb)">
      <div style={{ fontSize: 10, color: C.sec, marginBottom: 8 }}>Wie gut qualifiziert jeder Agent speziell Enpal-Leads? Große Unterschiede!</div>
      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 420px" }}>
          <ResponsiveContainer width="100%" height={200}>
            <BarChart data={E.ccEnpal} layout="vertical" margin={{ left: 120 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" unit="%" domain={[0, 20]} tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={110}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="rate" name="Term-Rate %" radius={[0,6,6,0]}>
                {E.ccEnpal.map((d,i) => <Cell key={i} fill={d.rate>15?C.green:d.rate>10?C.amber:C.red}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </div>
        <div style={{ flex: "1 1 420px" }}>
          <div style={{ overflowX: "auto" }}>
            <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11 }}>
              <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
                {["Agent","Leads","Term","Rate","REKL","REKL%"].map(h => (
                  <th key={h} style={{ padding: "5px 4px", textAlign: h==="Agent"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 9 }}>{h}</th>
                ))}
              </tr></thead>
              <tbody>{E.ccEnpal.map((a,i) => (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                  <td style={{ padding: "5px 4px", fontWeight: 600, fontSize: 11 }}>{a.n}</td>
                  <td style={{ padding: "5px 4px", textAlign: "right" }}>{a.leads}</td>
                  <td style={{ padding: "5px 4px", textAlign: "right", color: C.green, fontWeight: 700 }}>{a.term}</td>
                  <td style={{ padding: "5px 4px", textAlign: "right" }}><Badge v={`${a.rate.toFixed(1)}%`} color={a.rate>15?C.green:a.rate>10?C.amber:C.red}/></td>
                  <td style={{ padding: "5px 4px", textAlign: "right", color: C.red }}>{a.rekl}</td>
                  <td style={{ padding: "5px 4px", textAlign: "right" }}><Badge v={`${a.reklP}%`} color={a.reklP>55?C.red:a.reklP>40?C.amber:C.green}/></td>
                </tr>
              ))}</tbody>
            </table>
          </div>
        </div>
      </div>
      <Alert color={C.cyan} icon="💡">
        <strong style={{ color: C.green }}>Selin</strong> (18,0%) und <strong style={{ color: C.green }}>Jasmin</strong> (15,3%) beste Enpal-Conversion · <strong style={{ color: C.red }}>Mensure</strong> nur 4,7% – 4× schlechter.
        <strong style={{ color: C.red }}> Nadia</strong> bekommt 161 Leads (meiste!) aber 64% REKL.
      </Alert>
    </Sec>

    {/* ═══ 2. Pipeline-Alarm ═══ */}
    <Sec title="🚨 Pipeline: 476 nachfassbare Leads">
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap", marginBottom: 12 }}>
        <KPI small label="WVL" value={E.pipeline.wvl} sub={`Ø ${E.pipeline.wvlAvg}d alt`} color={C.blue}/>
        <KPI small label="Nicht erreicht" value={E.pipeline.ne} sub="noch versuchbar" color={C.orange}/>
        <KPI small label="5× NE (aufgeg.)" value={E.pipeline.ne5} sub="vermutlich verloren" color={C.red}/>
        <KPI small label="Total Pipeline" value={E.pipeline.wvl + E.pipeline.ne} sub="WVL + NE aktiv" color={C.cyan}/>
      </div>
      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 350px" }}>
          <div style={{ fontSize: 11, fontWeight: 700, color: C.blue, marginBottom: 6 }}>📋 WVL-Alter ({E.pipeline.wvl} Leads)</div>
          <ResponsiveContainer width="100%" height={120}>
            <BarChart data={[
              { n: "< 3 Tage", v: E.pipeline.wvlU3d, fill: C.green },
              { n: "3–7 Tage", v: E.pipeline.wvl3to7d, fill: C.amber },
              { n: "> 7 Tage", v: E.pipeline.wvlU7d, fill: C.red },
            ]}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis dataKey="n" tick={{ fill: C.sec, fontSize: 10 }}/>
              <YAxis tick={{ fill: C.sec, fontSize: 10 }}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="v" name="Leads" radius={[6,6,0,0]}>
                {[C.green, C.amber, C.red].map((c,i) => <Cell key={i} fill={c}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </div>
        <div style={{ flex: "1 1 350px" }}>
          <div style={{ fontSize: 11, fontWeight: 700, color: C.orange, marginBottom: 6 }}>📋 NE-Alter ({E.pipeline.neTotal} Leads)</div>
          <ResponsiveContainer width="100%" height={120}>
            <BarChart data={[
              { n: "< 3 Tage", v: E.pipeline.neU3d, fill: C.green },
              { n: "3–7 Tage", v: E.pipeline.ne3to7d, fill: C.amber },
              { n: "> 7 Tage", v: E.pipeline.neU7d, fill: C.red },
            ]}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis dataKey="n" tick={{ fill: C.sec, fontSize: 10 }}/>
              <YAxis tick={{ fill: C.sec, fontSize: 10 }}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="v" name="Leads" radius={[6,6,0,0]}>
                {[C.green, C.amber, C.red].map((c,i) => <Cell key={i} fill={c}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </div>
      </div>
      <Alert color={C.red} icon="⚠️">
        <strong style={{ color: C.red }}>{E.pipeline.wvlU7d} WVL {">"} 7d</strong> – drohen zu verfallen! <strong style={{ color: C.green }}>{E.pipeline.neU3d} NE {"<"} 3d</strong> noch frisch.
        Bei 15% Nachfass-Conversion = <strong style={{ color: C.green }}>~{Math.round((E.pipeline.wvl+E.pipeline.ne)*0.15)} zusätzliche Termine</strong> möglich.
      </Alert>
    </Sec>

    {/* ═══ 3. Lead→Termin Speed ═══ */}
    <Sec title="⏱️ Lead→Termin Speed (Enpal)">
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap", marginBottom: 12 }}>
        <KPI small label="Median" value={`${E.speed.median}h`} color={C.green}/>
        <KPI small label="Durchschnitt" value={`${E.speed.avg}h`} sub="Ausreißer ziehen hoch" color={C.amber}/>
        <KPI small label="<24h" value={`${E.speed.unter24hP}%`} sub={`${E.speed.unter24h} von ${E.speed.matches}`} color={C.green}/>
        <KPI small label=">72h" value={E.speed.ueber72h} sub="zu langsam" color={C.red}/>
      </div>
      <ResponsiveContainer width="100%" height={180}>
        <BarChart data={E.speed.buckets}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="n" tick={{ fill: C.sec, fontSize: 11 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
          <Tooltip content={<TT/>}/>
          <Bar dataKey="v" name="Leads" radius={[6,6,0,0]}>
            {E.speed.buckets.map((d,i) => <Cell key={i} fill={i<3?C.green:i<4?C.amber:C.red}/>)}
          </Bar>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>56% innerhalb 24h terminiert ✅ · Sweet Spot 12–24h (50%) · 9% brauchen >72h</div>
    </Sec>

    {/* ═══ 4. Benchmark Enpal vs. MVPP vs. Gesamt ═══ */}
    <Sec title="📊 Benchmark: Enpal vs. MVPP vs. Gesamt">
      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 350px" }}>
          <div style={{ fontSize: 11, fontWeight: 700, color: C.sec, marginBottom: 6 }}>Terminierungsrate %</div>
          <ResponsiveContainer width="100%" height={140}>
            <BarChart data={E.benchmark} layout="vertical" margin={{ left: 60 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" unit="%" domain={[0,60]} tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={50}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="termP" name="Term-Rate %" radius={[0,6,6,0]}>
                {E.benchmark.map((d,i) => <Cell key={i} fill={d.color}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </div>
        <div style={{ flex: "1 1 350px" }}>
          <div style={{ fontSize: 11, fontWeight: 700, color: C.sec, marginBottom: 6 }}>Reklamationsrate %</div>
          <ResponsiveContainer width="100%" height={140}>
            <BarChart data={E.benchmark} layout="vertical" margin={{ left: 60 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" unit="%" domain={[0,40]} tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 12 }} width={50}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="reklP" name="REKL-Rate %" radius={[0,6,6,0]}>
                {E.benchmark.map((d,i) => <Cell key={i} fill={d.reklP>25?C.red:d.reklP>15?C.amber:C.green}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </div>
      </div>
      <div style={{ overflowX: "auto", marginTop: 8 }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
          <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
            {["Quelle","Leads","Term","Term%","REKL","REKL%","Faktor vs Enpal"].map(h => (
              <th key={h} style={{ padding: "6px 5px", textAlign: h==="Quelle"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 10 }}>{h}</th>
            ))}
          </tr></thead>
          <tbody>{E.benchmark.map((b,i) => (
            <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: b.n==="Enpal"?`${C.orange}08`:"transparent" }}>
              <td style={{ padding: "6px 5px", fontWeight: 700, color: b.color }}>{b.n}</td>
              <td style={{ padding: "6px 5px", textAlign: "right" }}>{fmt(b.leads)}</td>
              <td style={{ padding: "6px 5px", textAlign: "right", color: C.green, fontWeight: 700 }}>{b.term}</td>
              <td style={{ padding: "6px 5px", textAlign: "right" }}><Badge v={`${b.termP}%`} color={b.termP>30?C.green:b.termP>15?C.amber:C.red}/></td>
              <td style={{ padding: "6px 5px", textAlign: "right", color: C.red }}>{b.rekl}</td>
              <td style={{ padding: "6px 5px", textAlign: "right" }}><Badge v={`${b.reklP}%`} color={b.reklP>25?C.red:b.reklP>15?C.amber:C.green}/></td>
              <td style={{ padding: "6px 5px", textAlign: "right", fontWeight: 700, color: b.n==="Enpal"?"–"===b.n?C.dim:C.sec:C.green }}>{b.n==="Enpal"?"–":`${(b.termP/8.8).toFixed(1)}×`}</td>
            </tr>
          ))}</tbody>
        </table>
      </div>
      <Alert color={C.purple} icon="📉">
        MVPP terminiert <strong style={{ color: C.green }}>6,0× besser</strong> als Enpal bei <strong style={{ color: C.green }}>23× weniger REKL</strong>.
        Enpal liegt <strong style={{ color: C.red }}>50% unter</strong> dem Gesamtschnitt.
      </Alert>
    </Sec>

    {/* ═══ 5. Wochentag-Analyse ═══ */}
    <Sec title="📅 Enpal-Termine nach Wochentag">
      <ResponsiveContainer width="100%" height={200}>
        <BarChart data={E.wochentag}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis dataKey="d" tick={{ fill: C.sec, fontSize: 12 }}/>
          <YAxis tick={{ fill: C.sec, fontSize: 11 }}/>
          <Tooltip content={<TT/>}/>
          <Legend wrapperStyle={{ fontSize: 10 }}/>
          <Bar dataKey="abg" stackId="a" fill={C.green} name="Stattgefunden"/>
          <Bar dataKey="af" stackId="a" fill={C.red} name="Ausgefallen"/>
          <Bar dataKey="offen" stackId="a" fill={C.blue} name="Offen" radius={[4,4,0,0]}/>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>
        <strong style={{ color: C.green }}>Do = meiste Stattgefundene</strong> (4 von 10) · <strong style={{ color: C.red }}>Di = meiste Ausfälle</strong> (6 von 14!) · Fr 21 Terme noch komplett offen
      </div>
    </Sec>

    {/* ═══ 6. PLZ-Conversion ═══ */}
    <Sec title="📍 PLZ-Gebiete: Conversion-Unterschiede">
      <ResponsiveContainer width="100%" height={Math.max(E.plz.length * 24, 250)}>
        <BarChart data={E.plz} layout="vertical" margin={{ left: 60 }}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
          <XAxis type="number" unit="%" domain={[0, 16]} tick={{ fill: C.sec, fontSize: 11 }}/>
          <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 10 }} width={50}/>
          <Tooltip formatter={v=>`${v.toFixed(1)}%`} contentStyle={{ background: "#1B2332", border: `1px solid ${C.border}`, borderRadius: 10 }}/>
          <Bar dataKey="rate" name="Term-Rate %" radius={[0,6,6,0]}>
            {E.plz.map((d,i) => <Cell key={i} fill={d.rate>12?C.green:d.rate>8?C.amber:C.red}/>)}
          </Bar>
        </BarChart>
      </ResponsiveContainer>
      <div style={{ overflowX: "auto", marginTop: 8 }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11 }}>
          <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
            {["PLZ","Leads","Term","Rate"].map(h => (
              <th key={h} style={{ padding: "5px 4px", textAlign: h==="PLZ"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 9 }}>{h}</th>
            ))}
          </tr></thead>
          <tbody>{E.plz.map((p,i) => (
            <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
              <td style={{ padding: "4px", fontWeight: 600 }}>{p.n}</td>
              <td style={{ padding: "4px", textAlign: "right" }}>{p.leads}</td>
              <td style={{ padding: "4px", textAlign: "right", color: C.green, fontWeight: 700 }}>{p.term}</td>
              <td style={{ padding: "4px", textAlign: "right" }}><Badge v={`${p.rate.toFixed(1)}%`} color={p.rate>12?C.green:p.rate>8?C.amber:C.red}/></td>
            </tr>
          ))}</tbody>
        </table>
      </div>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>
        <strong style={{ color: C.green }}>41/44/51/40xxx</strong> = Top-Gebiete (12–14%) · <strong style={{ color: C.red }}>49xxx</strong> nur 1,5% bei 65 Leads!
        · 26xxx meiste Leads (136) aber nur 5,9%
      </div>
    </Sec>

    {/* ═══ 7. AF-Gründe ═══ */}
    <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
      <div style={{ flex: "1 1 400px" }}>
        <Sec title="❌ Ausfall-Gründe (14 Ausgefallen)">
          <ResponsiveContainer width="100%" height={160}>
            <BarChart data={E.afGruende} layout="vertical" margin={{ left: 120 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 10 }} width={110}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="v" name="Anzahl" radius={[0,6,6,0]}>
                {E.afGruende.map((d,i) => <Cell key={i} fill={[C.red, C.orange, C.amber, C.purple, C.dim][i]}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
          <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>36% Kein Interesse (Vorqualifizierung?) · 21% techn. ungeeignet (Dach/Verbrauch)</div>
        </Sec>
      </div>
      <div style={{ flex: "1 1 400px" }}>
        <Sec title="📋 Termin-Ergebnisse (10 Stattgef.)">
          <ResponsiveContainer width="100%" height={160}>
            <BarChart data={E.abschluss} layout="vertical" margin={{ left: 120 }}>
              <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
              <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }}/>
              <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 10 }} width={110}/>
              <Tooltip content={<TT/>}/>
              <Bar dataKey="v" name="Anzahl" radius={[0,6,6,0]}>
                {E.abschluss.map((d,i) => <Cell key={i} fill={d.n==="Sale"?C.green:d.n.startsWith("WVL")?C.amber:C.red}/>)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
          <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>1 Abschluss (P. Kalinowski, {eur(E.salesNetto)}) · 6 WVL (nachfassbar!) · 3 verloren</div>
        </Sec>
      </div>
    </div>

    {/* ═══ 8. WP vs. Klassisch + Jan vs. Feb ═══ */}
    <Sec title="⚡ WP vs. Klassisch Vergleich">
      <div style={{ overflowX: "auto" }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
          <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
            {["","Leads","Term","Term%","REKL","REKL%","NE5","Terme","Stattgef.","Ausgef.","Sales"].map(h => (
              <th key={h} style={{ padding: "7px 6px", textAlign: h===""?"left":"right", color: C.sec, fontWeight: 600, fontSize: 10 }}>{h}</th>
            ))}
          </tr></thead>
          <tbody>
            <tr style={{ borderBottom: `1px solid ${C.border}` }}>
              <td style={{ padding: "7px 6px", fontWeight: 700, color: C.orange }}>⚡ WP</td>
              <td style={{ padding: "7px 6px", textAlign: "right", fontWeight: 700 }}>{fmt(E.feb.wp)}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green }}>{70}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${(70/E.feb.wp*100).toFixed(1)}%`} color={C.red}/></td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red }}>{290}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${Math.round(290/E.feb.wp*100)}%`} color={C.red}/></td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.orange }}>{182}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.cyan }}>{E.termeWP}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green }}>{10}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red }}>{13}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green, fontWeight: 700 }}>{1}</td>
            </tr>
            <tr style={{ borderBottom: `1px solid ${C.border}` }}>
              <td style={{ padding: "7px 6px", fontWeight: 700, color: C.amber }}>☀️ Klassisch</td>
              <td style={{ padding: "7px 6px", textAlign: "right", fontWeight: 700 }}>{E.feb.kl}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green }}>{6}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${(6/E.feb.kl*100).toFixed(1)}%`} color={C.amber}/></td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red }}>{27}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${Math.round(27/E.feb.kl*100)}%`} color={C.red}/></td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.orange }}>{7}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.cyan }}>{E.termeKl}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.dim }}>{0}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red }}>{1}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.dim }}>0</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>WP = 94% aller Leads · Klassisch höhere Term-Rate (10,3% vs 7,7%) aber kaum Volumen</div>
    </Sec>

    <Sec title="📈 Enpal: Jan vs. Feb">
      <div style={{ overflowX: "auto" }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
          <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
            {["","Leads","WP","Klass.","Term.+Angebot","Term%","REKL","REKL%"].map(h => (
              <th key={h} style={{ padding: "7px 6px", textAlign: h===""?"left":"right", color: C.sec, fontWeight: 600, fontSize: 10 }}>{h}</th>
            ))}
          </tr></thead>
          <tbody>
            <tr style={{ borderBottom: `1px solid ${C.border}` }}>
              <td style={{ padding: "7px 6px", fontWeight: 700, color: C.blue }}>Januar</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}>{E.jan.leads}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}>{E.jan.wp}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}>{E.jan.kl}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green }}>{E.jan.term+E.jan.ang}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${((E.jan.term+E.jan.ang)/E.jan.leads*100).toFixed(1)}%`} color={C.red}/></td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red }}>{E.jan.rekl}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${Math.round(E.jan.rekl/E.jan.leads*100)}%`} color={C.red}/></td>
            </tr>
            <tr style={{ borderBottom: `1px solid ${C.border}` }}>
              <td style={{ padding: "7px 6px", fontWeight: 700, color: C.orange }}>Februar</td>
              <td style={{ padding: "7px 6px", textAlign: "right", fontWeight: 700 }}>{fmt(febLeads)}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}>{fmt(E.feb.wp)}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}>{E.feb.kl}</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green, fontWeight: 700 }}>{E.feb.term+E.feb.ang}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${termRate.toFixed(1)}%`} color={C.amber}/></td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red }}>{E.feb.rekl}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`${Math.round(E.feb.rekl/febLeads*100)}%`} color={C.red}/></td>
            </tr>
            <tr style={{ borderTop: `2px solid ${C.orange}`, background: `${C.orange}08` }}>
              <td style={{ padding: "7px 6px", fontWeight: 700, color: C.orange }}>Δ</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.red, fontWeight: 700 }}>+{fmt(febLeads-E.jan.leads)}</td>
              <td colSpan={2} style={{ padding: "7px 6px", textAlign: "right", fontSize: 10, color: C.sec }}>WP ×{Math.round(E.feb.wp/Math.max(E.jan.wp,1))}!</td>
              <td style={{ padding: "7px 6px", textAlign: "right", color: C.green }}>+{(E.feb.term+E.feb.ang)-(E.jan.term+E.jan.ang)}</td>
              <td style={{ padding: "7px 6px", textAlign: "right" }}><Badge v={`+${(termRate-(E.jan.term+E.jan.ang)/E.jan.leads*100).toFixed(1)}pp`} color={C.green}/></td>
              <td colSpan={2}/>
            </tr>
          </tbody>
        </table>
      </div>
      <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>Feb ×{(febLeads/E.jan.leads).toFixed(1)} Leads vs. Jan · WP-Volumen explodiert (75→{fmt(E.feb.wp)}) · Term-Rate verbessert</div>
    </Sec>

    <Alert color={C.orange} icon="⚠️">
      <strong>Enpal Feb:</strong> {fmt(febLeads)} Leads → {E.terme} Terme → {E.termeAbg} stattgef. → <strong style={{ color: C.green }}>{E.sales} Sale ({eur(E.salesNetto)})</strong>.
      <strong style={{ color: C.red }}> {Math.round(E.feb.rekl/febLeads*100)}% REKL</strong> · MVPP terminiert <strong>6× besser</strong>.
      {" "}<strong style={{ color: C.blue }}>{E.termeOffen} Terme offen</strong> + <strong style={{ color: C.amber }}>{E.pipeline.wvl+E.pipeline.ne} Pipeline</strong> nachfassbar.
    </Alert>
  </div>
  );
};

// ═══ TAB: SCOUTER ═══
// ═══ TAB: ANGESTELLTE ═══
const TabAngestellte = () => {
  const [period, setPeriod] = useState("feb");
  const periodLabel = period === "jan" ? "Januar" : period === "feb" ? "Februar" : "Jan + Feb";
  const d = ANG_DATA[period] || ANG_DATA.feb;
  const sc = d.scouter;
  const vb = d.vb;
  const scTotals = sc.reduce((a,s) => ({ leads: a.leads+s.leads, genSales: a.genSales+s.genSales, kosten: a.kosten+s.kosten }), { leads: 0, genSales: 0, kosten: 0 });
  const vbTotals = vb.reduce((a,s) => ({ leads: a.leads+s.leads, sales: a.sales+s.sales, vbK: a.vbK+(s.vbK||s.kosten), scK: a.scK+(s.scK||0), kosten: a.kosten+s.kosten }), { leads: 0, sales: 0, vbK: 0, scK: 0, kosten: 0 });
  const totalK = scTotals.kosten + vbTotals.kosten;
  const totalSales = vbTotals.sales; // Only VBs close sales
  const scWithSales = sc.filter(s => s.genSales > 0).sort((a,b) => a.kpg - b.kpg);
  const scNoSales = sc.filter(s => s.genSales === 0);
  const vbSorted = [...vb].sort((a,b) => {
    const ak = a.sales > 0 ? a.kosten/a.sales : 999999;
    const bk = b.sales > 0 ? b.kosten/b.sales : 999999;
    return ak - bk;
  });
  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
      {/* HEADER */}
      <div style={{ background: `linear-gradient(135deg, ${C.blue}12, ${C.purple}08)`, borderRadius: 14, padding: "18px 24px", border: `1px solid ${C.blue}25` }}>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: 10 }}>
          <div>
            <span style={{ fontSize: 20, fontWeight: 800, color: C.text }}>🏢 Angestellte – Wahre Kosten/Sale</span>
            <div style={{ fontSize: 12, color: C.sec }}>9 Scouter (Lead-Generierung) + 6 Vertriebler (Abschluss) · Scouter-Kosten umgewälzt auf generierte Sales</div>
          </div>
          <div style={{ display: "flex", gap: 6 }}>
            {[["jan", "Jan"], ["feb", "Feb"], ["total", "Total"]].map(([k, l]) => (
              <button key={k} onClick={() => setPeriod(k)} style={{ padding: "6px 16px", borderRadius: 8, border: `1px solid ${period === k ? C.amber : C.border}`, background: period === k ? `${C.amber}20` : "transparent", color: period === k ? C.amber : C.sec, fontWeight: period === k ? 700 : 400, cursor: "pointer", fontSize: 13 }}>{l}</button>
            ))}
          </div>
        </div>
      </div>

      {/* KPIs */}
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
        <KPI label="Angestellte" value={15} sub={`9 Scouter · 6 VB`} color={C.blue}/>
        <KPI label="Scouter-Kosten" value={eur(scTotals.kosten)} sub={`${scTotals.genSales} gen. Sales · Ø ${eur(scTotals.genSales > 0 ? Math.round(scTotals.kosten/scTotals.genSales) : 0)}/gen. Sale`} color={C.green}/>
        <KPI label="VB-Kosten" value={eur(vbTotals.vbK)} sub={`${vbTotals.sales} Sales`} color={C.blue}/>
        <KPI label="+ Scout-Umwälzung" value={eur(vbTotals.scK)} sub={`Ant. Scouter-K auf VB-Sales`} color={C.orange}/>
        <KPI label="Gesamt Angest." value={eur(totalK)} sub={`Ø ${eur(totalSales > 0 ? Math.round(totalK/totalSales) : 0)}/Sale (wahre K)`} color={C.red}/>
      </div>

      {/* SCOUTER SEKTION */}
      <div style={{ background: `linear-gradient(135deg, ${C.green}12, ${C.cyan}08)`, borderRadius: 12, padding: "12px 20px", border: `1px solid ${C.green}25` }}>
        <span style={{ fontSize: 16, fontWeight: 800, color: C.text }}>🏃 Scouter – Lead-Generierung ({periodLabel})</span>
        <div style={{ fontSize: 11, color: C.sec }}>(3.000€ + Bonus) × 1,21 AG × 1,12 Urlaub + Auto (indiv.) · Scouter closen nicht selbst, sie generieren Leads → VB schließt ab</div>
      </div>

      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 500px" }}>
          <Sec title={`💰 Scouter K / generierter Sale – ${periodLabel}`}>
            {scWithSales.length > 0 ? (
              <ResponsiveContainer width="100%" height={Math.max(scWithSales.length * 38, 150)}>
                <BarChart data={scWithSales} layout="vertical" margin={{ left: 140 }}>
                  <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                  <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }} tickFormatter={v => eur(v)}/>
                  <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={130}/>
                  <Tooltip content={<TT/>}/>
                  <Bar dataKey="kpg" name="K/gen.Sale" radius={[0,6,6,0]}>
                    {scWithSales.map((s, i) => <Cell key={i} fill={s.kpg <= 2000 ? C.green : s.kpg <= 3500 ? C.amber : C.red}/>)}
                  </Bar>
                </BarChart>
              </ResponsiveContainer>
            ) : <div style={{ color: C.dim, padding: 20 }}>Keine gen. Sales</div>}
            {scNoSales.length > 0 && <div style={{ fontSize: 11, color: C.red, marginTop: 6 }}>⚠️ Ohne gen. Sales: {scNoSales.map(s => s.n).join(", ")} ({eur(scNoSales.reduce((a,s) => a+s.kosten, 0))} Kosten ohne Return)</div>}
          </Sec>
        </div>
        <div style={{ flex: "1 1 340px" }}>
          <Sec title="📋 Scouter-Tabelle">
            <div style={{ overflowX: "auto" }}>
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
                <thead><tr style={{ background: C.card }}>
                  {["Scouter", "Leads", "SF", "Gen.S", "Auto", "Kosten", "K/Gen.S"].map(h => (
                    <th key={h} style={{ padding: "6px 5px", textAlign: h === "Scouter" ? "left" : "right", color: C.sec, fontSize: 10, borderBottom: `1px solid ${C.border}` }}>{h}</th>
                  ))}
                </tr></thead>
                <tbody>
                  {sc.sort((a,b) => b.genSales - a.genSales).map((s, i) => (
                    <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: i % 2 === 0 ? "transparent" : `${C.card}60` }}>
                      <td style={{ padding: "5px", fontWeight: 600, color: C.text, fontSize: 11 }}>{s.n}</td>
                      <td style={{ padding: "5px", textAlign: "right", color: C.blue }}>{fmt(s.leads)}</td>
                      <td style={{ padding: "5px", textAlign: "right", color: (s.sf||0) > 0 ? C.purple : C.dim, fontWeight: 600 }}>{(s.sf||0) > 0 ? s.sf : "–"}</td>
                      <td style={{ padding: "5px", textAlign: "right", fontWeight: 700, color: s.genSales > 0 ? C.green : C.dim }}>{s.genSales}</td>
                      <td style={{ padding: "5px", textAlign: "right", color: (s.auto||0) > 0 ? C.sec : C.dim, fontSize: 10 }}>{(s.auto||0) > 0 ? eur(s.auto) : "–"}</td>
                      <td style={{ padding: "5px", textAlign: "right", color: C.red }}>{eur(s.kosten)}</td>
                      <td style={{ padding: "5px", textAlign: "right" }}>
                        {s.genSales > 0 ? <span style={{ padding: "1px 5px", borderRadius: 6, fontSize: 10, fontWeight: 700, background: s.kpg <= 2000 ? `${C.green}20` : s.kpg <= 3500 ? `${C.amber}20` : `${C.red}20`, color: s.kpg <= 2000 ? C.green : s.kpg <= 3500 ? C.amber : C.red }}>{eur(s.kpg)}</span> : <span style={{ color: C.dim }}>–</span>}
                      </td>
                    </tr>
                  ))}
                  <tr style={{ borderTop: `2px solid ${C.green}`, background: `${C.green}08` }}>
                    <td style={{ padding: "6px 5px", fontWeight: 800, color: C.green, fontSize: 11 }}>GESAMT</td>
                    <td style={{ padding: "6px 5px", textAlign: "right", fontWeight: 700, color: C.blue }}>{fmt(scTotals.leads)}</td>
                    <td style={{ padding: "6px 5px", textAlign: "right", fontWeight: 700, color: C.purple }}>{sc.reduce((a,s) => a+(s.sf||0), 0) || "–"}</td>
                    <td style={{ padding: "6px 5px", textAlign: "right", fontWeight: 800, color: C.green }}>{scTotals.genSales}</td>
                    <td style={{ padding: "6px 5px", textAlign: "right", fontSize: 10, color: C.sec }}>{eur(sc.reduce((a,s) => a+(s.auto||0), 0))}</td>
                    <td style={{ padding: "6px 5px", textAlign: "right", fontWeight: 700, color: C.red }}>{eur(scTotals.kosten)}</td>
                    <td style={{ padding: "6px 5px", textAlign: "right" }}><span style={{ padding: "1px 5px", borderRadius: 6, fontSize: 10, fontWeight: 700, background: `${C.amber}20`, color: C.amber }}>{eur(scTotals.genSales > 0 ? Math.round(scTotals.kosten/scTotals.genSales) : 0)}</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </Sec>
        </div>
      </div>

      {/* VB SEKTION */}
      <div style={{ background: `linear-gradient(135deg, ${C.blue}12, ${C.purple}08)`, borderRadius: 12, padding: "12px 20px", border: `1px solid ${C.blue}25` }}>
        <span style={{ fontSize: 16, fontWeight: 800, color: C.text }}>🤝 Vertriebler – Wahre Kosten ({periodLabel})</span>
        <div style={{ fontSize: 11, color: C.sec }}>VB-Kosten + anteilige Scouter-Kosten (wenn Lead via ang. Scouter) · 0-7 Sales: 500€, 8+: 700€ rückw. · EL 400€, Empf 300€, Speicher 150€</div>
      </div>

      <Sec title={`📋 VB Lead-Quellen & Kostenumwälzung – ${periodLabel}`}>
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ background: C.card }}>
              {["Vertriebler", "Sales", "Scout", "Omega", "EL", "Sonst", "VB-K", "+ Scout", "= Wahre K", "K/Sale"].map(h => (
                <th key={h} style={{ padding: "7px 5px", textAlign: h === "Vertriebler" ? "left" : "right", color: C.sec, fontSize: 11, borderBottom: `1px solid ${C.border}`, background: (h === "Scout" || h === "+ Scout") ? `${C.orange}10` : "transparent" }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>
              {vbSorted.map((s, i) => {
                const kps = s.sales > 0 ? Math.round(s.kosten / s.sales) : 0;
                return (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: i % 2 === 0 ? "transparent" : `${C.card}60` }}>
                  <td style={{ padding: "7px 5px", fontWeight: 600, color: C.text }}>{s.n}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", fontWeight: 700, color: s.sales > 0 ? C.green : C.dim }}>{s.sales}{s.sales >= 8 ? " 🔥" : ""}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", fontWeight: 600, background: `${C.orange}10`, color: (s.mvppAng||0) > 0 ? C.orange : C.dim }}>{s.mvppAng || 0}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: (s.omega||0) > 0 ? C.cyan : C.dim }}>{s.omega || 0}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: (s.el||0) > 0 ? C.green : C.dim }}>{s.el || 0}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: C.dim }}>{(s.emp||0)+(s.sadd||0)+(s.other||0)}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: C.red }}>{eur(s.vbK||s.kosten)}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", fontWeight: 600, background: `${C.orange}10`, color: (s.scK||0) > 0 ? C.orange : C.dim }}>{(s.scK||0) > 0 ? "+"+eur(s.scK) : "–"}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", fontWeight: 700, color: C.red }}>{eur(s.kosten)}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right" }}>
                    {s.sales > 0 ? <span style={{ padding: "2px 7px", borderRadius: 8, fontSize: 11, fontWeight: 700, background: kps <= 3500 ? `${C.green}20` : kps <= 6000 ? `${C.amber}20` : `${C.red}20`, color: kps <= 3500 ? C.green : kps <= 6000 ? C.amber : C.red }}>{eur(kps)}</span> : <span style={{ color: C.dim }}>–</span>}
                  </td>
                </tr>);
              })}
              <tr style={{ borderTop: `2px solid ${C.blue}`, background: `${C.blue}08` }}>
                <td style={{ padding: "8px 5px", fontWeight: 800, color: C.blue }}>VB GESAMT</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 800, color: C.green }}>{vbTotals.sales}</td>
                <td colSpan={4}/>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.red }}>{eur(vbTotals.vbK)}</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.orange, background: `${C.orange}10` }}>+{eur(vbTotals.scK)}</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.red }}>{eur(vbTotals.kosten)}</td>
                <td style={{ padding: "8px 5px", textAlign: "right" }}><span style={{ padding: "2px 7px", borderRadius: 8, fontSize: 11, fontWeight: 700, background: `${C.amber}20`, color: C.amber }}>{eur(Math.round(vbTotals.kosten/Math.max(vbTotals.sales,1)))}</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div style={{ fontSize: 11, color: C.dim, marginTop: 4 }}>Scout = Leads via ang. Scouter (anteilige Monatskosten umgewälzt) · Omega/EL/Sonst = keine Umwälzung</div>
      </Sec>

      <Sec title="📊 Scouter Lead-Qualität (LMT)">
        <div style={{ fontSize: 10, color: C.sec, marginBottom: 8 }}>Wie gut sind die Scouter-Leads? Terminierungsrate und Waste aus LMT-Export</div>
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Scouter","LMT-Leads","Term.+Angebot","Term%","NE5","REKL","Pipeline"].map(h => (
                <th key={h} style={{ padding: "6px 5px", textAlign: h==="Scouter"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 9 }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{(() => {
              const lmtSc = (period==="jan"?LMT.jan:period==="total"?LMT.total:LMT.feb).scouter;
              return lmtSc.filter(s=>s.t>0).sort((a,b)=>{const ra=a.t>0?(a.term+a.ang)/a.t:0; const rb=b.t>0?(b.term+b.ang)/b.t:0; return rb-ra;}).map((s,i) => {
                const r = s.t>0?(s.term+s.ang)/s.t*100:0;
                const pipe = (s.wvl||0)+(s.ne||0);
                return (
                  <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: i%2===0?"transparent":`${C.card}60` }}>
                    <td style={{ padding: "5px", fontWeight: 600, fontSize: 11 }}>{s.n}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: C.blue }}>{s.t}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: C.green, fontWeight: 700 }}>{s.term+(s.ang||0)}</td>
                    <td style={{ padding: "5px", textAlign: "right" }}><Badge v={`${r.toFixed(0)}%`} color={r>60?C.green:r>30?C.amber:C.red}/></td>
                    <td style={{ padding: "5px", textAlign: "right", color: s.ne5>0?C.orange:C.dim }}>{s.ne5||"–"}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: (s.rekl||0)>0?C.red:C.dim }}>{s.rekl||"–"}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: pipe>0?C.cyan:C.dim }}>{pipe||"–"}</td>
                  </tr>
                );
              });
            })()}</tbody>
          </table>
        </div>
        <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>Pipeline = WVL + nicht erreicht (noch bearbeitbar) · MVPP-Leads haben 0% PLZ-Ausfall vs. SADD 48%</div>
      </Sec>

      {/* GESAMTBILD */}
      <Alert color={C.amber} icon="📊">
        <strong>{periodLabel}:</strong> 15 Angestellte · {eur(totalK)} Gesamtkosten · {vbTotals.sales} VB-Sales · Ø <strong style={{ color: totalSales > 0 && Math.round(totalK/totalSales) <= 6000 ? C.amber : C.red }}>{eur(totalSales > 0 ? Math.round(totalK/totalSales) : 0)}/Sale</strong> (wahre Kosten inkl. Scouter)
        {scNoSales.length > 0 && <> · <span style={{ color: C.red }}>⚠️ {scNoSales.map(s=>s.n).join(", ")} ohne gen. Sales = {eur(scNoSales.reduce((a,s)=>a+s.kosten,0))} versenkt</span></>}
      </Alert>
    </div>
  );
};

const TabScouter = () => {
  const [sort, setSort] = useState({ k: "kosten", d: -1 });
  const [period, setPeriod] = useState("feb");
  const sData = SCOUTER_MONTHLY[period] || SCOUTER_MONTHLY.feb;
  const sTotals = sumData(sData);
  const vbData = VB_MONTHLY[period] || VB_MONTHLY.feb;
  const vbTotals = sumVB(vbData);
  const periodLabel = period === "jan" ? "Januar" : period === "feb" ? "Februar" : "Jan + Feb";

  // Angestellte combined
  const scouterAng = sData.filter(s => s.typ === "A");
  const scouterHgb = sData.filter(s => s.typ === "HGB");
  const vbAng = vbData.filter(s => s.typ === "A");
  const vbHgb = vbData.filter(s => s.typ === "HGB");
  const allAng = [
    ...scouterAng.map(s => ({ ...s, rolle: "Scouter" })),
    ...vbAng.map(s => ({ ...s, rolle: "Vertriebler" })),
  ];
  const allAngSorted = [...allAng].sort((a, b) => {
    const ak = a.sales > 0 ? a.kosten / a.sales : 999999;
    const bk = b.sales > 0 ? b.kosten / b.sales : 999999;
    return ak - bk;
  });
  const angTotals = allAng.reduce((a, s) => ({ sales: a.sales+s.sales, kosten: a.kosten+s.kosten, auto: a.auto+(s.auto||0) }), { sales: 0, kosten: 0, auto: 0 });

  // Scouter sorted
  const sorted = [...sData].sort((a, b) => (a[sort.k] > b[sort.k] ? sort.d : a[sort.k] < b[sort.k] ? -sort.d : 0));
  const th = (label, key, w) => (
    <th onClick={() => setSort({ k: key, d: sort.k === key ? -sort.d : -1 })} style={{ padding: "8px 5px", textAlign: key === "n" ? "left" : "right", cursor: "pointer", color: sort.k === key ? C.amber : C.sec, fontSize: 11, width: w, borderBottom: `1px solid ${C.border}`, whiteSpace: "nowrap" }}>
      {label} {sort.k === key ? (sort.d > 0 ? "▲" : "▼") : ""}
    </th>
  );
  const kpsData = sData.filter(s => s.sales > 0).map(s => ({ ...s, kps: Math.round(s.kosten / s.sales) })).sort((a, b) => a.kps - b.kps);
  const noSales = sData.filter(s => s.sales === 0);
  const noSalesCost = noSales.reduce((a, s) => a + s.kosten, 0);
  const vbHgbWithSales = vbHgb.filter(s => s.sales > 0).sort((a, b) => b.sales - a.sales);
  const vbHgbTotals = sumVB(vbHgb);

  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
      {/* HEADER + PERIOD TOGGLE */}
      <div style={{ background: `linear-gradient(135deg, ${C.green}12, ${C.cyan}08)`, borderRadius: 14, padding: "18px 24px", border: `1px solid ${C.green}25` }}>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: 10 }}>
          <div>
            <span style={{ fontSize: 20, fontWeight: 800, color: C.text }}>🏃 Scouter & HGB Vertrieb</span>
            <div style={{ fontSize: 12, color: C.sec }}>Scouter (Ang. + HGB) · HGB Vertriebler · Kosten pro Sale</div>
          </div>
          <div style={{ display: "flex", gap: 6 }}>
            {[["jan", "Jan"], ["feb", "Feb"], ["total", "Total"]].map(([k, l]) => (
              <button key={k} onClick={() => setPeriod(k)} style={{ padding: "6px 16px", borderRadius: 8, border: `1px solid ${period === k ? C.amber : C.border}`, background: period === k ? `${C.amber}20` : "transparent", color: period === k ? C.amber : C.sec, fontWeight: period === k ? 700 : 400, cursor: "pointer", fontSize: 13 }}>{l}</button>
            ))}
          </div>
        </div>
      </div>

      {/* ══ SCOUTER DETAILS ══ */}
      <div style={{ background: `linear-gradient(135deg, ${C.green}12, ${C.cyan}08)`, borderRadius: 14, padding: "14px 24px", border: `1px solid ${C.green}25` }}>
        <span style={{ fontSize: 16, fontWeight: 800, color: C.text }}>🏃 Scouter Details</span>
        <div style={{ fontSize: 12, color: C.sec }}>Angestellte: (3.000€ + Bonus) × 1,21 AG × 1,12 Urlaub + Auto (indiv.) · HGB: 100€/SF + 200€/Sale</div>
      </div>

      <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
        <KPI label="Scouter" value={sData.length} sub={`${scouterAng.length} A · ${scouterHgb.length} HGB`} color={C.green}/>
        <KPI label="Leads" value={fmt(sTotals.leads)} sub={periodLabel} color={C.blue}/>
        <KPI label="Sales" value={sTotals.sales} sub={periodLabel} color={C.green}/>
        <KPI label="Kosten" value={eur(sTotals.kosten)} sub={`${eur(sumData(scouterAng).kosten)} A · ${eur(sumData(scouterHgb).kosten)} HGB`} color={C.red}/>
        <KPI label="Ø K/Sale" value={eur(Math.round(sTotals.kosten/Math.max(sTotals.sales,1)))} color={C.amber}/>
      </div>

      <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
        <div style={{ flex: "1 1 500px" }}>
          <Sec title={`💰 Kosten pro Sale – ${periodLabel}`}>
            {kpsData.length > 0 ? (
              <ResponsiveContainer width="100%" height={Math.max(kpsData.length * 38, 150)}>
                <BarChart data={kpsData} layout="vertical" margin={{ left: 140 }}>
                  <CartesianGrid strokeDasharray="3 3" stroke={C.border}/>
                  <XAxis type="number" tick={{ fill: C.sec, fontSize: 11 }} tickFormatter={v => eur(v)}/>
                  <YAxis type="category" dataKey="n" tick={{ fill: C.sec, fontSize: 11 }} width={130}/>
                  <Tooltip content={<TT/>}/>
                  <Bar dataKey="kps" name="K/Sale" radius={[0,6,6,0]}>
                    {kpsData.map((s, i) => <Cell key={i} fill={s.kps <= 2500 ? C.green : s.kps <= 4000 ? C.amber : C.red}/>)}
                  </Bar>
                </BarChart>
              </ResponsiveContainer>
            ) : <div style={{ color: C.dim, padding: 20 }}>Keine Sales in diesem Zeitraum</div>}
            {noSales.length > 0 && <div style={{ fontSize: 11, color: C.dim, marginTop: 6 }}>{noSales.length} Scouter ohne Sales{noSalesCost > 0 ? ` (${eur(noSalesCost)} Kosten ohne Return)` : " (HGB = 0€ Kosten)"}</div>}
          </Sec>
        </div>
        <div style={{ flex: "1 1 340px" }}>
          <Sec title="📦 Scouter Kosten-Breakdown">
            <ResponsiveContainer width="100%" height={220}>
              <PieChart>
                <Pie data={(() => {
                  const angK = scouterAng.reduce((a,s) => a+s.kosten, 0);
                  return [
                    { name: `Angest. Personal (${scouterAng.length}×)`, v: angK - sTotals.auto, fill: C.blue },
                    { name: `Auto (${scouterAng.length}×)`, v: sTotals.auto, fill: C.purple },
                    { name: `HGB Prov. (${scouterHgb.length}×)`, v: scouterHgb.reduce((a,s) => a+s.kosten, 0), fill: C.cyan },
                  ];
                })()} cx="50%" cy="50%" outerRadius={80} innerRadius={40} dataKey="v" paddingAngle={2} stroke="none"/>
                <Tooltip content={<TT/>}/>
                <Legend wrapperStyle={{ fontSize: 10 }}/>
              </PieChart>
            </ResponsiveContainer>
          </Sec>
        </div>
      </div>

      <Sec title={`📋 Scouter-Tabelle – ${periodLabel}`}>
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ background: C.card }}>
              {th("Scouter", "n", 150)}
              {th("Typ", "typ")}
              {th("Leads", "leads")}
              {th("Sales", "sales")}
              {th("Auto", "auto")}
              {th("Kosten", "kosten")}
              {th("K/Sale", "kosten")}
            </tr></thead>
            <tbody>
              {sorted.map((s, i) => (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: i % 2 === 0 ? "transparent" : `${C.card}60` }}>
                  <td style={{ padding: "7px 5px", fontWeight: 600, color: C.text }}>{s.n}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right" }}>
                    <span style={{ fontSize: 9, padding: "1px 5px", borderRadius: 6, background: s.typ === "HGB" ? `${C.cyan}20` : `${C.blue}20`, color: s.typ === "HGB" ? C.cyan : C.blue, fontWeight: 700 }}>{s.typ}</span>
                  </td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: C.amber }}>{s.leads}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", fontWeight: 700, color: s.sales > 0 ? C.green : C.dim }}>{s.sales}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: C.purple }}>{s.auto > 0 ? eur(s.auto) : "–"}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: C.red, fontWeight: 600 }}>{s.kosten > 0 ? eur(s.kosten) : "0€"}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right" }}>
                    {s.sales > 0 ? <span style={{ padding: "2px 7px", borderRadius: 8, fontSize: 11, fontWeight: 700, background: Math.round(s.kosten/s.sales) <= 2500 ? `${C.green}20` : Math.round(s.kosten/s.sales) <= 4000 ? `${C.amber}20` : `${C.red}20`, color: Math.round(s.kosten/s.sales) <= 2500 ? C.green : Math.round(s.kosten/s.sales) <= 4000 ? C.amber : C.red }}>{eur(Math.round(s.kosten/s.sales))}</span> : <span style={{ color: C.dim }}>–</span>}
                  </td>
                </tr>
              ))}
              <tr style={{ borderTop: `2px solid ${C.amber}`, background: `${C.amber}08` }}>
                <td style={{ padding: "8px 5px", fontWeight: 800, color: C.amber }}>GESAMT</td>
                <td style={{ padding: "8px 5px" }}/>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.amber }}>{fmt(sTotals.leads)}</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 800, color: C.green }}>{sTotals.sales}</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.purple }}>{eur(sTotals.auto)}</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.red }}>{eur(sTotals.kosten)}</td>
                <td style={{ padding: "8px 5px", textAlign: "right" }}><span style={{ padding: "2px 7px", borderRadius: 8, fontSize: 11, fontWeight: 700, background: `${C.amber}20`, color: C.amber }}>{eur(Math.round(sTotals.kosten/Math.max(sTotals.sales,1)))}</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </Sec>

      <Sec title={`📊 Scouter Lead-Qualität (LMT) – ${periodLabel}`}>
        <div style={{ fontSize: 10, color: C.sec, marginBottom: 8 }}>Wie terminierbar sind die MVPP-Leads pro Scouter? LMT-Export: Leadstatus-Verteilung</div>
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11 }}>
            <thead><tr style={{ borderBottom: `2px solid ${C.border}` }}>
              {["Scouter","LMT","Term.","Angebot","Term%","NE5","WVL","Pipeline"].map(h => (
                <th key={h} style={{ padding: "6px 5px", textAlign: h==="Scouter"?"left":"right", color: C.sec, fontWeight: 600, fontSize: 9 }}>{h}</th>
              ))}
            </tr></thead>
            <tbody>{(() => {
              const lmtSc = (period==="jan"?LMT.jan:period==="total"?LMT.total:LMT.feb).scouter;
              return lmtSc.filter(s=>s.t>0).sort((a,b)=>(b.term+b.ang)/(b.t||1)-(a.term+a.ang)/(a.t||1)).map((s,i) => {
                const r = s.t>0?(s.term+s.ang)/s.t*100:0;
                const pipe = (s.wvl||0)+(s.ne||0);
                return (
                  <tr key={i} style={{ borderBottom: `1px solid ${C.border}` }}>
                    <td style={{ padding: "5px", fontWeight: 600 }}>{s.n}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: C.blue }}>{s.t}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: C.green, fontWeight: 700 }}>{s.term}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: C.cyan }}>{s.ang||"–"}</td>
                    <td style={{ padding: "5px", textAlign: "right" }}><Badge v={`${r.toFixed(0)}%`} color={r>60?C.green:r>30?C.amber:C.red}/></td>
                    <td style={{ padding: "5px", textAlign: "right", color: s.ne5>0?C.orange:C.dim }}>{s.ne5||"–"}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: s.wvl>0?C.blue:C.dim }}>{s.wvl||"–"}</td>
                    <td style={{ padding: "5px", textAlign: "right", color: pipe>0?C.cyan:C.dim }}>{pipe||"–"}</td>
                  </tr>
                );
              });
            })()}</tbody>
          </table>
        </div>
        <div style={{ fontSize: 10, color: C.dim, marginTop: 4 }}>MVPP-Leads: 0% PLZ-Ausfall vs. SADD 48% · Pipeline = WVL + nicht erreicht (nachbearbeitbar)</div>
      </Sec>

      {/* ══ HGB VERTRIEBLER ══ */}
      <div style={{ background: `linear-gradient(135deg, ${C.cyan}12, ${C.purple}08)`, borderRadius: 14, padding: "14px 24px", border: `1px solid ${C.cyan}25` }}>
        <span style={{ fontSize: 16, fontWeight: 800, color: C.text }}>🤝 HGB Vertriebler</span>
        <div style={{ fontSize: 12, color: C.sec }}>200€/Sale + 50€/EzA-Lead · kein Gehalt, kein Auto</div>
      </div>

      <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
        <KPI label="HGB aktiv" value={vbHgb.length} sub={`${vbHgbWithSales.length} mit Sales`} color={C.cyan}/>
        <KPI label="Sales" value={vbHgbTotals.sales} sub={periodLabel} color={C.green}/>
        <KPI label="Kosten" value={eur(vbHgbTotals.kosten)} sub="200€/Sale + 50€/EzA" color={C.red}/>
        <KPI label="K/Sale" value="200€" sub="fix" color={C.green}/>
      </div>

      <Sec title={`📋 HGB Vertriebler – ${periodLabel}`}>
        <div style={{ overflowX: "auto" }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
            <thead><tr style={{ background: C.card }}>
              <th style={{ padding: "8px 5px", textAlign: "left", color: C.sec, fontSize: 11, borderBottom: `1px solid ${C.border}` }}>Vertriebler</th>
              <th style={{ padding: "8px 5px", textAlign: "right", color: C.sec, fontSize: 11, borderBottom: `1px solid ${C.border}` }}>Sales</th>
              <th style={{ padding: "8px 5px", textAlign: "right", color: C.sec, fontSize: 11, borderBottom: `1px solid ${C.border}` }}>Kosten</th>
            </tr></thead>
            <tbody>
              {vbHgbWithSales.map((s, i) => (
                <tr key={i} style={{ borderBottom: `1px solid ${C.border}`, background: i % 2 === 0 ? "transparent" : `${C.card}60` }}>
                  <td style={{ padding: "7px 5px", fontWeight: 600, color: C.text }}>{s.n}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", fontWeight: 700, color: C.green }}>{s.sales}</td>
                  <td style={{ padding: "7px 5px", textAlign: "right", color: C.red }}>{eur(s.kosten)}</td>
                </tr>
              ))}
              <tr style={{ borderTop: `2px solid ${C.cyan}`, background: `${C.cyan}08` }}>
                <td style={{ padding: "8px 5px", fontWeight: 800, color: C.cyan }}>HGB GESAMT ({vbHgb.length})</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 800, color: C.green }}>{vbHgbTotals.sales}</td>
                <td style={{ padding: "8px 5px", textAlign: "right", fontWeight: 700, color: C.red }}>{eur(vbHgbTotals.kosten)}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </Sec>

      {/* ══ GESAMTÜBERSICHT ══ */}
      <Alert color={C.amber} icon="📊">
        <strong>{periodLabel} Gesamtkosten Vertrieb:</strong> {eur(angTotals.kosten + sumData(scouterHgb).kosten + vbHgbTotals.kosten)} · 
        <strong style={{ color: C.blue }}>{allAng.length} Angest.</strong> ({angTotals.sales} Sales, {eur(angTotals.kosten)}, Ø {eur(Math.round(angTotals.kosten/Math.max(angTotals.sales,1)))}/Sale) · 
        <strong style={{ color: C.cyan }}>HGB</strong> ({sumData(scouterHgb).sales + vbHgbTotals.sales} Sales, {eur(sumData(scouterHgb).kosten + vbHgbTotals.kosten)})
      </Alert>
    </div>
  );
};
// ═══ FORECAST ═══
const FORECAST = {
  daysElapsed: 16, daysRemaining: 12, daysTotal: 28,
  salesPerDay: 5.25, nettoPerDay: 115285,
  forecastSales: 147, forecastNetto: 3227982,
  w1: 28, w2: 46, w3: 10, // weekly sales
  target: 150, targetNetto: 3500000,
};

// ═══ WVL PIPELINE ═══
const WVL = {
  total: 266,
  types: [
    {name:"WVL Überleger",value:162,color:"#F59E0B"},
    {name:"WVL Gegenangebot",value:58,color:"#EF4444"},
    {name:"WVL Frau nicht da",value:46,color:"#E3A008"},
  ],
  age: {avg:7.3,u3d:37,m3_7d:88,o7d:141},
  byVB: [
    {n:"Philipp-T. Hannigk",v:21},{n:"Andreas Klee",v:18},{n:"Stefan Hensel",v:17},
    {n:"Martin Bott",v:16},{n:"Nino Rimmler",v:15},{n:"Maxim Horten",v:15},
    {n:"Gino Ulitzka",v:13},{n:"Patrick Kalinowski",v:12},{n:"Maximilian Koch",v:12},
    {n:"Hartmut Seitz",v:12},{n:"Klaus Vollmer",v:11},{n:"Kadir Danyildiz",v:12},
  ],
  convEst: 0.15, // 15% estimated conversion
};

// ═══ SCOUT↔VB MATRIX ═══
const SCOUT_VB_MATRIX = [
  {sc:"Norbert Pap",vb:"Lukas Kirschner",te:22,sf:0,af:14,sales:0,net:0},
  {sc:"Ayhan Celik",vb:"Philipp-T. Hannigk",te:13,sf:2,af:7,sales:1,net:16000},
  {sc:"Anmar Ashraf",vb:"Stefan Hensel",te:10,sf:4,af:4,sales:4,net:98953},
  {sc:"Robin Kricke",vb:"Tayfun Süleymaniye",te:9,sf:2,af:6,sales:0,net:0},
  {sc:"Fabian Ricken",vb:"Fabian Hindenberg",te:9,sf:3,af:6,sales:1,net:18364},
  {sc:"Thomas Herrmann",vb:"Miguel Schader",te:8,sf:2,af:6,sales:0,net:0},
  {sc:"Robin Kricke",vb:"Maxim Horten",te:7,sf:5,af:2,sales:2,net:34850},
  {sc:"Christian Neukirch",vb:"Gino Ulitzka",te:7,sf:3,af:3,sales:4,net:76650},
  {sc:"Thomas Herrmann",vb:"Maximilian Koch",te:6,sf:4,af:2,sales:0,net:0},
  {sc:"Cinar Onk",vb:"Maximilian Koch",te:5,sf:4,af:1,sales:0,net:0},
  {sc:"Cinar Onk",vb:"Frank Reddig",te:5,sf:2,af:2,sales:0,net:0},
  {sc:"Alexander Luxat",vb:"Kadir Danyildiz",te:5,sf:3,af:1,sales:1,net:20650},
  {sc:"Robin Kricke",vb:"Kadir Danyildiz",te:3,sf:3,af:0,sales:0,net:0},
  {sc:"Robin Kricke",vb:"Bernd Krahwinkel",te:2,sf:1,af:1,sales:0,net:0},
  {sc:"Thomas Herrmann",vb:"Gino Ulitzka",te:2,sf:1,af:1,sales:0,net:0},
  {sc:"Dilara Durgun",vb:"Gino Ulitzka",te:2,sf:2,af:0,sales:0,net:0},
];

// ═══ LEAD STATS ═══
const LEAD_STATS = {
  total: 3929, avgPerDay: 246,
  bySource: [
    {name:"SADD",leads:1309,term:120,termRate:9,rekl:227,nplz:630},
    {name:"Enpal-WP",leads:1089,term:86,termRate:8,rekl:352,nplz:63},
    {name:"beedoo",leads:493,term:0,termRate:0,rekl:0,nplz:0},
    {name:"MVPP",leads:393,term:224,termRate:57,rekl:5,nplz:0},
    {name:"EzA",leads:215,term:0,termRate:0,rekl:0,nplz:0},
    {name:"Eigenlead",leads:165,term:104,termRate:63,rekl:0,nplz:0},
    {name:"Omega",leads:118,term:115,termRate:97,rekl:2,nplz:0},
    {name:"Enpal",leads:67,term:0,termRate:0,rekl:0,nplz:0},
    {name:"Sonstige",leads:80,term:0,termRate:0,rekl:0,nplz:0},
  ],
};

// ═══ VB STUNDENPLAN (ganzer Feb, alle Termine) ═══
const VB_PLAN = [
  {n:"Gino Ulitzka",t:62,o:36,a:16,f:10,d:{2:1,5:2,6:2,7:1,9:1,10:2,11:3,12:4,13:3,14:2,16:4,17:4,18:3,19:2,20:5,21:1,23:6,24:5,25:5,26:2,27:3,28:1}},
  {n:"Miguel Schader",t:55,o:34,a:2,f:19,d:{11:1,12:2,13:3,16:4,17:8,18:8,19:8,20:4,23:3,24:2,25:5,26:1,27:5,28:1}},
  {n:"Andreas Klee",t:52,o:30,a:13,f:9,d:{3:1,9:1,11:1,12:4,13:3,14:1,16:6,17:2,18:2,19:6,20:4,23:5,24:4,25:4,26:3,27:2,28:3}},
  {n:"Stefan Hensel",t:50,o:32,a:8,f:10,d:{7:1,9:3,11:2,12:2,13:2,14:4,16:1,17:2,18:1,19:2,20:2,21:4,22:1,23:6,24:2,25:4,26:4,27:3,28:4}},
  {n:"Fabian Hindenberg",t:49,o:35,a:5,f:9,d:{6:1,9:1,12:2,13:4,16:3,17:5,18:3,19:2,20:2,23:4,24:4,25:4,26:6,27:6,28:2}},
  {n:"Kadir Danyildiz",t:45,o:26,a:13,f:6,d:{4:2,6:1,9:3,10:3,11:3,12:1,16:4,17:3,18:4,19:3,20:2,21:1,23:2,24:3,25:3,26:3,27:4}},
  {n:"Nino Rimmler",t:45,o:31,a:5,f:9,d:{6:1,7:2,10:2,11:1,13:2,14:1,16:2,17:3,18:2,19:5,20:3,21:3,23:2,24:2,25:4,26:4,27:5,28:1}},
  {n:"Maxim Horten",t:40,o:20,a:10,f:10,d:{5:2,9:2,10:2,11:2,12:2,13:2,16:4,17:4,18:1,19:4,20:5,23:1,24:3,25:2,26:1,27:3}},
  {n:"Patrick Kalinowski",t:37,o:18,a:10,f:9,d:{5:2,7:1,9:1,10:1,11:1,12:2,13:3,14:1,16:2,17:3,18:1,19:1,20:2,21:1,23:2,24:1,25:3,26:3,27:4,28:2}},
  {n:"Tayfun Süleymaniye",t:35,o:20,a:3,f:12,d:{5:2,9:1,10:3,11:4,13:1,16:3,17:4,18:4,19:1,23:4,24:2,25:4,26:2}},
  {n:"Bernd Krahwinkel",t:34,o:26,a:5,f:3,d:{6:1,9:2,11:3,12:2,13:2,16:3,17:3,18:4,19:3,20:3,23:1,24:1,25:1,26:2,27:3}},
  {n:"Klaus Vollmer",t:33,o:20,a:9,f:4,d:{4:1,7:1,9:4,11:2,12:2,14:2,16:2,17:1,18:3,19:3,20:1,21:2,23:2,24:2,25:3,27:1,28:1}},
  {n:"Martin Bott",t:29,o:19,a:8,f:2,d:{3:1,6:1,9:2,10:1,11:3,12:1,18:1,19:3,20:3,23:1,24:1,25:4,26:3,27:3,28:1}},
  {n:"Lukas Kirschner",t:26,o:12,a:0,f:14,d:{3:1,4:2,6:3,7:3,9:3,11:1,12:2,13:2,14:2,15:2,16:1,19:1,20:1,21:2}},
  {n:"Dimitri van Eeuwen",t:26,o:17,a:4,f:5,d:{11:2,12:1,13:4,16:1,17:4,18:1,19:1,20:2,23:2,24:2,25:1,26:3,27:2}},
  {n:"Philipp-T. Hannigk",t:26,o:15,a:3,f:8,d:{5:1,6:3,9:1,10:1,11:1,12:3,13:3,14:2,16:2,17:1,18:2,19:2,20:1,21:1,23:1,25:1}},
  {n:"Marco Bringmann",t:24,o:15,a:3,f:6,d:{3:1,5:1,9:1,11:1,12:1,14:1,16:2,17:2,18:3,19:2,21:2,23:2,24:4,25:1}},
  {n:"Richard Winzent",t:23,o:10,a:8,f:5,d:{9:2,10:2,11:4,12:2,13:3,16:2,17:1,18:1,20:3,21:1,24:1,27:1}},
  {n:"Maximilian Koch",t:20,o:6,a:10,f:4,d:{4:2,5:1,9:1,11:3,12:1,13:3,16:2,17:3,18:1,19:2,23:1}},
  {n:"Hartmut Seitz",t:20,o:11,a:8,f:1,d:{6:1,9:1,10:1,11:2,13:2,16:1,17:1,18:2,19:1,23:1,24:1,25:3,26:1,27:2}},
  {n:"Pascal Schallenberg",t:19,o:12,a:4,f:3,d:{6:1,10:2,11:2,12:1,13:1,17:2,18:3,19:2,20:1,23:2,25:1,27:1}},
  {n:"Daniel Saweljew",t:19,o:10,a:7,f:2,d:{6:1,7:1,9:1,10:2,12:2,17:1,18:2,19:1,20:1,21:1,24:1,25:1,26:3,27:1}},
  {n:"Jannis Pfeiffer",t:18,o:8,a:6,f:4,d:{9:2,11:2,12:2,13:1,16:2,17:2,18:3,19:1,23:1,24:2}},
  {n:"Janik Voß",t:18,o:15,a:0,f:3,d:{12:3,17:1,18:2,19:2,20:5,25:3,26:2}},
  {n:"Farshad Nourouzi",t:15,o:12,a:3,f:0,d:{11:2,13:1,17:2,18:1,19:2,21:1,24:1,25:1,26:2,27:1,28:1}},
  {n:"Pascal Meier",t:14,o:7,a:3,f:4,d:{4:2,9:1,11:1,12:1,13:2,17:1,18:2,19:1,20:2,26:1}},
  {n:"Kevin Kraus",t:12,o:7,a:5,f:0,d:{5:1,6:1,9:1,10:1,11:1,16:1,17:2,18:1,19:1,20:2}},
  {n:"Frank Reddig",t:13,o:2,a:5,f:6,d:{4:1,6:2,10:1,11:3,12:2,13:1,17:3}},
  {n:"Christian Seifert",t:10,o:6,a:0,f:4,d:{4:1,5:1,6:2,13:2,14:1,17:1,21:2}},
];
const FEB_DAYS = [
  {d:2,wd:"Mo"},{d:3,wd:"Di"},{d:4,wd:"Mi"},{d:5,wd:"Do"},{d:6,wd:"Fr"},{d:7,wd:"Sa"},
  {d:9,wd:"Mo"},{d:10,wd:"Di"},{d:11,wd:"Mi"},{d:12,wd:"Do"},{d:13,wd:"Fr"},{d:14,wd:"Sa"},
  {d:16,wd:"Mo"},{d:17,wd:"Di"},{d:18,wd:"Mi"},{d:19,wd:"Do"},{d:20,wd:"Fr"},{d:21,wd:"Sa"},
  {d:23,wd:"Mo"},{d:24,wd:"Di"},{d:25,wd:"Mi"},{d:26,wd:"Do"},{d:27,wd:"Fr"},{d:28,wd:"Sa"},
];
const SCOUT_PLAN = [
  {n:"Thomas Herrmann",t:54,gen:55,d:{4:2,5:1,6:1,10:1,11:3,12:1,13:5,16:5,17:7,18:6,19:5,20:3,23:4,24:1,25:3,26:1,27:4,28:1},g:{2:3,3:1,4:8,5:11,6:5,9:3,10:7,11:4,12:4,13:3,16:6}},
  {n:"Fabian Ricken",t:40,gen:50,d:{12:2,13:4,16:3,17:4,18:3,19:1,20:2,23:3,24:3,25:3,26:6,27:5,28:1},g:{2:6,4:3,5:6,6:6,9:1,10:6,11:7,12:5,16:10}},
  {n:"Robin Kricke",t:34,gen:35,d:{4:2,5:1,6:1,9:3,10:4,11:6,12:1,13:3,16:2,17:4,18:1,19:1,20:2,24:1,25:2},g:{2:9,3:1,4:9,5:3,6:1,10:6,11:2,12:1,13:2,16:1}},
  {n:"Cinar Onk",t:31,gen:31,d:{9:2,11:5,12:5,13:2,16:2,17:4,18:2,19:4,20:2,24:1,25:1,27:1},g:{2:2,3:1,4:4,5:3,6:2,9:2,10:3,11:7,12:3,13:2,16:2}},
  {n:"Anmar Ashraf",t:28,gen:33,d:{7:1,9:1,11:2,12:1,13:2,14:3,17:2,20:1,21:2,23:4,24:2,25:2,26:1,28:4},g:{2:4,4:1,5:4,6:3,7:2,9:1,10:3,11:6,12:2,13:5,16:2}},
  {n:"Norbert Pap",t:26,gen:26,d:{3:1,4:2,6:3,7:3,9:3,11:1,12:2,13:2,14:2,15:2,16:1,19:1,20:1,21:2},g:{2:5,3:4,4:3,5:8,6:5,9:1}},
  {n:"Alexander Luxat",t:22,gen:25,d:{9:2,11:3,12:1,17:1,18:4,19:2,20:1,23:1,24:2,25:1,26:2,27:2},g:{4:5,6:1,7:1,9:5,10:2,11:3,12:2,13:2,16:4}},
  {n:"Ayhan Celik",t:20,gen:21,d:{5:1,6:2,9:1,10:1,11:1,12:2,13:1,14:2,16:2,17:1,18:2,19:2,20:1,21:1},g:{2:1,3:4,4:3,5:4,6:3,9:2,10:3,12:1}},
  {n:"Danilo Duric",t:16,gen:17,d:{12:1,19:2,20:1,21:2,22:1,23:1,25:1,26:4,27:3},g:{4:1,6:4,9:2,10:1,12:2,16:7}},
  {n:"Selçuk Özkaya",t:15,gen:31,d:{16:1,17:2,18:1,19:2,23:4,24:1,25:2,26:2},g:{2:4,5:1,6:4,9:1,10:8,12:2,13:11}},
  {n:"Christian Neukirch",t:11,gen:11,d:{6:1,7:1,10:1,11:1,12:1,14:1,16:1,20:1,23:2,24:1},g:{4:3,9:1,10:2,11:4,16:1}},
  {n:"Constanze Hamm-Schaub",t:5,gen:5,d:{9:1,14:1,18:1,21:1,25:1},g:{1:1,3:1,7:1,9:1,12:1}},
  {n:"Dilara Durgun",t:4,gen:5,d:{5:1,12:1,20:1,26:1},g:{3:1,9:2,11:1,13:1}},
];
const TICKER = [
  {h:"09:00",he:"11:00",b:"Fabian Hindenberg",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Tobias W.",sc:"F. Ricken"},
  {h:"10:00",he:"12:00",b:"Gino Ulitzka",q:"SADD",st:"Offen",tt:"PV",k:"Florian S."},
  {h:"10:00",he:"12:00",b:"Maximilian Koch",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Mark D.",sc:"T. Herrmann"},
  {h:"10:00",he:"12:00",b:"Miguel Schader",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Bernd R.",sc:"T. Herrmann"},
  {h:"10:00",he:"13:00",b:"Nino Rimmler",q:"Omega",st:"Ausgefallen",tt:"PV",k:"Sebastian G."},
  {h:"10:00",he:"12:00",b:"Jannis Pfeiffer",q:"SADD",st:"Offen",tt:"PV",k:"Fabian W."},
  {h:"10:00",he:"12:00",b:"Dimitri van Eeuwen",q:"Empfehlung",st:"Offen",tt:"Folge",k:"Khalaf F."},
  {h:"10:00",he:"12:00",b:"Tayfun Süleymaniye",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Domenik K.",sc:"R. Kricke"},
  {h:"10:00",he:"12:00",b:"Frank Reddig",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Tobias B.",sc:"C. Onk"},
  {h:"10:00",he:"12:00",b:"Stefan Hensel",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Luisa R.",sc:"A. Ashraf"},
  {h:"10:15",he:"11:15",b:"Maxim Horten",q:"MVPP",st:"Ausgefallen",tt:"Folge",k:"Kai M.",sc:"R. Kricke"},
  {h:"10:30",he:"12:30",b:"Andreas Klee",q:"SADD",st:"Ausgefallen",tt:"PV",k:"Volkmar H."},
  {h:"11:00",he:"13:00",b:"Patrick Kalinowski",q:"Enpal-WP",st:"Ausgefallen",tt:"PV",k:"Karoline F."},
  {h:"11:00",he:"13:00",b:"Kadir Danyildiz",q:"SADD",st:"Ausgefallen",tt:"PV",k:"Mark H."},
  {h:"11:00",he:"13:00",b:"Frank Reddig",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Monika S.",sc:"C. Onk"},
  {h:"11:30",he:"13:30",b:"Fabian Hindenberg",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Jutta H.",sc:"F. Ricken"},
  {h:"12:00",he:"14:00",b:"Janik Voß",q:"SADD",st:"Offen",tt:"PV",k:"Doris W."},
  {h:"12:00",he:"14:00",b:"Pascal Meier",q:"EzA",st:"Offen",tt:"PV",k:"Burkhard H."},
  {h:"12:00",he:"14:00",b:"Miguel Schader",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Amer K.",sc:"T. Herrmann"},
  {h:"12:00",he:"14:00",b:"Miguel Schader",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Christian A.",sc:"T. Herrmann"},
  {h:"12:00",he:"14:00",b:"Miguel Schader",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Thorsten T.",sc:"T. Herrmann"},
  {h:"12:00",he:"14:00",b:"Maxim Horten",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Julius M.",sc:"R. Kricke"},
  {h:"12:00",he:"15:00",b:"Dimitri van Eeuwen",q:"Omega",st:"Offen",tt:"PV",k:"Philo K."},
  {h:"12:00",he:"14:00",b:"Daniel Saweljew",q:"Eigenlead",st:"Ausgefallen",tt:"PV",k:"Hartmann K."},
  {h:"12:00",he:"14:00",b:"Kadir Danyildiz",q:"SADD",st:"Offen",tt:"PV",k:"Frank P."},
  {h:"13:00",he:"15:00",b:"Maximilian Koch",q:"Enpal-WP",st:"Offen",tt:"PV",k:"Marc S."},
  {h:"13:00",he:"15:00",b:"Gino Ulitzka",q:"Enpal-WP",st:"Offen",tt:"PV",k:"Paul S."},
  {h:"13:00",he:"15:00",b:"Bernd Krahwinkel",q:"EzA",st:"Offen",tt:"PV",k:"Frank M."},
  {h:"14:00",he:"16:00",b:"Patrick Kalinowski",q:"SADD",st:"Ausgefallen",tt:"PV",k:"Dieter W."},
  {h:"14:00",he:"16:00",b:"Farshad Nourouzi",q:"SADD",st:"Offen",tt:"PV",k:"Binita S."},
  {h:"14:00",he:"16:00",b:"Miguel Schader",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Robert M.",sc:"T. Herrmann"},
  {h:"14:00",he:"16:00",b:"Miguel Schader",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Angelika R.",sc:"C. Onk"},
  {h:"14:00",he:"16:00",b:"Maxim Horten",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Patricia D.",sc:"R. Kricke"},
  {h:"14:00",he:"16:00",b:"Kevin Kraus",q:"Empfehlung",st:"Offen",tt:"PV",k:"Timo S."},
  {h:"14:30",he:"16:30",b:"Frank Reddig",q:"Enpal-WP",st:"Ausgefallen",tt:"PV",k:"Waldemar S."},
  {h:"15:00",he:"17:00",b:"Marco Bringmann",q:"Enpal-WP",st:"Offen",tt:"PV",k:"Jürgen K."},
  {h:"15:00",he:"17:00",b:"Philipp-T. Hannigk",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Gabi K.",sc:"A. Celik"},
  {h:"15:00",he:"17:00",b:"Fabian Hindenberg",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Michael L.",sc:"F. Ricken"},
  {h:"15:00",he:"17:00",b:"Fabian Hindenberg",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Vanessa M.",sc:"F. Ricken"},
  {h:"15:00",he:"20:00",b:"Kadir Danyildiz",q:"Omega",st:"Offen",tt:"PV",k:"Alireza M."},
  {h:"15:30",he:"17:30",b:"Patrick Kalinowski",q:"SADD",st:"Offen",tt:"PV",k:"Adnan A."},
  {h:"15:30",he:"17:30",b:"Gino Ulitzka",q:"Enpal-WP",st:"Offen",tt:"PV",k:"Dirk G."},
  {h:"15:30",he:"17:30",b:"Maximilian Koch",q:"MVPP",st:"Offen",tt:"PV",k:"Frank A."},
  {h:"16:00",he:"18:00",b:"Sebastian Mansour",q:"Eigenlead",st:"Ausgefallen",tt:"PV",k:"Akkaya"},
  {h:"16:00",he:"18:00",b:"Klaus Vollmer",q:"EzA",st:"Offen",tt:"PV",k:"Martin B."},
  {h:"16:00",he:"18:00",b:"Jannis Pfeiffer",q:"Enpal-WP",st:"Ausgefallen",tt:"PV",k:"Ireneusz Z."},
  {h:"16:00",he:"18:00",b:"Tayfun Süleymaniye",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Gernot K.",sc:"A. Luxat"},
  {h:"16:00",he:"18:00",b:"Pascal Schallenberg",q:"Eigenlead",st:"Offen",tt:"PV",k:"Wulf"},
  {h:"16:30",he:"18:30",b:"Stefan Hensel",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Daniela G.",sc:"A. Ashraf"},
  {h:"16:30",he:"18:30",b:"Bernd Krahwinkel",q:"EzA",st:"Offen",tt:"PV",k:"Dusan A."},
  {h:"17:00",he:"19:00",b:"Tayfun Süleymaniye",q:"MVPP",st:"Offen",tt:"SCOUT",k:"Sandra G.",sc:"S. Özkaya"},
  {h:"17:00",he:"20:00",b:"Dimitri van Eeuwen",q:"Omega",st:"Offen",tt:"PV",k:"Stefan A."},
  {h:"17:00",he:"19:00",b:"Richard Winzent",q:"Eigenlead",st:"Offen",tt:"PV",k:"Rob H."},
  {h:"17:00",he:"19:00",b:"Farshad Nourouzi",q:"EzA",st:"Offen",tt:"PV",k:"Norbert E."},
  {h:"17:00",he:"19:00",b:"Nino Rimmler",q:"EzA",st:"Offen",tt:"PV",k:"Viktor P."},
  {h:"17:00",he:"19:00",b:"Hartmut Seitz",q:"SADD",st:"Offen",tt:"PV",k:"Roman M."},
  {h:"17:15",he:"18:15",b:"Andreas Klee",q:"SADD",st:"Offen",tt:"Folge",k:"Horst R."},
  {h:"17:15",he:"18:00",b:"Marco Bringmann",q:"bee-doo.de",st:"Offen",tt:"PV",k:"Sandra Z."},
  {h:"17:30",he:"20:30",b:"Maxim Horten",q:"Omega",st:"Offen",tt:"PV",k:"Günter G."},
  {h:"18:00",he:"20:00",b:"Miguel Schader",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Dragan M.",sc:"T. Herrmann"},
  {h:"18:00",he:"20:00",b:"Gino Ulitzka",q:"Enpal-WP",st:"Offen",tt:"PV",k:"Wilhelm K."},
  {h:"18:00",he:"20:00",b:"Miguel Schader",q:"MVPP",st:"Ausgefallen",tt:"SCOUT",k:"Helene T.",sc:"C. Onk"},
  {h:"18:00",he:"20:00",b:"Pascal Schallenberg",q:"Eigenlead",st:"Ausgefallen",tt:"PV",k:"Habicht H."},
  {h:"18:00",he:"20:00",b:"Christian Seifert",q:"Eigenlead",st:"Offen",tt:"PV",k:"Pierre G."},
  {h:"18:30",he:"20:30",b:"Bernd Krahwinkel",q:"SADD",st:"Offen",tt:"PV",k:"Andreas B."},
  {h:"18:30",he:"21:30",b:"Fabian Hindenberg",q:"Omega",st:"Offen",tt:"PV",k:"Tanja H."},
  {h:"19:00",he:"20:00",b:"Nino Rimmler",q:"EzA",st:"Offen",tt:"Folge",k:"Josef W."},
  {h:"19:00",he:"21:00",b:"Kevin Kraus",q:"Eigenlead",st:"Offen",tt:"PV",k:"Kathrin K."},
  {h:"19:15",he:"20:15",b:"Tayfun Süleymaniye",q:"MVPP",st:"Offen",tt:"Folge",k:"Andrea B.",sc:"S. Özkaya"},
  {h:"20:00",he:"21:00",b:"Dimitri van Eeuwen",q:"Omega",st:"Offen",tt:"Folge",k:"Mario H."},
];
const VB_PAST = [
  {n:"Gino Ulitzka",te:25,sf:16,af:8,o:1,ab:6,wvl:7,ki:3,afp:32},
  {n:"Lukas Kirschner",te:22,sf:0,af:14,o:8,ab:0,wvl:0,ki:0,afp:64},
  {n:"Kadir Danyildiz",te:17,sf:13,af:3,o:1,ab:4,wvl:7,ki:2,afp:18},
  {n:"Andreas Klee",te:17,sf:13,af:4,o:0,ab:1,wvl:7,ki:5,afp:24},
  {n:"Philipp-T. Hannigk",te:17,sf:3,af:7,o:7,ab:2,wvl:1,ki:0,afp:41},
  {n:"Maxim Horten",te:16,sf:10,af:6,o:0,ab:2,wvl:7,ki:1,afp:38},
  {n:"Stefan Hensel",te:15,sf:7,af:6,o:2,ab:5,wvl:1,ki:1,afp:40},
  {n:"Richard Winzent",te:15,sf:8,af:5,o:2,ab:1,wvl:4,ki:3,afp:33},
  {n:"Tayfun Süleymaniye",te:14,sf:3,af:8,o:3,ab:1,wvl:0,ki:2,afp:57},
  {n:"Patrick Kalinowski",te:14,sf:10,af:4,o:0,ab:1,wvl:7,ki:2,afp:29},
  {n:"Klaus Vollmer",te:14,sf:9,af:4,o:1,ab:0,wvl:7,ki:2,afp:29},
  {n:"Maximilian Koch",te:13,sf:10,af:3,o:0,ab:0,wvl:4,ki:6,afp:23},
  {n:"Bernd Krahwinkel",te:13,sf:5,af:1,o:7,ab:0,wvl:1,ki:4,afp:8},
  {n:"Fabian Hindenberg",te:11,sf:5,af:6,o:0,ab:2,wvl:1,ki:2,afp:55},
  {n:"Nino Rimmler",te:11,sf:5,af:5,o:1,ab:1,wvl:4,ki:0,afp:45},
  {n:"Miguel Schader",te:10,sf:2,af:8,o:0,ab:0,wvl:2,ki:0,afp:80},
  {n:"Frank Reddig",te:10,sf:5,af:4,o:1,ab:0,wvl:1,ki:4,afp:40},
  {n:"Jannis Pfeiffer",te:9,sf:6,af:3,o:0,ab:1,wvl:3,ki:2,afp:33},
  {n:"Martin Bott",te:9,sf:8,af:1,o:0,ab:1,wvl:4,ki:3,afp:11},
  {n:"Dimitri van Eeuwen",te:8,sf:4,af:4,o:0,ab:1,wvl:2,ki:1,afp:50},
  {n:"Marco Bringmann",te:8,sf:3,af:4,o:1,ab:1,wvl:2,ki:0,afp:50},
  {n:"Hartmut Seitz",te:8,sf:8,af:0,o:0,ab:1,wvl:5,ki:2,afp:0},
  {n:"Ricardo Riedel",te:8,sf:1,af:0,o:7,ab:0,wvl:0,ki:1,afp:0},
  {n:"Pascal Meier",te:7,sf:3,af:4,o:0,ab:1,wvl:1,ki:1,afp:57},
  {n:"Daniel Saweljew",te:7,sf:7,af:0,o:0,ab:1,wvl:3,ki:3,afp:0},
  {n:"Christian Seifert",te:7,sf:0,af:4,o:3,ab:0,wvl:0,ki:0,afp:57},
  {n:"Pascal Schallenberg",te:7,sf:4,af:2,o:1,ab:3,wvl:1,ki:0,afp:29},
  {n:"Kevin Kraus",te:6,sf:5,af:0,o:1,ab:4,wvl:1,ki:0,afp:0},
  {n:"Sebastian Mansour",te:6,sf:5,af:1,o:0,ab:0,wvl:4,ki:1,afp:17},
  {n:"Farshad Nourouzi",te:3,sf:3,af:0,o:0,ab:2,wvl:1,ki:0,afp:0},
];
const PAST_DAILY = [
  {d:"02.02.",te:1,sf:1,af:0},{d:"03.02.",te:4,sf:2,af:1},{d:"04.02.",te:12,sf:7,af:2},
  {d:"05.02.",te:15,sf:8,af:5},{d:"06.02.",te:22,sf:14,af:6},{d:"07.02.",te:11,sf:5,af:4},
  {d:"09.02.",te:37,sf:25,af:10},{d:"10.02.",te:25,sf:20,af:5},{d:"11.02.",te:55,sf:29,af:22},
  {d:"12.02.",te:45,sf:20,af:20},{d:"13.02.",te:56,sf:24,af:17},{d:"14.02.",te:18,sf:3,af:10},
  {d:"15.02.",te:2,sf:0,af:2},{d:"16.02.",te:53,sf:25,af:16},
];
const PAST_SUMMARY = {total:356,sf:183,af:120,offen:53,scoutyTotal:109,scoutyAF:54,scoutyAFP:49.5,nichtScoutyTotal:247,nichtScoutyAF:66,nichtScoutyAFP:26.7};
const SCOUTY_FIELD = {
  total:109,sf:34,af:54,offen:21,afPct:49.5,abschluss:8,abQuote:23.5,wvl:10,sales:13,salesNetto:265467,
  scouts:[
    {n:"Norbert Pap",te:22,sf:0,af:14,o:8,ab:0,wvl:0,ki:0,genSales:0,genNet:0},
    {n:"Robin Kricke",te:19,sf:9,af:7,o:3,ab:2,wvl:4,ki:3,genSales:2,genNet:34850},
    {n:"Thomas Herrmann",te:14,sf:6,af:8,o:0,ab:0,wvl:4,ki:2,genSales:0,genNet:0},
    {n:"Cinar Onk",te:13,sf:5,af:6,o:2,ab:0,wvl:1,ki:4,genSales:0,genNet:0},
    {n:"Ayhan Celik",te:12,sf:2,af:6,o:4,ab:1,wvl:1,ki:0,genSales:1,genNet:16000},
    {n:"Anmar Ashraf",te:7,sf:2,af:4,o:1,ab:1,wvl:1,ki:0,genSales:4,genNet:98953},
    {n:"Fabian Ricken",te:7,sf:3,af:4,o:0,ab:1,wvl:1,ki:1,genSales:1,genNet:18364},
    {n:"Alexander Luxat",te:5,sf:3,af:1,o:1,ab:1,wvl:2,ki:0,genSales:1,genNet:20650},
    {n:"Christian Neukirch",te:5,sf:2,af:2,o:1,ab:2,wvl:0,ki:0,genSales:4,genNet:76650},
    {n:"Dilara Durgun",te:2,sf:2,af:0,o:0,ab:0,wvl:0,ki:2,genSales:0,genNet:0},
  ],
  daily:[
    {d:"03.02.",te:1,sf:0,af:0},{d:"04.02.",te:5,sf:2,af:2},{d:"05.02.",te:4,sf:2,af:2},
    {d:"06.02.",te:8,sf:3,af:4},{d:"07.02.",te:4,sf:0,af:3},{d:"09.02.",te:8,sf:4,af:3},
    {d:"10.02.",te:5,sf:3,af:2},{d:"11.02.",te:18,sf:7,af:11},{d:"12.02.",te:16,sf:3,af:10},
    {d:"13.02.",te:15,sf:5,af:5},{d:"14.02.",te:8,sf:0,af:5},{d:"15.02.",te:2,sf:0,af:2},
    {d:"16.02.",te:15,sf:5,af:5},
  ],
  vb:[
    {n:"Lukas Kirschner",te:22,sf:0,af:14,ab:0,wvl:0},
    {n:"Philipp-T. Hannigk",te:13,sf:2,af:6,ab:1,wvl:1},
    {n:"Miguel Schader",te:10,sf:2,af:8,ab:0,wvl:2},
    {n:"Tayfun Süleymaniye",te:9,sf:2,af:5,ab:0,wvl:0},
    {n:"Stefan Hensel",te:8,sf:2,af:5,ab:1,wvl:1},
    {n:"Gino Ulitzka",te:8,sf:5,af:2,ab:2,wvl:1},
    {n:"Kadir Danyildiz",te:7,sf:6,af:1,ab:2,wvl:4},
    {n:"Fabian Hindenberg",te:7,sf:3,af:4,ab:1,wvl:1},
    {n:"Frank Reddig",te:7,sf:2,af:4,ab:0,wvl:0},
    {n:"Maximilian Koch",te:5,sf:4,af:1,ab:0,wvl:2},
    {n:"Maxim Horten",te:5,sf:4,af:1,ab:1,wvl:2},
  ],
  closedStatus:[
    {name:"Abschluss",value:8,color:C.green},{name:"WVL Frau nicht da",value:4,color:C.amber},
    {name:"WVL Überleger",value:5,color:C.amber},{name:"Kein Int. Partner",value:3,color:C.red},
    {name:"Kein Int. zu teuer",value:3,color:C.red},{name:"T.n.M. Dachbelag",value:2,color:"#6B7280"},
    {name:"Kein Int. zu alt",value:2,color:C.pink},{name:"WVL Gegenangebot",value:2,color:C.orange},
    {name:"Kunde nicht da",value:1,color:C.dim},{name:"Kein Int. Wettbewerb",value:1,color:"#9CA3AF"},
    {name:"Sonstiges",value:3,color:"#4B5563"},
  ],
  topSales:[
    {vb:"Stefan Hensel",sc:"Anmar Ashraf",net:98953,cnt:4},
    {vb:"Gino Ulitzka",sc:"Chr. Neukirch",net:76650,cnt:4},
    {vb:"Maxim Horten",sc:"R. Kricke",net:34850,cnt:2},
    {vb:"Kadir Danyildiz",sc:"A. Luxat",net:20650,cnt:1},
    {vb:"Fabian Hindenberg",sc:"F. Ricken",net:18364,cnt:1},
    {vb:"Philipp-T. Hannigk",sc:"Ayhan Celik",net:16000,cnt:1},
  ],
};
const OM = {
  created:176,offen:125,abg:25,af:20,afPct:11.4,vladyslav:148,selbst:28,
  stattgef:103,abschluss:21,abQuote:20.4,wvl:63,ki:19,
  salesAktiv:6,salesStorno:1,netto:147734,kostenEst:14800,kostenProSale:2467,
  pipeline:125,pipelineAbHeute:118,
  speed:{avg:347,median:355,u24h:6,u48h:15,u24p:4,u48p:9},
  daily:[
    {d:"03.02.",v:2,af:0},{d:"04.02.",v:1,af:0},{d:"05.02.",v:3,af:2},{d:"06.02.",v:4,af:0},
    {d:"07.02.",v:1,af:1},{d:"09.02.",v:4,af:0},{d:"10.02.",v:3,af:1},{d:"11.02.",v:9,af:1},
    {d:"12.02.",v:5,af:3},{d:"13.02.",v:10,af:3},{d:"14.02.",v:2,af:1},{d:"16.02.",v:5,af:2},
    {d:"17.02.",v:7,af:1},{d:"18.02.",v:6,af:0},{d:"19.02.",v:10,af:2},{d:"20.02.",v:9,af:1},
    {d:"23.02.",v:4,af:0},{d:"24.02.",v:8,af:1},{d:"25.02.",v:13,af:0},{d:"26.02.",v:9,af:0},
    {d:"27.02.",v:11,af:1},{d:"28.02.",v:2,af:0},
  ],
  genDaily:[
    {d:"02.02.",v:9},{d:"03.02.",v:17},{d:"04.02.",v:19},{d:"05.02.",v:13},{d:"06.02.",v:18},
    {d:"07.02.",v:2},{d:"09.02.",v:19},{d:"10.02.",v:21},{d:"11.02.",v:21},{d:"12.02.",v:13},
    {d:"13.02.",v:15},{d:"14.02.",v:3},
  ],
  vb:[
    {n:"Martin Bott",te:47,sf:28,ab:4,wvl:16,q:14},
    {n:"Andreas Klee",te:40,sf:22,ab:3,wvl:12,q:14},
    {n:"Nino Rimmler",te:21,sf:6,ab:1,wvl:5,q:17},
    {n:"Dimitri van Eeuwen",te:12,sf:5,ab:0,wvl:4,q:0},
    {n:"Maxim Horten",te:11,sf:3,ab:1,wvl:0,q:33},
    {n:"Hartmut Seitz",te:10,sf:9,ab:2,wvl:6,q:22},
    {n:"Fabian Hindenberg",te:5,sf:2,ab:1,wvl:1,q:50},
    {n:"Pascal Schallenberg",te:4,sf:2,ab:1,wvl:1,q:50},
    {n:"Philipp-T. Hannigk",te:4,sf:6,ab:2,wvl:4,q:33},
    {n:"Martin Bott (FB)",te:3,sf:3,ab:2,wvl:1,q:67},
    {n:"Klaus Vollmer",te:4,sf:1,ab:0,wvl:1,q:0},
  ],
  closedStatus:[
    {name:"WVL Überleger",value:35,color:C.amber},{name:"Abschluss",value:21,color:C.green},
    {name:"WVL Frau nicht da",value:17,color:"#E3A008"},{name:"WVL Gegenangebot",value:11,color:C.orange},
    {name:"Kunde nicht da",value:6,color:C.dim},{name:"Kein Int. zu teuer",value:4,color:C.red},
    {name:"T.n.M. Dachbelag",value:3,color:"#6B7280"},{name:"T.n.M. Dach klein",value:3,color:"#4B5563"},
    {name:"Kein Int. Partner",value:2,color:C.pink},{name:"Kein Int. zu alt",value:1,color:"#9CA3AF"},
  ],
  sales:[
    {b:"Andreas Klee",net:29095,da:"14.02."},{b:"Philipp-T. Hannigk",net:32454,da:"06.02."},
    {b:"Pascal Schallenberg",net:18295,da:"11.02."},{b:"Hartmut Seitz",net:24745,da:"11.02."},
    {b:"Nino Rimmler",net:24445,da:"11.02."},{b:"Gino Ulitzka",net:18700,da:"13.02."},
  ],
};


// ═══ SCHEDULE GRID HELPER ═══
const ScheduleGrid = ({ data, days, title, showLegend, genKey }) => {
  const getColor = (v) => v >= 4 ? C.green : v >= 2 ? C.amber : v >= 1 ? C.red : "transparent";
  const getBg = (v) => v >= 4 ? C.green+"15" : v >= 2 ? C.amber+"10" : v >= 1 ? C.red+"08" : "transparent";
  return (
    <Sec title={title}>
      <div style={{ overflowX: "auto", borderRadius: 10, border: `1px solid ${C.border}` }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11, minWidth: 900 }}>
          <thead><tr style={{ background: C.card }}>
            <th style={{ padding: "5px 8px", textAlign: "left", color: C.sec, fontWeight: 700, borderBottom: `2px solid ${C.border}`, position: "sticky", left: 0, background: C.card, zIndex: 2, minWidth: 130 }}>Name</th>
            <th style={{ padding: "5px 4px", textAlign: "center", color: C.amber, fontWeight: 700, borderBottom: `2px solid ${C.border}`, minWidth: 28 }}>{String.fromCharCode(931)}</th>
            {genKey && <th style={{ padding: "5px 4px", textAlign: "center", color: C.cyan, fontWeight: 700, borderBottom: `2px solid ${C.border}`, minWidth: 28, fontSize: 9 }}>Gen</th>}
            {days.map(fd => (
              <th key={fd.d} style={{ padding: "2px 1px", textAlign: "center", fontWeight: fd.wd==="Sa"?400:600, color: fd.d<=16?C.dim:C.sec, borderBottom: `2px solid ${C.border}`, fontSize: 8, minWidth: 26, background: fd.d===17?C.cyan+"10":"transparent" }}>
                <div>{fd.wd}</div><div style={{ fontSize: 9, fontWeight: 700 }}>{fd.d}</div>
              </th>
            ))}
          </tr></thead>
          <tbody>{data.map((b, i) => (
            <tr key={i} style={{ borderBottom: `1px solid ${C.border}10` }}>
              <td style={{ padding: "3px 8px", fontWeight: 600, color: "#fff", position: "sticky", left: 0, background: C.bg, zIndex: 1, fontSize: 11 }}>{b.n}</td>
              <td style={{ padding: "3px 4px", textAlign: "center", fontWeight: 700, color: b.t>=30?C.green:b.t>=15?C.amber:C.sec, fontSize: 12 }}>{b.t}</td>
              {genKey && <td style={{ padding: "3px 4px", textAlign: "center", fontWeight: 600, color: C.cyan, fontSize: 11 }}>{b.gen}</td>}
              {days.map(fd => {
                const v = b.d?.[fd.d]||0; const gv = genKey&&b.g?b.g[fd.d]||0:0; const isPast = fd.d<=16; const isToday = fd.d===17;
                return (
                <td key={fd.d} style={{ padding: "2px 1px", textAlign: "center", background: isToday?C.cyan+"08":isPast?C.dim+"08":getBg(v), opacity: isPast?0.5:1 }}>
                  {genKey ? (
                    <div style={{ display: "flex", flexDirection: "column", alignItems: "center" }}>
                      {v>0 && <span style={{ display: "inline-block", width: 20, height: 16, lineHeight: "16px", borderRadius: 4, background: getColor(v), color: "#fff", fontSize: 10, fontWeight: 700 }}>{v}</span>}
                      {gv>0 && <span style={{ fontSize: 8, color: C.cyan, fontWeight: 600 }}>+{gv}</span>}
                      {v===0&&gv===0 && <span style={{ color: C.dim, fontSize: 9 }}>{String.fromCharCode(183)}</span>}
                    </div>
                  ) : (
                    v>0 ? <span style={{ display: "inline-block", width: 20, height: 20, lineHeight: "20px", borderRadius: 5, background: fd.d>=17?getColor(v):C.dim+"80", color: "#fff", fontSize: 10, fontWeight: 700 }}>{v}</span> : <span style={{ color: C.dim, fontSize: 9 }}>{String.fromCharCode(183)}</span>
                  )}
                </td>);
              })}
            </tr>
          ))}</tbody>
        </table>
      </div>
      {showLegend && <div style={{ fontSize: 10, color: C.dim, marginTop: 6, display: "flex", gap: 12 }}>
        <span><span style={{ display: "inline-block", width: 10, height: 10, borderRadius: 3, background: C.red, verticalAlign: "middle" }}/> 1</span>
        <span><span style={{ display: "inline-block", width: 10, height: 10, borderRadius: 3, background: C.amber, verticalAlign: "middle" }}/> 2-3</span>
        <span><span style={{ display: "inline-block", width: 10, height: 10, borderRadius: 3, background: C.green, verticalAlign: "middle" }}/> 4+</span>
        {genKey && <span><span style={{ color: C.cyan, fontWeight: 700 }}>+N</span> = generiert</span>}
        <span style={{ marginLeft: "auto" }}>Grau = vergangen {String.fromCharCode(183)} <span style={{ color: C.cyan }}>Blau</span> = heute</span>
      </div>}
    </Sec>
  );
};

// ═══ TAB: LIVE TICKER ═══
const TabLive = () => {
  const af = TICKER.filter(t=>t.st==="Ausgefallen").length;
  const sc = TICKER.filter(t=>t.sc).length;
  return (
    <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
      <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
        <KPI label="Termine Di 17.02." value={TICKER.length} sub={`${TICKER.length-af} aktiv ${String.fromCharCode(183)} ${af} ausgefallen`} color={C.cyan}/>
        <KPI label="Scout-Termine" value={sc} sub={`${TICKER.length-sc} Direkt`} color={C.purple}/>
        <KPI label="Ausgefallen" value={af} sub={`${pct(af,TICKER.length)}%`} color={C.red}/>
      </div>
      <Sec title={"📋 Live Ticker · Dienstag 17. Februar 2026"}>
        <div style={{ overflowX: "auto", borderRadius: 10, border: `1px solid ${C.border}` }}>
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11, minWidth: 700 }}>
            <thead><tr style={{ background: C.card }}>
              {["Zeit","Status","Berater (VB)","Typ","Quelle","Kunde","Scout"].map(h=>
                <th key={h} style={{ padding: "6px 6px", textAlign: "left", color: C.sec, fontWeight: 600, borderBottom: `2px solid ${C.border}`, fontSize: 10, textTransform: "uppercase" }}>{h}</th>
              )}
            </tr></thead>
            <tbody>{TICKER.map((t,i) => {
              const isAf = t.st==="Ausgefallen";
              return (
              <tr key={i} style={{ borderBottom: `1px solid ${C.border}10`, background: isAf?C.red+"06":i%2===0?"transparent":C.card+"60", opacity: isAf?0.5:1 }}>
                <td style={{ padding: "4px 6px", fontFamily: "'JetBrains Mono',monospace", fontWeight: 700, color: C.cyan, fontSize: 12, whiteSpace: "nowrap" }}>{t.h}{String.fromCharCode(8211)}{t.he}</td>
                <td style={{ padding: "4px 6px" }}>{isAf ? <Badge v="AUSGEF." color={C.red}/> : <Badge v="OFFEN" color={C.dim}/>}</td>
                <td style={{ padding: "4px 6px", fontWeight: 700, color: "#fff", whiteSpace: "nowrap" }}>{t.b}</td>
                <td style={{ padding: "4px 6px", color: C.sec, fontSize: 10 }}>{t.tt}</td>
                <td style={{ padding: "4px 6px" }}><Badge v={t.q} color={t.q==="MVPP"?C.green:t.q.includes("Enpal")?C.orange:t.q==="Omega"?C.blue:t.q==="SADD"?C.amber:t.q.includes("Eigen")?C.purple:C.sec}/></td>
                <td style={{ padding: "4px 6px", color: C.dim, fontSize: 11 }}>{t.k}</td>
                <td style={{ padding: "4px 6px", color: C.purple, fontSize: 10, fontWeight: t.sc?600:400 }}>{t.sc||String.fromCharCode(8211)}</td>
              </tr>);
            })}</tbody>
          </table>
        </div>
      </Sec>
    </div>
  );
};

// ═══ TAB: STUNDENPLAN ═══
const TabStundenplan = () => {
  const [pastSort, setPastSort] = useState({ k: "te", d: -1 });
  const sorted = useMemo(()=>[...VB_PAST].sort((a,b)=>(b[pastSort.k]-a[pastSort.k])*pastSort.d),[pastSort]);
  const doSort = (k)=>setPastSort(p=>({k,d:p.k===k?-p.d:-1}));
  const SH = ({k,children})=><th onClick={()=>doSort(k)} style={{padding:"6px 4px",textAlign:"right",color:pastSort.k===k?C.amber:C.sec,fontWeight:600,borderBottom:`2px solid ${C.border}`,fontSize:10,cursor:"pointer",textTransform:"uppercase",userSelect:"none"}}>{children}{pastSort.k===k?(pastSort.d===-1?" ↓":" ↑"):""}</th>;
  return (
  <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
    <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
      <KPI label="VB Terme Feb" value={VB_PLAN.reduce((a,b)=>a+b.t,0)} sub={`${VB_PLAN.length} Berater`} color={C.amber}/>
      <KPI label="Vergangenheit" value={PAST_SUMMARY.total} sub={`${PAST_SUMMARY.sf}SF ${PAST_SUMMARY.af}AF (${pct(PAST_SUMMARY.af,PAST_SUMMARY.total)}%)`} color={C.red}/>
      <KPI label="Scout Terme" value={SCOUT_PLAN.reduce((a,b)=>a+b.t,0)} sub={`${SCOUT_PLAN.length} Scouter`} color={C.green}/>
    </div>
    <Sec title="📊 Vergangenheit (01.\u201316. Feb)">
      <ResponsiveContainer width="100%" height={200}>
        <ComposedChart data={PAST_DAILY}>
          <CartesianGrid strokeDasharray="3 3" stroke={C.border}/><XAxis dataKey="d" tick={{fill:C.sec,fontSize:9}}/><YAxis tick={{fill:C.sec,fontSize:10}}/>
          <Tooltip content={<TT/>}/><Bar dataKey="sf" name="Stattgefunden" stackId="a" fill={C.green}/><Bar dataKey="af" name="Ausgefallen" stackId="a" fill={C.red} radius={[5,5,0,0]}/><Line dataKey="te" name="Total" stroke={C.amber} strokeWidth={2} dot={false}/>
        </ComposedChart>
      </ResponsiveContainer>
    </Sec>
    <Sec title="👤 VB Vergangenheit (sortierbar)">
      <div style={{ overflowX: "auto", borderRadius: 10, border: `1px solid ${C.border}` }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 11, minWidth: 700 }}>
          <thead><tr style={{ background: C.card }}>
            <th style={{padding:"6px 8px",textAlign:"left",color:C.sec,fontWeight:700,borderBottom:`2px solid ${C.border}`,position:"sticky",left:0,background:C.card,zIndex:2,minWidth:130}}>Berater</th>
            <SH k="te">Terme</SH><SH k="sf">SF</SH><SH k="af">AF</SH><SH k="afp">AF%</SH><SH k="ab">Abschl.</SH><SH k="wvl">WVL</SH>
            <th style={{padding:"6px 4px",textAlign:"center",color:C.sec,fontWeight:600,borderBottom:`2px solid ${C.border}`,fontSize:10}}>SF-Rate</th>
          </tr></thead>
          <tbody>{sorted.map((b,i) => {
            const sfRate = (b.sf+b.af)>0?(b.sf/(b.sf+b.af)*100):0;
            return (
            <tr key={i} style={{borderBottom:`1px solid ${C.border}10`,background:i%2===0?"transparent":C.card+"60"}}>
              <td style={{padding:"4px 8px",fontWeight:600,color:"#fff",position:"sticky",left:0,background:i%2===0?C.bg:C.card,zIndex:1}}>{b.n}</td>
              <td style={{padding:"4px 4px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace"}}>{b.te}</td>
              <td style={{padding:"4px 4px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",color:C.cyan}}>{b.sf}</td>
              <td style={{padding:"4px 4px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",color:C.red}}>{b.af}</td>
              <td style={{padding:"4px 4px",textAlign:"right"}}><Badge v={`${b.afp}%`} color={b.afp>=50?C.red:b.afp>=30?C.amber:C.green}/></td>
              <td style={{padding:"4px 4px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:b.ab>0?C.green:C.dim}}>{b.ab}</td>
              <td style={{padding:"4px 4px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",color:C.amber}}>{b.wvl}</td>
              <td style={{padding:"4px 4px",textAlign:"center"}}><div style={{background:(sfRate>=65?C.green:sfRate>=45?C.amber:C.red)+"15",borderRadius:6,padding:"2px 6px",display:"inline-block"}}><span style={{fontFamily:"'JetBrains Mono',monospace",fontWeight:700,fontSize:11,color:sfRate>=65?C.green:sfRate>=45?C.amber:C.red}}>{sfRate.toFixed(0)}%</span></div></td>
            </tr>);
          })}
          </tbody>
        </table>
      </div>
    </Sec>
    <ScheduleGrid data={VB_PLAN} days={FEB_DAYS} title="📅 Stundenplan Vertrieb" showLegend/>
    <ScheduleGrid data={SCOUT_PLAN} days={FEB_DAYS} genKey="g" title="📅 Stundenplan Scouts (Termine + Generiert)" showLegend/>
  </div>);
};

// ═══ TAB: OMEGA ═══
const TabOmega = () => (
  <div style={{ display: "flex", flexDirection: "column", gap: 18 }}>
    <div style={{ background: `linear-gradient(135deg,${C.blue}12,${C.purple}08)`, borderRadius: 14, padding: "16px 22px", border: `1px solid ${C.blue}25` }}>
      <span style={{ fontSize: 18, fontWeight: 800 }}>🌊 Omega Partner-Analyse</span>
      <div style={{ fontSize: 12, color: C.sec }}>Vladyslav: {OM.vladyslav} Termine {String.fromCharCode(183)} Feb 2026</div>
    </div>
    <div style={{ display: "flex", gap: 12, flexWrap: "wrap" }}>
      <KPI label="Terme erstellt" value={OM.created} sub={`Vlad: ${OM.vladyslav}`} color={C.blue}/>
      <KPI label="Stattgefunden" value={OM.stattgef} sub={`${OM.af} AF (${OM.afPct}%)`} color={C.cyan}/>
      <KPI label="Abschluss" value={OM.abschluss} sub={`${OM.abQuote}% Quote`} color={C.green}/>
      <KPI label="Sales aktiv" value={OM.salesAktiv} sub={`${eur(OM.netto)} Netto`} color={C.amber}/>
      <KPI label="Kosten est." value={eur(OM.kostenEst)} sub={`${eur(OM.kostenProSale)}/Sale`} color={C.red}/>
    </div>
    <Sec title="📊 Omega Termine/Tag">
      <ResponsiveContainer width="100%" height={200}>
        <ComposedChart data={OM.daily}><CartesianGrid strokeDasharray="3 3" stroke={C.border}/><XAxis dataKey="d" tick={{fill:C.sec,fontSize:9}}/><YAxis tick={{fill:C.sec,fontSize:10}}/><Tooltip content={<TT/>}/><Bar dataKey="v" name="Terme" fill={C.blue} radius={[5,5,0,0]}/><Bar dataKey="af" name="Ausgef." fill={C.red} radius={[5,5,0,0]}/></ComposedChart>
      </ResponsiveContainer>
    </Sec>
    <Sec title="📋 Abschlussstatus">
      <div style={{ display: "flex", alignItems: "center" }}>
        <ResponsiveContainer width="45%" height={180}><PieChart><Pie data={OM.closedStatus} cx="50%" cy="50%" outerRadius={70} innerRadius={30} dataKey="value" paddingAngle={1}>{OM.closedStatus.map((e,i)=><Cell key={i} fill={e.color}/>)}</Pie></PieChart></ResponsiveContainer>
        <div style={{ flex: 1, fontSize: 11 }}>{OM.closedStatus.map((s,i)=>(<div key={i} style={{display:"flex",justifyContent:"space-between",padding:"2px 0",borderBottom:`1px solid ${C.border}`}}><span style={{color:C.sec,display:"flex",alignItems:"center",gap:4}}><span style={{width:7,height:7,borderRadius:2,background:s.color,display:"inline-block"}}/>{s.name}</span><span style={{fontFamily:"'JetBrains Mono',monospace",fontWeight:600}}>{s.value}</span></div>))}</div>
      </div>
    </Sec>
    <Sec title="👤 VB-Performance">
      <div style={{ overflowX: "auto" }}>
        <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 12 }}>
          <thead><tr>{["Berater","Terme","SF","Abschl.","Quote","WVL"].map((h,i)=><th key={i} style={{padding:"7px 8px",textAlign:i>0?"right":"left",color:C.sec,fontWeight:600,borderBottom:`2px solid ${C.border}`,fontSize:10,textTransform:"uppercase"}}>{h}</th>)}</tr></thead>
          <tbody>{OM.vb.map((b,i)=>(<tr key={i} style={{background:i%2===0?"transparent":C.card+"60"}}><td style={{padding:"5px 8px",fontWeight:600,color:"#fff"}}>{b.n}</td><td style={{padding:"5px 8px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace"}}>{b.te}</td><td style={{padding:"5px 8px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",color:C.cyan}}>{b.sf}</td><td style={{padding:"5px 8px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontWeight:700}}>{b.ab}</td><td style={{padding:"5px 8px",textAlign:"right"}}><Badge v={`${b.q}%`} color={b.q>=30?C.green:b.q>=15?C.amber:C.red}/></td><td style={{padding:"5px 8px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",color:C.amber}}>{b.wvl}</td></tr>))}</tbody>
        </table>
      </div>
    </Sec>
    <Sec title={"💰 Sales ("+OM.salesAktiv+" aktiv)"}>
      <div style={{ display: "flex", flexWrap: "wrap", gap: 10 }}>{OM.sales.map((s,i)=>(<div key={i} style={{background:C.green+"10",border:`1px solid ${C.green}25`,borderRadius:10,padding:"10px 14px",minWidth:140}}><div style={{fontSize:11,fontWeight:700,color:"#fff"}}>{s.b}</div><div style={{fontSize:18,fontWeight:800,color:C.green,fontFamily:"'JetBrains Mono',monospace"}}>{eur(s.net)}</div><div style={{fontSize:10,color:C.dim}}>{s.da}</div></div>))}</div>
    </Sec>
  </div>
);


// ═══ MAIN ═══
const BeeDooDashboard = () => {
  const [tab, setTab] = useState("live");
  const tabs = [
    { key: "live", label: "🔴 Live", c: "#00FF88" },
    { key: "stundenplan", label: "📅 Stundenplan", c: C.cyan },
    { key: "overview", label: "📊 Übersicht", c: C.amber },
    { key: "sales", label: "💰 Sales", c: C.green },
    { key: "quellen", label: "📦 Quellen", c: C.amber },
    { key: "berater", label: "👤 Berater", c: C.amber },
    { key: "cc", label: "📞 Call Center", c: C.cyan },
    { key: "angestellte", label: "🏢 Angestellte", c: C.blue },
    { key: "scouter", label: "🏃 Scouter", c: C.green },
    { key: "analyse", label: "🔬 Analyse", c: C.pink },
    { key: "trend", label: "📈 Trend", c: C.purple },
    { key: "omega", label: "🌊 Omega", c: C.blue },
    { key: "enpal", label: "⚡ Enpal", c: C.orange },
  ];
  return (
    <div style={{ minHeight: "100vh", background: C.bg, color: C.text, fontFamily: "'Segoe UI', system-ui, sans-serif", padding: "20px 24px 60px" }}>
      <div style={{ marginBottom: 18 }}>
        <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
          <span style={{ fontSize: 26 }}>🐝</span>
          <h1 style={{ fontSize: 24, fontWeight: 800, margin: 0 }}>
            bee-doo <span style={{ color: C.amber }}>Reporting</span> <span style={{ fontSize: 14, fontWeight: 500, color: C.dim }}>Februar 2026</span>
          </h1>
        </div>
        <div style={{ color: C.dim, fontSize: 12, marginLeft: 38 }}>
          {fmt(LEAD_STATS.total)} Leads · {fmt(TERME.kundenGesamt)} Terme · {TERME.stattBisGestern} SF · <span style={{ color: C.amber, fontWeight: 700 }}>{SALES.total} Brutto</span> / <span style={{ color: C.green, fontWeight: 700 }}>{SALES.aktiv} Netto ({pct(SALES.aktiv,TERME.stattBisGestern)}%)</span> · <span style={{ color: C.amber, fontWeight: 700 }}>{eur(SALES.nettoAktiv)}</span> · 16.02.2026
        </div>
      </div>
      <div style={{ display: "flex", gap: 3, marginBottom: 18, background: C.card, borderRadius: 10, padding: 3, border: `1px solid ${C.border}`, width: "fit-content", flexWrap: "wrap" }}>
        {tabs.map(t => (
          <button key={t.key} onClick={()=>setTab(t.key)} style={{
            padding: "8px 16px", borderRadius: 8, border: "none", cursor: "pointer",
            background: tab===t.key?t.c:"transparent",
            color: tab===t.key?"#06080F":C.sec, fontWeight: tab===t.key?800:500, fontSize: 13,
          }}>{t.label}</button>
        ))}
      </div>
      {tab==="live" && <TabLive/>}
      {tab==="stundenplan" && <TabStundenplan/>}
      {tab==="overview" && <TabOverview/>}
      {tab==="sales" && <TabSales/>}
      {tab==="quellen" && <TabQuellen/>}
      {tab==="berater" && <TabBerater/>}
      {tab==="cc" && <TabCC/>}
      {tab==="angestellte" && <TabAngestellte/>}
      {tab==="scouter" && <TabScouter/>}
      {tab==="analyse" && <TabAnalyse/>}
      {tab==="trend" && <TabTrend/>}
      {tab==="omega" && <TabOmega/>}
      {tab==="enpal" && <TabEnpal/>}
    </div>
  );
};

ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(BeeDooDashboard));

</script>

<script>
function _esc(s){if(!s)return'';var d=document.createElement('div');d.textContent=String(s);return d.innerHTML;}
</script>
<!-- bee-doo KI-Modul -->
<script>
const BEEDOO_AI = {
  API_URL: '/api/ai-proxy',
  // API_KEY: moved to server-side proxy
  MODEL: 'claude-sonnet-4-20250514',
  
  async call(systemPrompt, userMessage, maxTokens = 1500) {
    try {
      const res = await fetch(this.API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          model: this.MODEL,
          max_tokens: maxTokens,
          system: systemPrompt,
          messages: [{ role: 'user', content: userMessage }]
        })
      });
      if (!res.ok) { const err = await res.json(); throw new Error(err.error?.message || 'API Fehler'); }
      const data = await res.json();
      return data.content?.[0]?.text || '';
    } catch(e) { console.error('[bee-doo KI]', e); throw e; }
  },
  
  async callWithImage(systemPrompt, userMessage, base64, mediaType = 'image/jpeg', maxTokens = 1500) {
    try {
      const res = await fetch(this.API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          model: this.MODEL,
          max_tokens: maxTokens,
          system: systemPrompt,
          messages: [{ role: 'user', content: [
            { type: 'image', source: { type: 'base64', media_type: mediaType, data: base64 } },
            { type: 'text', text: userMessage }
          ] }]
        })
      });
      if (!res.ok) { const err = await res.json(); throw new Error(err.error?.message || 'API Fehler'); }
      const data = await res.json();
      return data.content?.[0]?.text || '';
    } catch(e) { console.error('[bee-doo KI]', e); throw e; }
  },
  
  safeHTML(str) { const d = document.createElement('div'); d.textContent = str; return d.innerHTML; },
  parseJSON(text) {
    try { return JSON.parse(text.replace(/```json|```/g, '').trim()); } catch(e) { return null; }
  }
};
</script>

<script>
window.BEEDOO_KI_REPORT = {
  async generateSummary() {
    const tables = document.querySelectorAll('table');
    const charts = document.querySelectorAll('canvas');
    let dataText = '';
    tables.forEach(t => dataText += t.textContent.substring(0, 1000) + '\n');
    
    const sys = `Du bist ein Business-Analyst für bee-doo GmbH (Solar-Vertrieb NRW). Erstelle einen Management-Report.
Antworte als JSON: {"headline":"...","kpis":[{"label":"...","value":"...","trend":"up/down/stable","comment":"..."}],"insights":["..."],"warnings":["..."],"action_items":["..."],"forecast":"..."}`;
    const result = await BEEDOO_AI.call(sys, `Analysiere diese Reporting-Daten und erstelle eine Zusammenfassung:\n${dataText.substring(0, 4000)}`);
    return BEEDOO_AI.parseJSON(result);
  },

  createButton() {
    const btn = document.createElement('button');
    btn.innerHTML = '🤖 KI-Report';
    btn.style.cssText = 'position:fixed;bottom:20px;right:20px;z-index:9999;background:linear-gradient(135deg,#F5C500,#E07800);color:#000;border:none;padding:12px 20px;border-radius:12px;font-weight:700;font-size:14px;cursor:pointer;box-shadow:0 4px 20px rgba(245,197,0,.3);font-family:inherit;transition:all .2s';
    btn.onclick = async () => {
      btn.innerHTML = '⏳ Generiere Report...';
      btn.disabled = true;
      try {
        const result = await this.generateSummary();
        if (result) this.showReport(result);
      } catch(e) { alert('KI-Fehler: ' + e.message); }
      btn.innerHTML = '🤖 KI-Report';
      btn.disabled = false;
    };
    document.body.appendChild(btn);
  },

  showReport(data) {
    let p = document.getElementById('beedoo-report-ai');
    if (!p) { p = document.createElement('div'); p.id = 'beedoo-report-ai'; p.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:560px;max-width:95vw;max-height:85vh;background:#111827;border:1px solid #F5C50040;border-radius:16px;z-index:9998;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.5);padding:24px'; document.body.appendChild(p); }
    let h = '<div style="display:flex;justify-content:space-between;margin-bottom:16px"><span style="font-weight:700;color:#F5C500;font-size:18px">📊 KI-Report</span><button onclick="this.parentElement.parentElement.remove()" style="background:none;border:none;color:#666;font-size:18px;cursor:pointer">✕</button></div>';
    h += '<div style="font-size:20px;font-weight:800;color:#fff;margin-bottom:16px">' + (data.headline || '') + '</div>';
    if (data.kpis?.length) {
      h += '<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:16px">';
      data.kpis.forEach(k => {
        const arrow = k.trend === 'up' ? '↑' : k.trend === 'down' ? '↓' : '→';
        const col = k.trend === 'up' ? '#34d399' : k.trend === 'down' ? '#f87171' : '#fbbf24';
        h += '<div style="background:#1e2235;padding:12px;border-radius:10px"><div style="font-size:10px;color:#9ca3af;text-transform:uppercase;letter-spacing:1px">' + _esc(k.label) + '</div><div style="font-size:22px;font-weight:800;color:#fff;margin:4px 0">' + _esc(k.value) + ' <span style="color:' + col + ';font-size:14px">' + arrow + '</span></div><div style="font-size:11px;color:#9ca3af">' + (k.comment || '') + '</div></div>';
      });
      h += '</div>';
    }
    if (data.insights?.length) { h += '<div style="font-weight:600;color:#F5C500;margin-bottom:6px">💡 Insights</div>'; data.insights.forEach(i => h += '<div style="font-size:13px;color:#d1d5db;margin-bottom:4px;padding-left:12px;border-left:2px solid #F5C50040">• ' + i + '</div>'); }
    if (data.warnings?.length) { h += '<div style="font-weight:600;color:#f87171;margin:10px 0 6px">⚠️ Warnungen</div>'; data.warnings.forEach(w => h += '<div style="font-size:13px;color:#fca5a5;margin-bottom:4px;padding-left:12px;border-left:2px solid #f87171">• ' + w + '</div>'); }
    if (data.action_items?.length) { h += '<div style="font-weight:600;color:#34d399;margin:10px 0 6px">✅ Maßnahmen</div>'; data.action_items.forEach(a => h += '<div style="font-size:13px;color:#6ee7b7;margin-bottom:4px;padding-left:12px;border-left:2px solid #34d399">• ' + a + '</div>'); }
    if (data.forecast) h += '<div style="margin-top:12px;background:#F5C50010;padding:12px;border-radius:10px;border:1px solid #F5C50020;color:#F5C500;font-size:13px">🔮 ' + _esc(data.forecast) + '</div>';
    p.innerHTML = h;
  }
};
document.addEventListener('DOMContentLoaded', () => setTimeout(() => BEEDOO_KI_REPORT.createButton(), 1000));
</script>

</body>
</html>