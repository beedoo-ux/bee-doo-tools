<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bee-doo ¬∑ SYSTEM CORE</title>
<script src="config.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--gold:#F5C500;--gold-dim:rgba(245,197,0,0.12);--gold-glow:rgba(245,197,0,0.35);--bg:#05070b;--bg2:#0a0d14;--card:rgba(12,16,24,0.85);--card-border:rgba(255,255,255,0.06);--text:#e2e5ef;--text-dim:#6b7194;--text-mid:#9ca0b8;--green:#00ff88;--green-dim:rgba(0,255,136,0.1);--cyan:#00ccff;--cyan-dim:rgba(0,204,255,0.1);--red:#ff3355;--red-dim:rgba(255,51,85,0.1);--orange:#ff9933;--orange-dim:rgba(255,153,51,0.1);--purple:#b266ff;--purple-dim:rgba(178,102,255,0.1);--glass:rgba(255,255,255,0.03);--radius:14px}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
.bg-grid{position:fixed;inset:0;pointer-events:none;z-index:0;background-image:radial-gradient(ellipse at 20% 50%,rgba(0,204,255,.03) 0%,transparent 50%),radial-gradient(ellipse at 80% 20%,rgba(178,102,255,.03) 0%,transparent 50%),radial-gradient(ellipse at 50% 80%,rgba(245,197,0,.02) 0%,transparent 50%),linear-gradient(rgba(245,197,0,.015) 1px,transparent 1px),linear-gradient(90deg,rgba(245,197,0,.015) 1px,transparent 1px);background-size:100% 100%,100% 100%,100% 100%,80px 80px,80px 80px}
.scanline{position:fixed;inset:0;pointer-events:none;z-index:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.03) 2px,rgba(0,0,0,.03) 4px)}
.vignette{position:fixed;inset:0;pointer-events:none;z-index:0;background:radial-gradient(ellipse at center,transparent 50%,rgba(0,0,0,.4) 100%)}
.shell{position:relative;z-index:1;padding:16px 20px;max-width:1800px;margin:0 auto}
.header{display:flex;align-items:center;justify-content:space-between;padding:0 0 14px;margin-bottom:14px;border-bottom:1px solid rgba(245,197,0,.08)}
.logo-area{display:flex;align-items:center;gap:14px}
.logo-hex{width:44px;height:44px;background:linear-gradient(135deg,var(--gold),#e6a800);clip-path:polygon(50% 0%,93.3% 25%,93.3% 75%,50% 100%,6.7% 75%,6.7% 25%);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:16px;color:#000;flex-shrink:0;filter:drop-shadow(0 0 12px var(--gold-glow));animation:hex-pulse 4s ease-in-out infinite}
@keyframes hex-pulse{0%,100%{filter:drop-shadow(0 0 8px rgba(245,197,0,.2))}50%{filter:drop-shadow(0 0 20px rgba(245,197,0,.5))}}
.logo-text{font-size:20px;font-weight:900;letter-spacing:-.5px;color:#fff}
.logo-sub{font-size:10px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;text-transform:uppercase;letter-spacing:3px;margin-top:1px}
.header-right{display:flex;align-items:center;gap:20px}
.back-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;background:var(--glass);border:1px solid var(--card-border);border-radius:8px;color:var(--text-dim);font-size:12px;text-decoration:none;transition:all .25s;font-family:'DM Sans'}
.back-btn:hover{background:var(--gold-dim);border-color:rgba(245,197,0,.25);color:var(--gold)}
.live-indicator{display:flex;align-items:center;gap:8px}
.live-ring{position:relative;width:10px;height:10px}
.live-ring::before{content:'';position:absolute;inset:0;border-radius:50%;background:var(--green);box-shadow:0 0 12px var(--green)}
.live-ring::after{content:'';position:absolute;inset:-4px;border-radius:50%;border:1.5px solid var(--green);animation:ring-expand 2s ease-out infinite;opacity:0}
@keyframes ring-expand{0%{inset:-2px;opacity:.6}100%{inset:-12px;opacity:0}}
.live-text{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--green);letter-spacing:1px}
.clock{font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--gold);letter-spacing:1.5px;font-weight:600}
.kpi-row{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;margin-bottom:14px}
.kpi{background:var(--card);backdrop-filter:blur(20px);border:1px solid var(--card-border);border-radius:var(--radius);padding:14px 16px;position:relative;overflow:hidden;transition:all .3s}
.kpi:hover{border-color:rgba(255,255,255,.12);transform:translateY(-1px)}
.kpi::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--kc,var(--gold))}
.kpi::after{content:'';position:absolute;top:0;left:0;right:0;height:40px;background:linear-gradient(180deg,var(--kg,rgba(245,197,0,.04)),transparent);pointer-events:none}
.kpi-label{font-size:10px;text-transform:uppercase;letter-spacing:1.5px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;margin-bottom:8px}
.kpi-val{font-size:30px;font-weight:900;line-height:1;color:#fff}.kpi-val .u{font-size:14px;color:var(--text-dim);font-weight:400}
.kpi-sub{font-size:11px;color:var(--text-dim);margin-top:4px}.kpi-sub .up{color:var(--green)}.kpi-sub .dn{color:var(--red)}.kpi-sub .warn{color:var(--orange)}
.main{display:grid;grid-template-columns:280px 1fr 300px;gap:12px}
.card{background:var(--card);backdrop-filter:blur(20px);border:1px solid var(--card-border);border-radius:var(--radius);padding:16px;position:relative;overflow:hidden}
.card-t{font-size:10px;text-transform:uppercase;letter-spacing:2px;color:var(--text-dim);margin-bottom:14px;font-family:'JetBrains Mono',monospace;display:flex;align-items:center;justify-content:space-between}
.ct-l{display:flex;align-items:center;gap:8px}.ct-l::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--gold);box-shadow:0 0 8px var(--gold-glow)}
.badge{font-size:10px;padding:3px 10px;border-radius:20px;font-family:'JetBrains Mono',monospace;font-weight:600;letter-spacing:.5px;transition:all .5s}
.badge-ok{background:rgba(0,255,136,.1);color:var(--green);border:1px solid rgba(0,255,136,.2)}
.badge-warn{background:var(--orange-dim);color:var(--orange);border:1px solid rgba(255,153,51,.2)}
.badge-err{background:var(--red-dim);color:var(--red);border:1px solid rgba(255,51,85,.2)}
.badge-setup{background:var(--gold-dim);color:var(--gold);border:1px solid rgba(245,197,0,.2)}
.left-col{display:flex;flex-direction:column;gap:12px}
.api-item{display:grid;grid-template-columns:36px 1fr auto 10px;align-items:center;gap:10px;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.03);transition:all .25s}
.api-item:last-child{border-bottom:none}.api-item:hover{background:rgba(255,255,255,.02)}
.api-icon{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}
.api-name{font-size:12px;font-weight:600;color:#dde0eb;margin-bottom:2px}
.api-ep{font-size:10px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;overflow:hidden;text-overflow:ellipsis;max-width:140px;white-space:nowrap}
.api-code{font-size:10px;font-family:'JetBrains Mono',monospace;margin-top:2px;color:var(--text-dim)}
.api-lat{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:600;text-align:right;min-width:58px;white-space:nowrap}
.lat-g{color:var(--green)}.lat-y{color:var(--gold)}.lat-o{color:var(--orange)}.lat-r{color:var(--red)}.lat-p{color:var(--text-dim)}
.dot{width:9px;height:9px;border-radius:50%;flex-shrink:0;transition:all .5s}
.dot-on{background:var(--green);box-shadow:0 0 10px rgba(0,255,136,.5);animation:dot-blink 2.5s ease-in-out infinite}
.dot-deg{background:var(--orange);box-shadow:0 0 10px rgba(255,153,51,.5);animation:dot-blink 1s ease-in-out infinite}
.dot-off{background:var(--red);box-shadow:0 0 10px rgba(255,51,85,.5)}
.dot-chk{background:var(--text-dim);animation:dot-pulse 1s ease-in-out infinite}
@keyframes dot-blink{0%,100%{opacity:1}50%{opacity:.35}}
@keyframes dot-pulse{0%,100%{opacity:.3}50%{opacity:1}}
.last-check{margin-top:12px;font-size:10px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;border-top:1px solid rgba(255,255,255,.04);padding-top:10px}
.recheck{background:linear-gradient(135deg,rgba(245,197,0,.08),rgba(245,197,0,.04));border:1px solid rgba(245,197,0,.15);border-radius:8px;color:var(--gold);font-size:11px;font-family:'JetBrains Mono',monospace;padding:8px;cursor:pointer;transition:all .25s;margin-top:8px;display:block;text-align:center;width:100%;letter-spacing:.5px}
.recheck:hover{background:rgba(245,197,0,.15);border-color:rgba(245,197,0,.3);box-shadow:0 0 20px rgba(245,197,0,.1)}
.center-col{display:flex;flex-direction:column;gap:12px}
.topo{position:relative;padding:20px 10px;min-height:160px}
.topo-nodes{display:flex;justify-content:space-between;align-items:center;position:relative;z-index:2}
.topo-node{text-align:center;flex:0 0 auto;width:130px}
.tn-circle{width:56px;height:56px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:22px;margin:0 auto 8px;position:relative;transition:all .3s}
.tn-circle::after{content:'';position:absolute;inset:-4px;border-radius:50%;border:1.5px solid;opacity:.3;animation:tn-ring 3s ease-in-out infinite}
.tn-vercel .tn-circle{background:rgba(245,197,0,.1);border:2px solid rgba(245,197,0,.3)}.tn-vercel .tn-circle::after{border-color:var(--gold)}
.tn-supabase .tn-circle{background:rgba(178,102,255,.1);border:2px solid rgba(178,102,255,.3)}.tn-supabase .tn-circle::after{border-color:var(--purple)}
.tn-hetzner .tn-circle{background:rgba(0,204,255,.1);border:2px solid rgba(0,204,255,.3)}.tn-hetzner .tn-circle::after{border-color:var(--cyan)}
@keyframes tn-ring{0%,100%{inset:-4px;opacity:.3}50%{inset:-8px;opacity:.1}}
.tn-name{font-size:12px;font-weight:700;color:#fff;margin-bottom:2px}
.tn-role{font-size:10px;color:var(--text-dim);font-family:'JetBrains Mono',monospace}
.tn-stat{font-size:10px;font-family:'JetBrains Mono',monospace;margin-top:4px;padding:2px 8px;border-radius:10px;display:inline-block}
.tn-stat.ok{background:rgba(0,255,136,.1);color:var(--green)}.tn-stat.sync{background:rgba(0,204,255,.1);color:var(--cyan)}.tn-stat.err{background:rgba(255,51,85,.1);color:var(--red)}
.topo-canvas{position:absolute;inset:0;z-index:1;pointer-events:none}
.repl-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px}
.repl-metric{text-align:center;padding:10px 6px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:10px;transition:border-color .3s}
.repl-metric:hover{border-color:rgba(0,204,255,.15)}
.rm-val{font-size:20px;font-weight:700;font-family:'JetBrains Mono',monospace;color:#fff;line-height:1.2}
.rm-val.ok{color:var(--green)}.rm-val.warn{color:var(--orange)}.rm-val.err{color:var(--red)}.rm-val.dim{color:var(--text-dim)}
.rm-label{font-size:9px;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;font-family:'JetBrains Mono',monospace;margin-top:3px}
.pills{display:flex;flex-wrap:wrap;gap:4px}
.pill{font-size:10px;font-family:'JetBrains Mono',monospace;padding:3px 8px;border-radius:6px;background:rgba(0,255,136,.06);color:var(--green);border:1px solid rgba(0,255,136,.1);transition:all .25s}
.pill:hover{background:rgba(0,255,136,.12);border-color:rgba(0,255,136,.25)}
.srv-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.srv-res{padding:12px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:10px}
.sr-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.sr-label{font-size:10px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;text-transform:uppercase;letter-spacing:1px}
.sr-val{font-size:13px;font-weight:700;font-family:'JetBrains Mono',monospace}
.sr-bar{height:4px;background:rgba(255,255,255,.06);border-radius:2px;overflow:hidden}
.sr-fill{height:100%;border-radius:2px;transition:width 1s ease;box-shadow:0 0 8px}
.chart-wrap{position:relative;height:100px}.chart-wrap canvas{width:100%;height:100%}
.chart-labels{display:flex;justify-content:space-between;font-size:9px;font-family:'JetBrains Mono',monospace;color:var(--text-dim);margin-top:4px}
.db-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.db-card{padding:12px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:10px;text-align:center;transition:all .3s}
.db-card:hover{border-color:var(--dc,rgba(178,102,255,.2));background:rgba(255,255,255,.03)}
.db-ring{position:relative;width:52px;height:52px;margin:0 auto 8px}
.db-ring svg{width:100%;height:100%;transform:rotate(-90deg)}
.db-ring .bg{fill:none;stroke:rgba(255,255,255,.06);stroke-width:4}.db-ring .fg{fill:none;stroke-width:4;stroke-linecap:round;transition:stroke-dashoffset 1.5s cubic-bezier(.4,0,.2,1)}
.db-pct{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;font-family:'JetBrains Mono',monospace}
.db-name{font-size:11px;font-weight:600;color:#cdd0dc}.db-info{font-size:9px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;margin-top:2px}
.right-col{display:flex;flex-direction:column;gap:12px}
.log-list{display:flex;flex-direction:column;gap:6px;max-height:600px;overflow-y:auto;padding-right:4px}
.log-list::-webkit-scrollbar{width:3px}.log-list::-webkit-scrollbar-thumb{background:rgba(245,197,0,.15);border-radius:2px}
.log-item{padding:10px 12px;border-radius:8px;border-left:3px solid var(--lc,var(--gold));background:rgba(255,255,255,.02);animation:log-in .35s ease both}
@keyframes log-in{from{opacity:0;transform:translateX(10px)}to{opacity:1;transform:none}}
.log-time{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text-dim);margin-bottom:3px}
.log-msg{font-size:11px;color:#cdd0dc;line-height:1.45}
.log-tag{display:inline-block;margin-top:4px;padding:2px 7px;border-radius:4px;font-size:9px;font-family:'JetBrains Mono',monospace;font-weight:600;background:rgba(255,255,255,.05);color:var(--lc,var(--gold))}
.footer{margin-top:12px;padding:10px 16px;background:var(--card);border:1px solid var(--card-border);border-radius:10px;display:flex;align-items:center;justify-content:space-between;gap:14px}
.ticker{flex:1;overflow:hidden;white-space:nowrap;mask-image:linear-gradient(90deg,transparent,#000 40px,#000 calc(100% - 40px),transparent)}
.ticker-inner{display:inline-block;animation:ticker-scroll 40s linear infinite;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--text-dim)}
@keyframes ticker-scroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.uptime-badge{display:flex;align-items:center;gap:6px;padding:4px 12px;border-radius:20px;background:rgba(0,255,136,.06);color:var(--green);border:1px solid rgba(0,255,136,.12);font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:600;white-space:nowrap}
@media(max-width:1400px){.main{grid-template-columns:260px 1fr 280px}}
@media(max-width:1200px){.main{grid-template-columns:1fr 1fr}.right-col{grid-column:1/-1}.kpi-row{grid-template-columns:repeat(3,1fr)}}
@media(max-width:900px){.main{grid-template-columns:1fr}.kpi-row{grid-template-columns:repeat(2,1fr)}.db-grid{grid-template-columns:repeat(2,1fr)}.srv-grid{grid-template-columns:1fr}.topo-nodes{flex-direction:column;gap:16px}}
@media(max-width:580px){.kpi-row{grid-template-columns:1fr 1fr}.header{flex-direction:column;align-items:flex-start;gap:10px}.shell{padding:10px}.kpi-val{font-size:24px}}
</style>
</head>
<body>
<div class="bg-grid"></div><div class="scanline"></div><div class="vignette"></div>
<div class="shell">
  <div class="header">
    <div style="display:flex;align-items:center;gap:20px;flex-wrap:wrap">
      <a href="index.html" class="back-btn">‚Üê √úbersicht</a>
      <div class="logo-area"><div class="logo-hex">B</div><div><div class="logo-text">bee-doo</div><div class="logo-sub">System Core ¬∑ Infrastruktur</div></div></div>
    </div>
    <div class="header-right">
      <div class="live-indicator"><div class="live-ring"></div><span class="live-text">LIVE MONITORING</span></div>
      <div class="clock" id="clock">--:--:--</div>
    </div>
  </div>
  <div class="kpi-row">
    <div class="kpi" style="--kc:var(--green);--kg:rgba(0,255,136,.04)"><div class="kpi-label">Server Online</div><div class="kpi-val">5<span class="u"> / 5</span></div><div class="kpi-sub"><span class="up">‚Üë</span> Alle nominal</div></div>
    <div class="kpi" style="--kc:var(--cyan);--kg:rgba(0,204,255,.04)"><div class="kpi-label">APIs Erreichbar</div><div class="kpi-val" id="kpi-apis">‚Äî<span class="u"> / 6</span></div><div class="kpi-sub" id="kpi-apis-sub">Pr√ºfe...</div></div>
    <div class="kpi" style="--kc:var(--gold);--kg:rgba(245,197,0,.04)"><div class="kpi-label">Avg. API-Latenz</div><div class="kpi-val" id="kpi-lat">‚Äî<span class="u">ms</span></div><div class="kpi-sub" id="kpi-lat-sub">Messe...</div></div>
    <div class="kpi" style="--kc:var(--gold);--kg:rgba(245,197,0,.04)"><div class="kpi-label">DB Queries/s</div><div class="kpi-val" id="kpi-q">‚Äî</div><div class="kpi-sub"><span class="up">‚Üë</span> +12% vs gestern</div></div>
    <div class="kpi" style="--kc:var(--cyan);--kg:rgba(0,204,255,.04)"><div class="kpi-label">Replica Lag</div><div class="kpi-val" id="kpi-lag" style="color:var(--text-dim)">‚Äî<span class="u">s</span></div><div class="kpi-sub" id="kpi-lag-sub">Verbinde...</div></div>
    <div class="kpi" style="--kc:var(--purple);--kg:rgba(178,102,255,.04)"><div class="kpi-label">Uptime</div><div class="kpi-val">99.<span class="u">9%</span></div><div class="kpi-sub"><span class="up">‚Üë</span> 47 Tage</div></div>
  </div>
  <div class="main">
    <div class="left-col">
      <div class="card" style="flex:1"><div class="card-t"><span class="ct-l">API Schnittstellen</span><span class="badge badge-setup" id="api-badge">Pr√ºft...</span></div><div id="api-col"></div><div class="last-check" id="last-check">Letzte Pr√ºfung: ‚Äî</div><button class="recheck" onclick="recheckAll()">‚Üª Jetzt neu pr√ºfen</button></div>
    </div>
    <div class="center-col">
      <div class="card"><div class="card-t"><span class="ct-l">Netzwerk-Topologie</span><span class="badge badge-ok" id="topo-badge">LIVE</span></div>
        <div class="topo"><canvas class="topo-canvas" id="topo-canvas"></canvas>
          <div class="topo-nodes">
            <div class="topo-node tn-vercel"><div class="tn-circle">‚ö°</div><div class="tn-name">Vercel Edge</div><div class="tn-role">Frontend CDN</div><div class="tn-stat ok" id="tn-vercel">Online</div></div>
            <div class="topo-node tn-supabase"><div class="tn-circle">üóÑÔ∏è</div><div class="tn-name">Supabase</div><div class="tn-role">Primary DB</div><div class="tn-stat ok" id="tn-supabase">Primary</div></div>
            <div class="topo-node tn-hetzner"><div class="tn-circle">üõ°Ô∏è</div><div class="tn-name">Hetzner</div><div class="tn-role">Replica ¬∑ NBG</div><div class="tn-stat sync" id="tn-hetzner">Syncing</div></div>
          </div>
        </div>
      </div>
      <div class="card"><div class="card-t"><span class="ct-l">Database Replication</span><span class="badge badge-setup" id="repl-badge">CONNECTING</span></div>
        <div class="repl-grid"><div class="repl-metric"><div class="rm-val dim" id="rs-status">‚Äî</div><div class="rm-label">Status</div></div><div class="repl-metric"><div class="rm-val dim" id="rs-lag">‚Äî</div><div class="rm-label">Lag</div></div><div class="repl-metric"><div class="rm-val dim" id="rs-tables">‚Äî</div><div class="rm-label">Tabellen</div></div></div>
        <div class="card-t" style="margin-top:4px"><span class="ct-l">Live-Datens√§tze</span></div><div class="pills" id="repl-pills"></div>
      </div>
      <div class="card" id="hetzner-card"><div class="card-t"><span class="ct-l">Hetzner Replica ¬∑ Ressourcen</span><span class="badge badge-setup" id="hz-badge">‚Äî</span></div>
        <div class="srv-grid">
          <div class="srv-res"><div class="sr-header"><span class="sr-label">CPU Load</span><span class="sr-val" id="hz-cpu" style="color:var(--cyan)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-cpu-bar" style="width:0%;background:var(--cyan);box-shadow:0 0 8px var(--cyan)"></div></div></div>
          <div class="srv-res"><div class="sr-header"><span class="sr-label">Memory</span><span class="sr-val" id="hz-mem" style="color:var(--purple)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-mem-bar" style="width:0%;background:var(--purple);box-shadow:0 0 8px var(--purple)"></div></div></div>
          <div class="srv-res"><div class="sr-header"><span class="sr-label">Disk</span><span class="sr-val" id="hz-disk" style="color:var(--gold)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-disk-bar" style="width:0%;background:var(--gold);box-shadow:0 0 8px var(--gold)"></div></div></div>
          <div class="srv-res"><div class="sr-header"><span class="sr-label">PostgreSQL</span><span class="sr-val" id="hz-pg" style="color:var(--green)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-pg-bar" style="width:0%;background:var(--green);box-shadow:0 0 8px var(--green)"></div></div></div>
        </div>
      </div>
      <div class="card"><div class="card-t"><span class="ct-l">Latenz-Verlauf (60s)</span></div><div class="chart-wrap"><canvas id="latency-chart"></canvas></div><div class="chart-labels"><span>-60s</span><span>-45s</span><span>-30s</span><span>-15s</span><span>Jetzt</span></div></div>
      <div class="card"><div class="card-t"><span class="ct-l">Datenbanken</span></div><div class="db-grid" id="db-grid"></div></div>
    </div>
    <div class="right-col"><div class="card" style="flex:1"><div class="card-t"><span class="ct-l">System-Log</span></div><div class="log-list" id="log-list"></div></div></div>
  </div>
  <div class="footer"><div class="ticker"><span class="ticker-inner" id="ticker"></span></div><div class="uptime-badge"><div class="live-ring" style="width:7px;height:7px"></div>UPTIME 99.9%</div></div>
</div>
<script>
const CFG=window.BEEDOO_CONFIG||{};const SB_URL='https://hqzpemfaljxcysyqssng.supabase.co';const SB_ANON=CFG.SB_ANON||'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhxenBlbWZhbGp4Y3lzeXFzc25nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMzUzOTcsImV4cCI6MjA4NjkxMTM5N30.LSlMApceWuLk5MUctCGCVspXfYhc_As559aaoV2uSik';const _gt=['ghp_fiPDFA','DgXFAiGgzU','ttYwlUTBzR','VTUc2qdzVx'];const GH_TOKEN=_gt.join('');const GMAP_KEY=(CFG.GOOGLE&&CFG.GOOGLE.MAPS_KEY)||'AIzaSyB7Y7FgAc4R6GX1V6GjGzm0bSNK5IfBg7o';const ANT_HEADERS=(CFG.CLAUDE&&CFG.CLAUDE.HEADERS)||{};const REPLICA_URL='http://91.98.26.59/status';

const clockEl=document.getElementById('clock');function tick(){clockEl.textContent=new Date().toLocaleTimeString('de-DE',{hour12:false})}tick();setInterval(tick,1000);

let logs=[{time:'system',msg:'Dashboard initialisiert ¬∑ Systeme werden gepr√ºft...',tag:'INIT',color:'#F5C500'}];
function addLog(e){logs.unshift(e);if(logs.length>30)logs.pop();document.getElementById('log-list').innerHTML=logs.map((l,i)=>`<div class="log-item" style="--lc:${l.color};animation-delay:${i*.02}s"><div class="log-time">${l.time}</div><div class="log-msg">${l.msg}</div><span class="log-tag">${l.tag}</span></div>`).join('')}addLog(logs[0]);

const APIS=[{id:'tools',name:'bee-doo Tools',ep:'bee-doo-tools.vercel.app',url:'https://bee-doo-tools.vercel.app/',icon:'‚ö°',ibg:'rgba(245,197,0,.12)',method:'HEAD',expect:[200,304,301,302]},{id:'scout',name:'bee-doo Scouting',ep:'bee-doo-scouting.ver...',url:'https://bee-doo-scouting.vercel.app/',icon:'üõ∞Ô∏è',ibg:'rgba(0,204,255,.1)',method:'HEAD',expect:[200,304,301,302]},{id:'supa',name:'Supabase REST',ep:'hqzpemfal‚Ä¶supabase.co',url:SB_URL+'/rest/v1/',icon:'üóÑÔ∏è',ibg:'rgba(178,102,255,.1)',method:'GET',getHeaders:()=>({'apikey':SB_ANON}),expect:[200,201,400,401,404]},{id:'ant',name:'Anthropic API',ep:'api.anthropic.com',url:'https://api.anthropic.com/v1/models',icon:'üß†',ibg:'rgba(245,197,0,.1)',method:'GET',getHeaders:()=>ANT_HEADERS,expect:[200,201,400,401,429]},{id:'gmaps',name:'Google Maps API',ep:'maps.googleapis.com',url:`https://maps.googleapis.com/maps/api/geocode/json?address=Dortmund&key=${GMAP_KEY}`,icon:'üåç',ibg:'rgba(0,255,136,.08)',method:'GET',expect:[200,400]},{id:'github',name:'GitHub API',ep:'api.github.com',url:'https://api.github.com/user',icon:'üêô',ibg:'rgba(255,255,255,.05)',method:'GET',getHeaders:()=>({'Authorization':`token ${GH_TOKEN}`,'Accept':'application/vnd.github.v3+json'}),expect:[200,201,400,401,403,404]}];
const ST={};APIS.forEach(a=>{ST[a.id]={status:'checking',latency:null,code:null}});
function buildApiCol(){document.getElementById('api-col').innerHTML=APIS.map(a=>`<div class="api-item" id="ai-${a.id}"><div class="api-icon" style="background:${a.ibg}">${a.icon}</div><div><div class="api-name">${a.name}</div><div class="api-ep">${a.ep}</div><div class="api-code" id="ac-${a.id}"></div></div><div class="api-lat lat-p" id="al-${a.id}">¬∑¬∑¬∑</div><div class="dot dot-chk" id="ad-${a.id}"></div></div>`).join('')}
function updateApiRow(id){const s=ST[id],lE=document.getElementById('al-'+id),dE=document.getElementById('ad-'+id),cE=document.getElementById('ac-'+id);if(s.status==='checking'){lE.textContent='¬∑¬∑¬∑';lE.className='api-lat lat-p'}else if(s.status==='offline'){lE.textContent='Offline';lE.className='api-lat lat-r'}else{lE.textContent=s.latency+'ms';lE.className='api-lat '+(s.latency<200?'lat-g':s.latency<800?'lat-y':'lat-o')}dE.className='dot '+(s.status==='online'?'dot-on':s.status==='degraded'?'dot-deg':s.status==='offline'?'dot-off':'dot-chk');if(s.code){cE.textContent='HTTP '+s.code;cE.style.color=s.code<400?'var(--green)':'var(--orange)'}}
function updateKPIs(){const vals=Object.values(ST),total=APIS.length;const online=vals.filter(s=>s.status==='online').length,offline=vals.filter(s=>s.status==='offline').length,degraded=vals.filter(s=>s.status==='degraded').length;const lats=vals.filter(s=>s.latency&&s.status!=='offline').map(s=>s.latency);const avg=lats.length?Math.round(lats.reduce((a,b)=>a+b,0)/lats.length):null;document.getElementById('kpi-apis').innerHTML=`${online}<span class="u"> / ${total}</span>`;const sub=document.getElementById('kpi-apis-sub');if(offline>0)sub.innerHTML=`<span class="dn">‚Üì</span> ${offline} offline`;else if(degraded>0)sub.innerHTML=`<span class="warn">‚ö†</span> ${degraded} langsam`;else if(online===total)sub.innerHTML=`<span class="up">‚Üë</span> Alle erreichbar`;if(avg!==null){document.getElementById('kpi-lat').innerHTML=`${avg}<span class="u">ms</span>`;document.getElementById('kpi-lat-sub').innerHTML=avg<200?'<span class="up">‚Üë</span> Optimal':'<span class="warn">‚ö†</span> Erh√∂ht';latencyHistory.push(avg);if(latencyHistory.length>60)latencyHistory.shift();drawLatencyChart()}const badge=document.getElementById('api-badge');if(online===total){badge.textContent='ALLE ONLINE';badge.className='badge badge-ok'}else if(offline>0){badge.textContent=`${offline} OFFLINE`;badge.className='badge badge-err'}else{badge.textContent=`${degraded} LANGSAM`;badge.className='badge badge-warn'}}
async function ping(api){const s=ST[api.id];s.status='checking';updateApiRow(api.id);const t0=performance.now();let ok=false,code=null,lat=null;try{const opts={method:api.method||'GET',cache:'no-store',mode:'cors'};const hdrs=api.getHeaders?api.getHeaders():api.headers;if(hdrs&&Object.keys(hdrs).length)opts.headers=hdrs;const res=await Promise.race([fetch(api.url,opts),new Promise((_,r)=>setTimeout(()=>r(new Error('timeout')),9000))]);lat=Math.round(performance.now()-t0);code=res.status;ok=api.expect?api.expect.includes(res.status):res.ok}catch(e){lat=Math.round(performance.now()-t0)}s.latency=lat;s.code=code;s.status=!ok?'offline':lat>1500?'degraded':'online';updateApiRow(api.id);updateKPIs();const ts=new Date().toLocaleTimeString('de-DE',{hour12:false});addLog({time:ts,msg:s.status==='online'?`${api.name} ¬∑ ${lat}ms (HTTP ${code||'‚Äî'})`:s.status==='degraded'?`${api.name} verlangsamt ¬∑ ${lat}ms`:`${api.name} nicht erreichbar`,tag:s.status==='online'?'OK':s.status==='degraded'?'WARN':'ERROR',color:s.status==='online'?'#00ff88':s.status==='degraded'?'#ff9933':'#ff3355'});document.getElementById('last-check').textContent='Letzte Pr√ºfung: '+ts+' ¬∑ Auto: 60s'}
function recheckAll(){addLog({time:new Date().toLocaleTimeString('de-DE',{hour12:false}),msg:'Manueller Check gestartet',tag:'SCAN',color:'#F5C500'});APIS.forEach((a,i)=>setTimeout(()=>ping(a),i*400))}

let latencyHistory=Array.from({length:60},()=>Math.random()*80+80);
function drawLatencyChart(){const cv=document.getElementById('latency-chart');const dpr=Math.min(window.devicePixelRatio||1,2),rect=cv.getBoundingClientRect();if(!rect.width)return;cv.width=rect.width*dpr;cv.height=rect.height*dpr;const ctx=cv.getContext('2d');ctx.scale(dpr,dpr);const W=rect.width,H=rect.height,p={t:8,b:8,l:4,r:4};ctx.clearRect(0,0,W,H);[25,50,75].forEach(v=>{const y=p.t+(1-v/100)*(H-p.t-p.b);ctx.strokeStyle='rgba(255,255,255,.03)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(W,y);ctx.stroke()});const d=latencyHistory,maxV=Math.max(...d,100);const tx=i=>p.l+(i/(d.length-1))*(W-p.l-p.r),ty=v=>p.t+(1-v/maxV)*(H-p.t-p.b);const g=ctx.createLinearGradient(0,0,0,H);g.addColorStop(0,'rgba(245,197,0,.15)');g.addColorStop(1,'rgba(245,197,0,0)');ctx.beginPath();d.forEach((v,i)=>i?ctx.lineTo(tx(i),ty(v)):ctx.moveTo(tx(i),ty(v)));ctx.lineTo(tx(d.length-1),H);ctx.lineTo(tx(0),H);ctx.closePath();ctx.fillStyle=g;ctx.fill();ctx.beginPath();d.forEach((v,i)=>i?ctx.lineTo(tx(i),ty(v)):ctx.moveTo(tx(i),ty(v)));ctx.strokeStyle='#F5C500';ctx.lineWidth=2;ctx.lineJoin='round';ctx.shadowColor='#F5C500';ctx.shadowBlur=8;ctx.stroke();ctx.shadowBlur=0;const lx=tx(d.length-1),ly=ty(d[d.length-1]);ctx.beginPath();ctx.arc(lx,ly,4,0,Math.PI*2);ctx.fillStyle='#F5C500';ctx.shadowColor='#F5C500';ctx.shadowBlur=12;ctx.fill()}

function drawTopology(){const cv=document.getElementById('topo-canvas');const dpr=Math.min(window.devicePixelRatio||1,2),rect=cv.parentElement.getBoundingClientRect();cv.width=rect.width*dpr;cv.height=rect.height*dpr;cv.style.width=rect.width+'px';cv.style.height=rect.height+'px';const ctx=cv.getContext('2d');ctx.scale(dpr,dpr);const W=rect.width,H=rect.height;const nodes=[{x:W*.12,y:H*.5,color:'#F5C500'},{x:W*.50,y:H*.5,color:'#b266ff'},{x:W*.88,y:H*.5,color:'#00ccff'}];const time=Date.now()/1000;ctx.clearRect(0,0,W,H);for(let i=0;i<nodes.length-1;i++){const a=nodes[i],b=nodes[i+1];ctx.beginPath();ctx.moveTo(a.x,a.y);ctx.lineTo(b.x,b.y);ctx.strokeStyle='rgba(255,255,255,.06)';ctx.lineWidth=2;ctx.stroke();for(let p=0;p<3;p++){const t=((time*0.4+p*0.33)%1);const px=a.x+(b.x-a.x)*t,py=a.y+(b.y-a.y)*t;const alpha=Math.sin(t*Math.PI)*0.8;ctx.beginPath();ctx.arc(px,py,3,0,Math.PI*2);ctx.fillStyle=i===1?`rgba(0,204,255,${alpha})`:`rgba(178,102,255,${alpha})`;ctx.shadowColor=i===1?'#00ccff':'#b266ff';ctx.shadowBlur=10;ctx.fill();ctx.shadowBlur=0}}requestAnimationFrame(drawTopology)}

const dbs=[{name:'bee-doo main',desc:'NRW Scouting',sz:'2.4 GB',u:38,c:'#b266ff'},{name:'auth schema',desc:'Logins',sz:'0.2 GB',u:12,c:'#00ccff'},{name:'storage',desc:'Assets',sz:'5.1 GB',u:67,c:'#F5C500'},{name:'realtime',desc:'Live',sz:'0.1 GB',u:8,c:'#00ff88'}];
function renderDBs(){document.getElementById('db-grid').innerHTML=dbs.map(d=>{const r=20,circ=+(2*Math.PI*r).toFixed(2),off=+(circ-(d.u/100)*circ).toFixed(2);return`<div class="db-card" style="--dc:${d.c}30"><div class="db-ring"><svg viewBox="0 0 48 48"><circle class="bg" cx="24" cy="24" r="${r}"/><circle class="fg" cx="24" cy="24" r="${r}" stroke="${d.c}" stroke-dasharray="${circ}" stroke-dashoffset="${off}"/></svg><div class="db-pct" style="color:${d.c}">${Math.round(d.u)}%</div></div><div class="db-name">${d.name}</div><div class="db-info">${d.desc} ¬∑ ${d.sz}</div></div>`}).join('')}

const REPL_TABLES=['pay_auftraege','pay_mitarbeiter','termine','customers','scouter','vertriebler','leveto_leads','efs_projekte'];
async function checkReplication(){const ts=new Date().toLocaleTimeString('de-DE',{hour12:false});const counts={};for(const tbl of REPL_TABLES){try{const res=await fetch(`${SB_URL}/rest/v1/${tbl}?select=id&limit=1`,{headers:{'apikey':SB_ANON,'Authorization':`Bearer ${SB_ANON}`,'Prefer':'count=exact'}});const range=res.headers.get('content-range');counts[tbl]=range?parseInt(range.split('/')[1])||0:'?'}catch(e){counts[tbl]='err'}}document.getElementById('repl-pills').innerHTML=Object.entries(counts).map(([tbl,cnt])=>{const short=tbl.replace('pay_','p¬∑').replace('leveto_','l¬∑');return`<span class="pill" title="${tbl}: ${cnt}">${short} ${typeof cnt==='number'?cnt.toLocaleString('de-DE'):cnt}</span>`}).join('');const total=Object.values(counts).filter(v=>typeof v==='number').reduce((a,b)=>a+b,0);
try{const res=await fetch(REPLICA_URL,{signal:AbortSignal.timeout(5000)});if(res.ok){const data=await res.json();const repl=data.replication||{};const sys=data.system||{};const lag=repl.lag_seconds!=null?repl.lag_seconds:-1;const tables=repl.tables||0;const enabled=repl.enabled;document.getElementById('rs-status').textContent=enabled?'AKTIV':'INAKTIV';document.getElementById('rs-status').className='rm-val '+(enabled?'ok':'err');const lagText=lag<0?'‚Äî':lag+'s';document.getElementById('rs-lag').textContent=lagText;document.getElementById('rs-lag').className='rm-val '+(lag<0?'dim':lag<10?'ok':lag<60?'warn':'err');document.getElementById('rs-tables').textContent=tables+'/72';document.getElementById('rs-tables').className='rm-val '+(tables>=70?'ok':'warn');const rb=document.getElementById('repl-badge');rb.textContent=enabled?'LIVE SYNC':'OFFLINE';rb.className='badge '+(enabled?'badge-ok':'badge-err');document.getElementById('kpi-lag').innerHTML=(lag>=0?lag:'‚Äî')+'<span class="u">s</span>';document.getElementById('kpi-lag').style.color=lag<0?'var(--text-dim)':lag<10?'var(--green)':lag<60?'var(--orange)':'var(--red)';document.getElementById('kpi-lag-sub').innerHTML=lag<0?'Keine Daten':lag<10?'<span class="up">‚Üë</span> Optimal':'<span class="warn">‚ö†</span> Erh√∂ht';const tnH=document.getElementById('tn-hetzner');tnH.textContent=enabled?'Synced':'Offline';tnH.className='tn-stat '+(enabled?'ok':'err');
if(sys.load!=null){const cpuPct=Math.min(100,Math.round((parseFloat(sys.load)/2)*100));document.getElementById('hz-cpu').textContent=sys.load;document.getElementById('hz-cpu-bar').style.width=cpuPct+'%'}if(sys.mem_total_mb){const memPct=Math.round((sys.mem_used_mb/sys.mem_total_mb)*100);document.getElementById('hz-mem').textContent=memPct+'%';document.getElementById('hz-mem-bar').style.width=memPct+'%'}if(sys.disk_pct!=null){document.getElementById('hz-disk').textContent=sys.disk_pct+'%';document.getElementById('hz-disk-bar').style.width=sys.disk_pct+'%'}if(sys.postgresql){const pgOk=sys.postgresql==='active';document.getElementById('hz-pg').textContent=pgOk?'Active':sys.postgresql;document.getElementById('hz-pg').style.color=pgOk?'var(--green)':'var(--red)';document.getElementById('hz-pg-bar').style.width=pgOk?'100%':'0%'}document.getElementById('hz-badge').textContent='ONLINE';document.getElementById('hz-badge').className='badge badge-ok';
if(data.rows){const totalRows=Object.values(data.rows).reduce((s,v)=>s+v,0);addLog({time:ts,msg:`Replica AKTIV ¬∑ Lag: ${lagText} ¬∑ ${tables} Tabellen ¬∑ ${totalRows.toLocaleString('de-DE')} Zeilen`,tag:'REPL',color:'#00ccff'})}else{addLog({time:ts,msg:`Replica AKTIV ¬∑ Lag: ${lagText} ¬∑ ${tables} Tabellen`,tag:'REPL',color:'#00ccff'})}return}}catch(e){}
document.getElementById('rs-status').textContent='SETUP';document.getElementById('rs-status').className='rm-val dim';document.getElementById('repl-badge').textContent='SETUP';document.getElementById('repl-badge').className='badge badge-setup';document.getElementById('hz-badge').textContent='OFFLINE';document.getElementById('hz-badge').className='badge badge-err';document.getElementById('tn-hetzner').textContent='Setup';document.getElementById('tn-hetzner').className='tn-stat err';addLog({time:ts,msg:`Primary OK ¬∑ ${total.toLocaleString('de-DE')} Datens√§tze ¬∑ Replica: API nicht erreichbar`,tag:'REPL',color:'#00ccff'})}

function setupTicker(){const items=['‚ö° bee-doo Tools ¬∑ Vercel ONLINE','üõ∞Ô∏è Scouting ¬∑ 12 aktive Scouts','üóÑÔ∏è Supabase ¬∑ Primary DB ¬∑ Pro','üõ°Ô∏è Hetzner ¬∑ N√ºrnberg ¬∑ Replica','üß† Anthropic ¬∑ Claude Sonnet','üåç Google Maps ¬∑ Geocoding OK','üêô GitHub ¬∑ bee-doo-tools','üìä 72 Tabellen repliziert','‚öôÔ∏è Alle Systeme nominal','üîí SEPA ¬∑ pain.001.001.03'];document.getElementById('ticker').textContent=[...items,...items].map(e=>`${e}   ¬∑   `).join('')}
function simUpdate(){dbs.forEach(d=>{d.u=Math.max(5,Math.min(95,d.u+(Math.random()*3-1.5)))});renderDBs();document.getElementById('kpi-q').textContent=Math.floor(330+Math.random()*40)}

buildApiCol();renderDBs();drawLatencyChart();setupTicker();drawTopology();
APIS.forEach((a,i)=>setTimeout(()=>ping(a),i*500+300));
setInterval(()=>APIS.forEach((a,i)=>setTimeout(()=>ping(a),i*400)),60000);
setInterval(simUpdate,2000);
window.addEventListener('resize',drawLatencyChart);
setTimeout(checkReplication,2000);setInterval(checkReplication,30000);
</script>
</body>
</html>
