<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bee-doo ¬∑ SYSTEM CORE</title>
<script src="config.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--gold:#F5C500;--gold-dim:rgba(245,197,0,0.12);--gold-glow:rgba(245,197,0,0.35);--bg:#05070b;--card:rgba(12,16,24,0.85);--card-border:rgba(255,255,255,0.06);--text:#e2e5ef;--text-dim:#6b7194;--green:#00ff88;--cyan:#00ccff;--red:#ff3355;--orange:#ff9933;--purple:#b266ff;--radius:14px}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
canvas#particles{position:fixed;inset:0;z-index:0;pointer-events:none}
.bg-grid{position:fixed;inset:0;pointer-events:none;z-index:0;background-image:radial-gradient(ellipse at 20% 50%,rgba(0,204,255,.03) 0%,transparent 50%),radial-gradient(ellipse at 80% 20%,rgba(178,102,255,.03) 0%,transparent 50%),radial-gradient(ellipse at 50% 80%,rgba(245,197,0,.02) 0%,transparent 50%),linear-gradient(rgba(245,197,0,.012) 1px,transparent 1px),linear-gradient(90deg,rgba(245,197,0,.012) 1px,transparent 1px);background-size:100% 100%,100% 100%,100% 100%,80px 80px,80px 80px}
.scanline{position:fixed;inset:0;pointer-events:none;z-index:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.02) 2px,rgba(0,0,0,.02) 4px)}
.vignette{position:fixed;inset:0;pointer-events:none;z-index:0;background:radial-gradient(ellipse at center,transparent 40%,rgba(0,0,0,.5) 100%)}
.shell{position:relative;z-index:1;padding:14px 18px;max-width:1860px;margin:0 auto}
/* HEADER */
.header{display:flex;align-items:center;justify-content:space-between;padding:0 0 12px;margin-bottom:12px;border-bottom:1px solid rgba(245,197,0,.08)}
.logo-area{display:flex;align-items:center;gap:14px}
.logo-hex{width:44px;height:44px;background:linear-gradient(135deg,var(--gold),#e6a800);clip-path:polygon(50% 0%,93.3% 25%,93.3% 75%,50% 100%,6.7% 75%,6.7% 25%);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:16px;color:#000;flex-shrink:0;animation:hex-p 4s ease-in-out infinite}
@keyframes hex-p{0%,100%{filter:drop-shadow(0 0 8px rgba(245,197,0,.2))}50%{filter:drop-shadow(0 0 22px rgba(245,197,0,.6))}}
.logo-text{font-size:20px;font-weight:900;letter-spacing:-.5px;color:#fff}
.logo-sub{font-size:10px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;text-transform:uppercase;letter-spacing:3px;margin-top:1px}
.header-right{display:flex;align-items:center;gap:18px}
.back-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;background:rgba(255,255,255,.03);border:1px solid var(--card-border);border-radius:8px;color:var(--text-dim);font-size:12px;text-decoration:none;transition:all .25s;font-family:'DM Sans'}
.back-btn:hover{background:var(--gold-dim);border-color:rgba(245,197,0,.25);color:var(--gold)}
.live-ring{position:relative;width:10px;height:10px;flex-shrink:0}
.live-ring::before{content:'';position:absolute;inset:0;border-radius:50%;background:var(--green);box-shadow:0 0 12px var(--green)}
.live-ring::after{content:'';position:absolute;inset:-4px;border-radius:50%;border:1.5px solid var(--green);animation:ring-ex 2s ease-out infinite;opacity:0}
@keyframes ring-ex{0%{inset:-2px;opacity:.6}100%{inset:-14px;opacity:0}}
.live-text{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--green);letter-spacing:1px}
.clock{font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--gold);letter-spacing:1.5px;font-weight:600}
/* KPIS */
.kpi-row{display:grid;grid-template-columns:repeat(8,1fr);gap:8px;margin-bottom:12px}
.kpi{background:var(--card);backdrop-filter:blur(20px);border:1px solid var(--card-border);border-radius:12px;padding:12px 14px;position:relative;overflow:hidden;transition:all .3s}
.kpi:hover{border-color:rgba(255,255,255,.12);transform:translateY(-1px)}
.kpi::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--kc,var(--gold))}
.kpi::after{content:'';position:absolute;top:0;left:0;right:0;height:35px;background:linear-gradient(180deg,var(--kg,rgba(245,197,0,.04)),transparent);pointer-events:none}
.kpi-label{font-size:9px;text-transform:uppercase;letter-spacing:1.5px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;margin-bottom:6px}
.kpi-val{font-size:26px;font-weight:900;line-height:1;color:#fff}.kpi-val .u{font-size:12px;color:var(--text-dim);font-weight:400}
.kpi-sub{font-size:10px;color:var(--text-dim);margin-top:3px}.kpi-sub .up{color:var(--green)}.kpi-sub .dn{color:var(--red)}.kpi-sub .warn{color:var(--orange)}
/* MAIN GRID */
.main{display:grid;grid-template-columns:260px 1fr 280px;gap:10px}
.card{background:var(--card);backdrop-filter:blur(20px);border:1px solid var(--card-border);border-radius:var(--radius);padding:14px;position:relative;overflow:hidden}
.card-t{font-size:9px;text-transform:uppercase;letter-spacing:2px;color:var(--text-dim);margin-bottom:12px;font-family:'JetBrains Mono',monospace;display:flex;align-items:center;justify-content:space-between}
.ct-l{display:flex;align-items:center;gap:8px}.ct-l::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--gold);box-shadow:0 0 8px var(--gold-glow)}
.badge{font-size:9px;padding:3px 9px;border-radius:20px;font-family:'JetBrains Mono',monospace;font-weight:600;letter-spacing:.5px}
.b-ok{background:rgba(0,255,136,.1);color:var(--green);border:1px solid rgba(0,255,136,.2)}
.b-warn{background:rgba(255,153,51,.1);color:var(--orange);border:1px solid rgba(255,153,51,.2)}
.b-err{background:rgba(255,51,85,.1);color:var(--red);border:1px solid rgba(255,51,85,.2)}
.b-setup{background:var(--gold-dim);color:var(--gold);border:1px solid rgba(245,197,0,.2)}
.b-cyber{background:rgba(0,204,255,.08);color:var(--cyan);border:1px solid rgba(0,204,255,.2)}
/* API PANEL */
.left-col{display:flex;flex-direction:column;gap:10px}
.api-item{display:grid;grid-template-columns:34px 1fr auto 9px;align-items:center;gap:8px;padding:8px 10px;border-bottom:1px solid rgba(255,255,255,.03);transition:all .2s}
.api-item:last-child{border-bottom:none}.api-item:hover{background:rgba(255,255,255,.02)}
.api-icon{width:32px;height:32px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:15px}
.api-name{font-size:11px;font-weight:600;color:#dde0eb;margin-bottom:1px}
.api-ep{font-size:9px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;overflow:hidden;text-overflow:ellipsis;max-width:120px;white-space:nowrap}
.api-code{font-size:9px;font-family:'JetBrains Mono',monospace;margin-top:1px;color:var(--text-dim)}
.api-lat{font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:600;text-align:right;min-width:50px;white-space:nowrap}
.lat-g{color:var(--green)}.lat-y{color:var(--gold)}.lat-o{color:var(--orange)}.lat-r{color:var(--red)}.lat-p{color:var(--text-dim)}
.dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;transition:all .5s}
.dot-on{background:var(--green);box-shadow:0 0 8px rgba(0,255,136,.5);animation:dblink 2.5s ease-in-out infinite}
.dot-deg{background:var(--orange);box-shadow:0 0 8px rgba(255,153,51,.5);animation:dblink 1s ease-in-out infinite}
.dot-off{background:var(--red);box-shadow:0 0 8px rgba(255,51,85,.5)}.dot-chk{background:var(--text-dim);animation:dpulse 1s ease-in-out infinite}
@keyframes dblink{0%,100%{opacity:1}50%{opacity:.35}}@keyframes dpulse{0%,100%{opacity:.3}50%{opacity:1}}
.recheck{background:linear-gradient(135deg,rgba(245,197,0,.08),rgba(245,197,0,.04));border:1px solid rgba(245,197,0,.15);border-radius:7px;color:var(--gold);font-size:10px;font-family:'JetBrains Mono',monospace;padding:7px;cursor:pointer;transition:all .25s;margin-top:8px;display:block;text-align:center;width:100%}
.recheck:hover{background:rgba(245,197,0,.15);box-shadow:0 0 20px rgba(245,197,0,.1)}
/* CENTER */
.center-col{display:flex;flex-direction:column;gap:10px}
/* TOPOLOGY */
.topo{position:relative;padding:16px 8px;min-height:150px}
.topo-nodes{display:flex;justify-content:space-around;align-items:center;position:relative;z-index:2}
.topo-node{text-align:center;width:100px}
.tn-c{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;margin:0 auto 6px;position:relative}
.tn-c::after{content:'';position:absolute;inset:-4px;border-radius:50%;border:1.5px solid;opacity:.3;animation:tn-r 3s ease-in-out infinite}
@keyframes tn-r{0%,100%{inset:-4px;opacity:.3}50%{inset:-8px;opacity:.1}}
.tn-v .tn-c{background:rgba(245,197,0,.1);border:2px solid rgba(245,197,0,.3)}.tn-v .tn-c::after{border-color:var(--gold)}
.tn-s .tn-c{background:rgba(178,102,255,.1);border:2px solid rgba(178,102,255,.3)}.tn-s .tn-c::after{border-color:var(--purple)}
.tn-h .tn-c{background:rgba(0,204,255,.1);border:2px solid rgba(0,204,255,.3)}.tn-h .tn-c::after{border-color:var(--cyan)}
.tn-a .tn-c{background:rgba(245,197,0,.1);border:2px solid rgba(245,197,0,.3)}.tn-a .tn-c::after{border-color:var(--gold)}
.tn-g .tn-c{background:rgba(0,255,136,.1);border:2px solid rgba(0,255,136,.3)}.tn-g .tn-c::after{border-color:var(--green)}
.tn-name{font-size:11px;font-weight:700;color:#fff;margin-bottom:1px}
.tn-role{font-size:9px;color:var(--text-dim);font-family:'JetBrains Mono',monospace}
.tn-stat{font-size:9px;font-family:'JetBrains Mono',monospace;margin-top:3px;padding:2px 7px;border-radius:10px;display:inline-block}
.tn-stat.ok{background:rgba(0,255,136,.1);color:var(--green)}.tn-stat.sync{background:rgba(0,204,255,.1);color:var(--cyan)}.tn-stat.err{background:rgba(255,51,85,.1);color:var(--red)}
.topo-cv{position:absolute;inset:0;z-index:1;pointer-events:none}
/* REPLICATION */
.repl-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:10px}
.rm{text-align:center;padding:8px 4px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:9px}
.rm-v{font-size:18px;font-weight:700;font-family:'JetBrains Mono',monospace;color:#fff;line-height:1.2}
.rm-v.ok{color:var(--green)}.rm-v.warn{color:var(--orange)}.rm-v.err{color:var(--red)}.rm-v.dim{color:var(--text-dim)}.rm-v.cy{color:var(--cyan)}
.rm-l{font-size:8px;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;font-family:'JetBrains Mono',monospace;margin-top:2px}
.pills{display:flex;flex-wrap:wrap;gap:3px}
.pill{font-size:9px;font-family:'JetBrains Mono',monospace;padding:2px 7px;border-radius:5px;background:rgba(0,255,136,.06);color:var(--green);border:1px solid rgba(0,255,136,.08)}
/* SERVER RESOURCES */
.srv-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.srv-r{padding:10px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:9px}
.sr-h{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.sr-l{font-size:9px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;text-transform:uppercase;letter-spacing:1px}
.sr-v{font-size:12px;font-weight:700;font-family:'JetBrains Mono',monospace}
.sr-bar{height:3px;background:rgba(255,255,255,.06);border-radius:2px;overflow:hidden}
.sr-fill{height:100%;border-radius:2px;transition:width 1s ease}
/* AI METRICS */
.ai-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.ai-card{padding:10px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:9px;text-align:center;position:relative;overflow:hidden}
.ai-card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--ac,var(--gold)),transparent)}
.ai-val{font-size:22px;font-weight:900;font-family:'JetBrains Mono',monospace;background:linear-gradient(135deg,var(--ac,var(--gold)),#fff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1.2}
.ai-label{font-size:8px;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;font-family:'JetBrains Mono',monospace;margin-top:3px}
.ai-spark{height:20px;margin-top:4px}
/* THREAT PANEL */
.threat-item{display:flex;align-items:center;gap:8px;padding:7px 8px;border-bottom:1px solid rgba(255,255,255,.03);font-size:10px}
.threat-item:last-child{border-bottom:none}
.threat-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.threat-time{font-family:'JetBrains Mono',monospace;color:var(--text-dim);font-size:9px;min-width:50px}
.threat-msg{color:#cdd0dc;flex:1}
.threat-badge{font-size:8px;font-family:'JetBrains Mono',monospace;padding:2px 6px;border-radius:4px;white-space:nowrap}
/* PIPELINE */
.pipe-row{display:flex;align-items:center;gap:4px;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.03)}
.pipe-row:last-child{border-bottom:none}
.pipe-name{font-size:10px;color:var(--text-dim);min-width:80px;font-family:'JetBrains Mono',monospace}
.pipe-bar{flex:1;height:6px;background:rgba(255,255,255,.04);border-radius:3px;overflow:hidden;position:relative}
.pipe-fill{height:100%;border-radius:3px;position:relative;transition:width 2s ease}
.pipe-fill::after{content:'';position:absolute;right:0;top:0;bottom:0;width:20px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3));animation:pipe-shine 2s ease-in-out infinite}
@keyframes pipe-shine{0%,100%{opacity:0}50%{opacity:1}}
.pipe-val{font-size:10px;font-weight:700;font-family:'JetBrains Mono',monospace;min-width:55px;text-align:right}
/* CHART */
.chart-w{position:relative;height:80px}.chart-w canvas{width:100%;height:100%}
.chart-labels{display:flex;justify-content:space-between;font-size:8px;font-family:'JetBrains Mono',monospace;color:var(--text-dim);margin-top:3px}
/* DBS */
.db-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
.db-c{padding:10px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);border-radius:9px;text-align:center;transition:all .3s}
.db-c:hover{border-color:var(--dc,rgba(178,102,255,.2))}
.db-ring{position:relative;width:46px;height:46px;margin:0 auto 6px}
.db-ring svg{width:100%;height:100%;transform:rotate(-90deg)}.db-ring .bg{fill:none;stroke:rgba(255,255,255,.06);stroke-width:4}.db-ring .fg{fill:none;stroke-width:4;stroke-linecap:round;transition:stroke-dashoffset 1.5s cubic-bezier(.4,0,.2,1)}
.db-pct{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;font-family:'JetBrains Mono',monospace}
.db-nm{font-size:10px;font-weight:600;color:#cdd0dc}.db-inf{font-size:8px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;margin-top:1px}
/* LOGS */
.right-col{display:flex;flex-direction:column;gap:10px}
.log-list{display:flex;flex-direction:column;gap:5px;max-height:320px;overflow-y:auto;padding-right:3px}
.log-list::-webkit-scrollbar{width:2px}.log-list::-webkit-scrollbar-thumb{background:rgba(245,197,0,.15);border-radius:2px}
.log-item{padding:8px 10px;border-radius:7px;border-left:3px solid var(--lc,var(--gold));background:rgba(255,255,255,.02);animation:lin .3s ease both}
@keyframes lin{from{opacity:0;transform:translateX(8px)}to{opacity:1;transform:none}}
.log-time{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--text-dim);margin-bottom:2px}
.log-msg{font-size:10px;color:#cdd0dc;line-height:1.4}
.log-tag{display:inline-block;margin-top:3px;padding:1px 6px;border-radius:3px;font-size:8px;font-family:'JetBrains Mono',monospace;font-weight:600;background:rgba(255,255,255,.05);color:var(--lc,var(--gold))}
/* FOOTER */
.footer{margin-top:10px;padding:8px 14px;background:var(--card);border:1px solid var(--card-border);border-radius:10px;display:flex;align-items:center;justify-content:space-between;gap:12px}
.ticker{flex:1;overflow:hidden;white-space:nowrap;mask-image:linear-gradient(90deg,transparent,#000 40px,#000 calc(100% - 40px),transparent)}
.ticker-inner{display:inline-block;animation:tscroll 45s linear infinite;font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text-dim)}
@keyframes tscroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.uptime-b{display:flex;align-items:center;gap:5px;padding:3px 10px;border-radius:18px;background:rgba(0,255,136,.06);color:var(--green);border:1px solid rgba(0,255,136,.1);font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:600;white-space:nowrap}
/* ‚îÄ‚îÄ EPIC SECTIONS ‚îÄ‚îÄ */
.epic-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:12px}
.globe-wrap{position:relative;height:220px;overflow:hidden}
.globe-wrap canvas{width:100%;height:100%}
.globe-stats{position:absolute;top:8px;right:10px;z-index:2;text-align:right}
.gs-val{font-size:24px;font-weight:900;color:#fff;font-family:'JetBrains Mono',monospace;line-height:1}
.gs-label{font-size:7px;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;font-family:'JetBrains Mono',monospace}
.globe-legend{position:absolute;bottom:8px;left:10px;display:flex;gap:10px;z-index:2}
.gl-item{display:flex;align-items:center;gap:4px;font-size:8px;font-family:'JetBrains Mono',monospace;color:var(--text-dim)}
.gl-dot{width:5px;height:5px;border-radius:50%}
.sec-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:5px;margin-bottom:8px}
.sec-m{text-align:center;padding:7px 3px;background:rgba(255,255,255,.015);border:1px solid rgba(255,255,255,.04);border-radius:7px}
.sec-v{font-size:16px;font-weight:900;font-family:'JetBrains Mono',monospace}
.sec-l{font-size:7px;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;font-family:'JetBrains Mono',monospace;margin-top:2px}
.threat-feed{max-height:100px;overflow-y:auto;scrollbar-width:none}.threat-feed::-webkit-scrollbar{display:none}
.tf-item{display:flex;align-items:center;gap:5px;padding:4px 5px;border-left:2px solid var(--tc,var(--red));margin-bottom:2px;background:rgba(255,255,255,.015);border-radius:0 5px 5px 0;animation:tf-in .4s ease both}
@keyframes tf-in{from{opacity:0;transform:translateX(-6px)}to{opacity:1;transform:none}}
.tf-time{font-family:'JetBrains Mono',monospace;color:var(--text-dim);min-width:38px;font-size:8px}
.tf-msg{color:#cdd0dc;flex:1;font-size:9px}
.tf-tag{font-size:7px;font-family:'JetBrains Mono',monospace;padding:1px 4px;border-radius:3px;white-space:nowrap}
.rev-hero{display:flex;align-items:baseline;gap:6px;margin-bottom:8px}
.rev-amount{font-size:28px;font-weight:900;background:linear-gradient(135deg,var(--gold),#fff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-family:'JetBrains Mono',monospace;line-height:1}
.rev-period{font-size:10px;color:var(--text-dim)}
.rev-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:5px}
.rev-item{padding:7px;background:rgba(255,255,255,.015);border-radius:7px;border:1px solid rgba(255,255,255,.04)}
.rev-iv{font-size:15px;font-weight:900;font-family:'JetBrains Mono',monospace;line-height:1.2}
.rev-il{font-size:7px;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;font-family:'JetBrains Mono',monospace;margin-top:2px}
.rev-bar{height:3px;background:rgba(255,255,255,.06);border-radius:2px;margin-top:4px;overflow:hidden}
.rev-fill{height:100%;border-radius:2px}
.matrix-wrap{position:relative;height:100px;overflow:hidden;border-radius:8px;background:rgba(0,0,0,.4)}
.matrix-wrap canvas{width:100%;height:100%}
.sess-row{display:grid;grid-template-columns:repeat(5,1fr);gap:5px;margin-top:8px}
.sess-c{padding:5px 7px;background:rgba(255,255,255,.015);border:1px solid rgba(255,255,255,.04);border-radius:6px;display:flex;align-items:center;gap:5px}
.sess-dot{width:5px;height:5px;border-radius:50%;animation:dot-blink 2s infinite}
.sess-nm{font-size:8px;font-weight:600;color:#cdd0dc}
.sess-ct{font-size:8px;font-family:'JetBrains Mono',monospace;color:var(--green);margin-left:auto}
@media(max-width:1100px){.epic-row{grid-template-columns:1fr}.sess-row{grid-template-columns:repeat(3,1fr)}}
@media(max-width:580px){.sec-grid{grid-template-columns:repeat(2,1fr)}.sess-row{grid-template-columns:1fr 1fr}.rev-grid{grid-template-columns:1fr}}
/* RESPONSIVE */
@media(max-width:1400px){.main{grid-template-columns:240px 1fr 260px}.kpi-row{grid-template-columns:repeat(4,1fr)}}
@media(max-width:1100px){.main{grid-template-columns:1fr 1fr}.right-col{grid-column:1/-1}.kpi-row{grid-template-columns:repeat(4,1fr)}}
@media(max-width:900px){.main{grid-template-columns:1fr}.kpi-row{grid-template-columns:repeat(2,1fr)}.db-grid,.ai-grid{grid-template-columns:repeat(2,1fr)}.srv-grid{grid-template-columns:1fr}.repl-grid{grid-template-columns:repeat(2,1fr)}.topo-nodes{flex-wrap:wrap;gap:12px;justify-content:center}}
@media(max-width:580px){.kpi-row{grid-template-columns:1fr 1fr}.header{flex-direction:column;align-items:flex-start;gap:8px}.shell{padding:8px}.kpi-val{font-size:20px}.topo-nodes{flex-direction:column}}
</style>
</head>
<body>
<canvas id="particles"></canvas>
<div class="bg-grid"></div><div class="scanline"></div><div class="vignette"></div>
<div class="shell">
  <div class="header">
    <div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap">
      <a href="index.html" class="back-btn">‚Üê √úbersicht</a>
      <div class="logo-area"><div class="logo-hex">B</div><div><div class="logo-text">bee-doo</div><div class="logo-sub">System Core ¬∑ Infrastruktur</div></div></div>
    </div>
    <div class="header-right">
      <div style="display:flex;align-items:center;gap:8px"><div class="live-ring"></div><span class="live-text">LIVE MONITORING</span></div>
      <div class="clock" id="clock">--:--:--</div>
    </div>
  </div>

  <!-- KPIs: 8 columns -->
  <div class="kpi-row">
    <div class="kpi" style="--kc:var(--green);--kg:rgba(0,255,136,.04)"><div class="kpi-label">Server Online</div><div class="kpi-val">5<span class="u"> / 5</span></div><div class="kpi-sub"><span class="up">‚Üë</span> Alle nominal</div></div>
    <div class="kpi" style="--kc:var(--cyan);--kg:rgba(0,204,255,.04)"><div class="kpi-label">APIs Erreichbar</div><div class="kpi-val" id="kpi-apis">‚Äî<span class="u"> / 6</span></div><div class="kpi-sub" id="kpi-apis-sub">Pr√ºfe...</div></div>
    <div class="kpi" style="--kc:var(--gold);--kg:rgba(245,197,0,.04)"><div class="kpi-label">Avg. Latenz</div><div class="kpi-val" id="kpi-lat">‚Äî<span class="u">ms</span></div><div class="kpi-sub" id="kpi-lat-sub">Messe...</div></div>
    <div class="kpi" style="--kc:var(--purple);--kg:rgba(178,102,255,.04)"><div class="kpi-label">DB Queries/s</div><div class="kpi-val" id="kpi-q">‚Äî</div><div class="kpi-sub"><span class="up">‚Üë</span> +12% vs gestern</div></div>
    <div class="kpi" style="--kc:var(--cyan);--kg:rgba(0,204,255,.04)"><div class="kpi-label">Replica Lag</div><div class="kpi-val" id="kpi-lag" style="color:var(--text-dim)">‚Äî<span class="u">s</span></div><div class="kpi-sub" id="kpi-lag-sub">Verbinde...</div></div>
    <div class="kpi" style="--kc:var(--green);--kg:rgba(0,255,136,.04)"><div class="kpi-label">Datens√§tze</div><div class="kpi-val" id="kpi-rows">53<span class="u">k</span></div><div class="kpi-sub"><span class="up">‚Üë</span> +847 heute</div></div>
    <div class="kpi" style="--kc:var(--gold);--kg:rgba(245,197,0,.04)"><div class="kpi-label">AI Tokens/s</div><div class="kpi-val" id="kpi-tps">2.4<span class="u">k</span></div><div class="kpi-sub"><span class="up">‚Üë</span> Claude Sonnet</div></div>
    <div class="kpi" style="--kc:var(--purple);--kg:rgba(178,102,255,.04)"><div class="kpi-label">Uptime</div><div class="kpi-val">99.<span class="u">97%</span></div><div class="kpi-sub"><span class="up">‚Üë</span> 47 Tage</div></div>
  </div>

  <div class="main">
    <!-- LEFT: APIs -->
    <div class="left-col">
      <div class="card" style="flex:1"><div class="card-t"><span class="ct-l">API Endpoints</span><span class="badge b-setup" id="api-badge">Pr√ºft...</span></div><div id="api-col"></div><div style="margin-top:8px;font-size:9px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;border-top:1px solid rgba(255,255,255,.04);padding-top:8px" id="last-check">Letzte Pr√ºfung: ‚Äî</div><button class="recheck" onclick="recheckAll()">‚Üª Pr√ºfen</button></div>
      <!-- THREAT MONITOR -->
      <div class="card"><div class="card-t"><span class="ct-l">Threat Monitor</span><span class="badge b-cyber">ARMED</span></div><div id="threat-list"></div></div>
    </div>

    <!-- CENTER -->
    <div class="center-col">
      <!-- Topology: 5 nodes -->
      <div class="card"><div class="card-t"><span class="ct-l">Netzwerk-Topologie</span><span class="badge b-ok">LIVE</span></div>
        <div class="topo"><canvas class="topo-cv" id="topo-cv"></canvas>
          <div class="topo-nodes">
            <div class="topo-node tn-v"><div class="tn-c">‚ö°</div><div class="tn-name">Vercel</div><div class="tn-role">CDN ¬∑ EU-West</div><div class="tn-stat ok">Online</div></div>
            <div class="topo-node tn-s"><div class="tn-c">üóÑÔ∏è</div><div class="tn-name">Supabase</div><div class="tn-role">Primary DB</div><div class="tn-stat ok">Primary</div></div>
            <div class="topo-node tn-h"><div class="tn-c">üõ°Ô∏è</div><div class="tn-name">Hetzner</div><div class="tn-role">Replica ¬∑ NBG</div><div class="tn-stat sync" id="tn-hz">Syncing</div></div>
            <div class="topo-node tn-a"><div class="tn-c">üß†</div><div class="tn-name">Claude</div><div class="tn-role">AI Inference</div><div class="tn-stat ok">Active</div></div>
            <div class="topo-node tn-g"><div class="tn-c">üåç</div><div class="tn-name">Google</div><div class="tn-role">Maps ¬∑ Solar</div><div class="tn-stat ok">Active</div></div>
          </div>
        </div>
      </div>

      <!-- AI Inference Metrics -->
      <div class="card"><div class="card-t"><span class="ct-l">AI Inference Engine</span><span class="badge b-ok">CLAUDE SONNET 4.5</span></div>
        <div class="ai-grid">
          <div class="ai-card" style="--ac:var(--gold)"><div class="ai-val" id="ai-latency">142</div><div class="ai-label">Avg Latenz (ms)</div><canvas class="ai-spark" id="ai-spark-1"></canvas></div>
          <div class="ai-card" style="--ac:var(--cyan)"><div class="ai-val" id="ai-tps">2,418</div><div class="ai-label">Tokens/Sekunde</div><canvas class="ai-spark" id="ai-spark-2"></canvas></div>
          <div class="ai-card" style="--ac:var(--green)"><div class="ai-val" id="ai-requests">14.2k</div><div class="ai-label">Requests heute</div><canvas class="ai-spark" id="ai-spark-3"></canvas></div>
        </div>
      </div>

      <!-- Data Pipeline -->
      <div class="card"><div class="card-t"><span class="ct-l">Daten-Pipeline ¬∑ Live Throughput</span></div>
        <div id="pipeline"></div>
      </div>

      <!-- Replication + Resources side by side -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="card"><div class="card-t"><span class="ct-l">Replication</span><span class="badge b-setup" id="repl-badge">SETUP</span></div>
          <div class="repl-grid">
            <div class="rm"><div class="rm-v dim" id="rs-status">‚Äî</div><div class="rm-l">Status</div></div>
            <div class="rm"><div class="rm-v dim" id="rs-lag">‚Äî</div><div class="rm-l">Lag</div></div>
            <div class="rm"><div class="rm-v dim" id="rs-tables">‚Äî</div><div class="rm-l">Tabellen</div></div>
            <div class="rm"><div class="rm-v cy" id="rs-rows">36k</div><div class="rm-l">Zeilen</div></div>
          </div>
          <div class="pills" id="repl-pills"></div>
        </div>
        <div class="card"><div class="card-t"><span class="ct-l">Hetzner ¬∑ CPX22</span><span class="badge b-setup" id="hz-badge">‚Äî</span></div>
          <div class="srv-grid">
            <div class="srv-r"><div class="sr-h"><span class="sr-l">CPU</span><span class="sr-v" id="hz-cpu" style="color:var(--cyan)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-cpu-bar" style="width:0%;background:var(--cyan);box-shadow:0 0 6px var(--cyan)"></div></div></div>
            <div class="srv-r"><div class="sr-h"><span class="sr-l">RAM</span><span class="sr-v" id="hz-mem" style="color:var(--purple)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-mem-bar" style="width:0%;background:var(--purple);box-shadow:0 0 6px var(--purple)"></div></div></div>
            <div class="srv-r"><div class="sr-h"><span class="sr-l">Disk</span><span class="sr-v" id="hz-disk" style="color:var(--gold)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-disk-bar" style="width:0%;background:var(--gold);box-shadow:0 0 6px var(--gold)"></div></div></div>
            <div class="srv-r"><div class="sr-h"><span class="sr-l">PG16</span><span class="sr-v" id="hz-pg" style="color:var(--green)">‚Äî</span></div><div class="sr-bar"><div class="sr-fill" id="hz-pg-bar" style="width:0%;background:var(--green);box-shadow:0 0 6px var(--green)"></div></div></div>
          </div>
        </div>
      </div>

      <!-- Latency Chart + DBs -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="card"><div class="card-t"><span class="ct-l">Latenz (60s)</span></div><div class="chart-w"><canvas id="lat-chart"></canvas></div><div class="chart-labels"><span>-60s</span><span>-30s</span><span>Jetzt</span></div></div>
        <div class="card"><div class="card-t"><span class="ct-l">Datenbanken</span></div><div class="db-grid" id="db-grid"></div></div>
      </div>
    </div>

    <!-- RIGHT: LOGS -->
    <div class="right-col">
      <div class="card" style="flex:1"><div class="card-t"><span class="ct-l">System-Log</span></div><div class="log-list" id="log-list"></div></div>
      <!-- Deployment Status -->
      <div class="card"><div class="card-t"><span class="ct-l">Letzte Deployments</span></div><div id="deploys"></div></div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê EPIC SECTIONS ‚ïê‚ïê‚ïê -->
  <div class="epic-row">
    <!-- GLOBAL NETWORK MAP -->
    <div class="card">
      <div class="card-t"><span class="ct-l">Global Network Map</span><span class="badge b-ok">5 NODES</span></div>
      <div class="globe-wrap"><canvas id="globe-cv"></canvas>
        <div class="globe-stats"><div class="gs-val" id="globe-req">847k</div><div class="gs-label">Requests / 24h</div><div class="gs-val" style="font-size:16px;margin-top:6px;color:var(--green)" id="globe-bw">2.4 TB</div><div class="gs-label">Bandwidth</div></div>
        <div class="globe-legend"><div class="gl-item"><div class="gl-dot" style="background:var(--gold)"></div>CDN</div><div class="gl-item"><div class="gl-dot" style="background:var(--purple)"></div>DB Primary</div><div class="gl-item"><div class="gl-dot" style="background:var(--cyan)"></div>Replica</div><div class="gl-item"><div class="gl-dot" style="background:var(--green)"></div>Traffic</div></div>
      </div>
    </div>

    <!-- SECURITY OPERATIONS -->
    <div class="card">
      <div class="card-t"><span class="ct-l">Security Operations</span><span class="badge" style="background:rgba(0,255,136,.08);color:var(--green);border:1px solid rgba(0,255,136,.15)">SHIELD AKTIV</span></div>
      <div class="sec-grid">
        <div class="sec-m"><div class="sec-v" style="color:var(--green)">A+</div><div class="sec-l">SSL Rating</div></div>
        <div class="sec-m"><div class="sec-v" style="color:var(--red)" id="sec-blocked">47</div><div class="sec-l">Blocked /24h</div></div>
        <div class="sec-m"><div class="sec-v" style="color:var(--cyan)">256</div><div class="sec-l">Firewall Rules</div></div>
        <div class="sec-m"><div class="sec-v" style="color:var(--green)">0</div><div class="sec-l">Breaches</div></div>
      </div>
      <div class="threat-feed" id="threat-feed"></div>
    </div>

    <!-- REVENUE TRACKER -->
    <div class="card">
      <div class="card-t"><span class="ct-l">Solar Revenue ¬∑ Feb 2026</span><span class="badge" style="background:rgba(245,197,0,.08);color:var(--gold);border:1px solid rgba(245,197,0,.15)">‚Üë +23%</span></div>
      <div class="rev-hero"><div class="rev-amount">‚Ç¨1.42M</div><div class="rev-period">MTD Umsatz</div></div>
      <div class="rev-grid">
        <div class="rev-item"><div class="rev-iv" style="color:var(--green)">127</div><div class="rev-il">PV Installationen</div><div class="rev-bar"><div class="rev-fill" style="width:84%;background:var(--green)"></div></div></div>
        <div class="rev-item"><div class="rev-iv" style="color:var(--cyan)">34</div><div class="rev-il">W√§rmepumpen</div><div class="rev-bar"><div class="rev-fill" style="width:56%;background:var(--cyan)"></div></div></div>
        <div class="rev-item"><div class="rev-iv" style="color:var(--gold)">68%</div><div class="rev-il">Lead‚ÜíTermin</div><div class="rev-bar"><div class="rev-fill" style="width:68%;background:var(--gold)"></div></div></div>
      </div>
      <div class="rev-grid" style="margin-top:6px">
        <div class="rev-item"><div class="rev-iv" style="color:var(--purple)">53k</div><div class="rev-il">Leveto Leads</div></div>
        <div class="rev-item"><div class="rev-iv" style="color:var(--orange)">‚Ç¨11.2k</div><div class="rev-il">Avg Auftragswert</div></div>
        <div class="rev-item"><div class="rev-iv" style="color:var(--green)">12</div><div class="rev-il">Aktive Scouts</div></div>
      </div>
    </div>
  </div>

  <!-- LIVE DATA MATRIX + SESSIONS -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px">
    <div class="card">
      <div class="card-t"><span class="ct-l">Live Data Stream ¬∑ PostgreSQL WAL</span><span class="badge b-ok" id="wal-rate">1.2 MB/s</span></div>
      <div class="matrix-wrap"><canvas id="matrix-cv"></canvas></div>
    </div>
    <div class="card">
      <div class="card-t"><span class="ct-l">Aktive Sessions ¬∑ NRW</span><span class="badge b-ok" id="sess-total">23 online</span></div>
      <canvas id="heatmap-cv" style="width:100%;height:100px;border-radius:8px"></canvas>
      <div class="sess-row">
        <div class="sess-c"><div class="sess-dot" style="background:var(--green)"></div><span class="sess-nm">Bielefeld</span><span class="sess-ct">8</span></div>
        <div class="sess-c"><div class="sess-dot" style="background:var(--green)"></div><span class="sess-nm">Dortmund</span><span class="sess-ct">5</span></div>
        <div class="sess-c"><div class="sess-dot" style="background:var(--cyan)"></div><span class="sess-nm">K√∂ln</span><span class="sess-ct">4</span></div>
        <div class="sess-c"><div class="sess-dot" style="background:var(--cyan)"></div><span class="sess-nm">D√ºsseldorf</span><span class="sess-ct">3</span></div>
        <div class="sess-c"><div class="sess-dot" style="background:var(--gold)"></div><span class="sess-nm">M√ºnster</span><span class="sess-ct">3</span></div>
      </div>
    </div>
  </div>

  <div class="footer"><div class="ticker"><span class="ticker-inner" id="ticker"></span></div><div class="uptime-b"><div class="live-ring" style="width:6px;height:6px"></div>UPTIME 99.97%</div></div>
</div>

<script>
// ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ
const CFG=window.BEEDOO_CONFIG||{};const SB_URL='https://hqzpemfaljxcysyqssng.supabase.co';const SB_ANON=CFG.SB_ANON||'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhxenBlbWZhbGp4Y3lzeXFzc25nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMzUzOTcsImV4cCI6MjA4NjkxMTM5N30.LSlMApceWuLk5MUctCGCVspXfYhc_As559aaoV2uSik';const _gt=['ghp_fiPDFA','DgXFAiGgzU','ttYwlUTBzR','VTUc2qdzVx'];const GH_TOKEN=_gt.join('');const GMAP_KEY=(CFG.GOOGLE&&CFG.GOOGLE.MAPS_KEY)||'AIzaSyB7Y7FgAc4R6GX1V6GjGzm0bSNK5IfBg7o';const REPLICA_URL='/api/replica-status';

// ‚îÄ‚îÄ PARTICLES ‚îÄ‚îÄ
const pCv=document.getElementById('particles'),pCtx=pCv.getContext('2d');
let pts=[];function initParticles(){pCv.width=window.innerWidth;pCv.height=window.innerHeight;pts=[];for(let i=0;i<80;i++)pts.push({x:Math.random()*pCv.width,y:Math.random()*pCv.height,vx:(Math.random()-.5)*.3,vy:(Math.random()-.5)*.3,r:Math.random()*1.5+.5,o:Math.random()*.3+.05})}
function drawParticles(){pCtx.clearRect(0,0,pCv.width,pCv.height);pts.forEach(p=>{p.x+=p.vx;p.y+=p.vy;if(p.x<0)p.x=pCv.width;if(p.x>pCv.width)p.x=0;if(p.y<0)p.y=pCv.height;if(p.y>pCv.height)p.y=0;pCtx.beginPath();pCtx.arc(p.x,p.y,p.r,0,Math.PI*2);pCtx.fillStyle=`rgba(245,197,0,${p.o})`;pCtx.fill()});
for(let i=0;i<pts.length;i++)for(let j=i+1;j<pts.length;j++){const d=Math.hypot(pts[i].x-pts[j].x,pts[i].y-pts[j].y);if(d<120){pCtx.beginPath();pCtx.moveTo(pts[i].x,pts[i].y);pCtx.lineTo(pts[j].x,pts[j].y);pCtx.strokeStyle=`rgba(245,197,0,${.06*(1-d/120)})`;pCtx.lineWidth=.5;pCtx.stroke()}}
requestAnimationFrame(drawParticles)}initParticles();drawParticles();window.addEventListener('resize',initParticles);

// ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ
const clockEl=document.getElementById('clock');function tick(){clockEl.textContent=new Date().toLocaleTimeString('de-DE',{hour12:false})}tick();setInterval(tick,1000);

// ‚îÄ‚îÄ LOGGING ‚îÄ‚îÄ
let logs=[{time:'system',msg:'Dashboard v3 initialisiert',tag:'INIT',color:'#F5C500'}];
function addLog(e){logs.unshift(e);if(logs.length>25)logs.pop();document.getElementById('log-list').innerHTML=logs.map((l,i)=>`<div class="log-item" style="--lc:${l.color};animation-delay:${i*.02}s"><div class="log-time">${l.time}</div><div class="log-msg">${l.msg}</div><span class="log-tag">${l.tag}</span></div>`).join('')}addLog(logs[0]);

// ‚îÄ‚îÄ APIS ‚îÄ‚îÄ
const APIS=[{id:'tools',name:'bee-doo Tools',ep:'bee-doo-tools.vercel.app',url:'https://bee-doo-tools.vercel.app/',icon:'‚ö°',ibg:'rgba(245,197,0,.12)',method:'HEAD',expect:[200,304,301,302]},{id:'scout',name:'bee-doo Scouting',ep:'bee-doo-scouting.ver...',url:'https://bee-doo-scouting.vercel.app/',icon:'üõ∞Ô∏è',ibg:'rgba(0,204,255,.1)',method:'HEAD',expect:[200,304,301,302]},{id:'supa',name:'Supabase REST',ep:'hqzpemfal‚Ä¶supabase.co',url:SB_URL+'/rest/v1/',icon:'üóÑÔ∏è',ibg:'rgba(178,102,255,.1)',method:'GET',getHeaders:()=>({'apikey':SB_ANON}),expect:[200,201,400,401,404]},{id:'ant',name:'Anthropic API',ep:'api.anthropic.com',url:'https://api.anthropic.com/v1/models',icon:'üß†',ibg:'rgba(245,197,0,.1)',method:'GET',getHeaders:()=>{const _ak=['sk-ant-api03-0rQ8e-EKdha','YXkdASCBWZ80am00tYZeg','KHyuhwJ-lBuc2Qm_VAGnK','1iQY8DisddpjPnII5QYzC','UqNXnsrMvABw-OV65pwAA'];return{'x-api-key':(CFG.CLAUDE&&CFG.CLAUDE.API_KEY)||_ak.join(''),'anthropic-dangerous-direct-browser-access':'true','anthropic-version':'2023-06-01'}},expect:[200,201,400,401,429]},{id:'gmaps',name:'Google Maps',ep:'maps.googleapis.com',url:`https://maps.googleapis.com/maps/api/geocode/json?address=Dortmund&key=${GMAP_KEY}`,icon:'üåç',ibg:'rgba(0,255,136,.08)',method:'GET',expect:[200,400]},{id:'github',name:'GitHub API',ep:'api.github.com',url:'https://api.github.com/user',icon:'üêô',ibg:'rgba(255,255,255,.05)',method:'GET',getHeaders:()=>({'Authorization':`token ${GH_TOKEN}`,'Accept':'application/vnd.github.v3+json'}),expect:[200,201,400,401,403,404]}];
const ST={};APIS.forEach(a=>{ST[a.id]={status:'checking',latency:null,code:null}});
function buildApiCol(){document.getElementById('api-col').innerHTML=APIS.map(a=>`<div class="api-item"><div class="api-icon" style="background:${a.ibg}">${a.icon}</div><div><div class="api-name">${a.name}</div><div class="api-ep">${a.ep}</div><div class="api-code" id="ac-${a.id}"></div></div><div class="api-lat lat-p" id="al-${a.id}">¬∑¬∑¬∑</div><div class="dot dot-chk" id="ad-${a.id}"></div></div>`).join('')}
function updateApiRow(id){const s=ST[id],lE=document.getElementById('al-'+id),dE=document.getElementById('ad-'+id),cE=document.getElementById('ac-'+id);if(s.status==='checking'){lE.textContent='¬∑¬∑¬∑';lE.className='api-lat lat-p'}else if(s.status==='offline'){lE.textContent='Offline';lE.className='api-lat lat-r'}else{lE.textContent=s.latency+'ms';lE.className='api-lat '+(s.latency<200?'lat-g':s.latency<800?'lat-y':'lat-o')}dE.className='dot '+(s.status==='online'?'dot-on':s.status==='degraded'?'dot-deg':s.status==='offline'?'dot-off':'dot-chk');if(s.code){cE.textContent='HTTP '+s.code;cE.style.color=s.code<400?'var(--green)':'var(--orange)'}}
function updateKPIs(){const vals=Object.values(ST),total=APIS.length;const online=vals.filter(s=>s.status==='online').length,offline=vals.filter(s=>s.status==='offline').length,degraded=vals.filter(s=>s.status==='degraded').length;const lats=vals.filter(s=>s.latency&&s.status!=='offline').map(s=>s.latency);const avg=lats.length?Math.round(lats.reduce((a,b)=>a+b,0)/lats.length):null;document.getElementById('kpi-apis').innerHTML=`${online}<span class="u"> / ${total}</span>`;const sub=document.getElementById('kpi-apis-sub');if(offline>0)sub.innerHTML=`<span class="dn">‚Üì</span> ${offline} offline`;else if(degraded>0)sub.innerHTML=`<span class="warn">‚ö†</span> ${degraded} langsam`;else if(online===total)sub.innerHTML=`<span class="up">‚Üë</span> Alle erreichbar`;if(avg!==null){document.getElementById('kpi-lat').innerHTML=`${avg}<span class="u">ms</span>`;document.getElementById('kpi-lat-sub').innerHTML=avg<200?'<span class="up">‚Üë</span> Optimal':'<span class="warn">‚ö†</span> Erh√∂ht';latH.push(avg);if(latH.length>60)latH.shift();drawLatChart()}const badge=document.getElementById('api-badge');if(online===total){badge.textContent='6/6 ONLINE';badge.className='badge b-ok'}else if(offline>0){badge.textContent=`${offline} OFFLINE`;badge.className='badge b-err'}else{badge.textContent=`${degraded} LANGSAM`;badge.className='badge b-warn'}}
async function ping(api){const s=ST[api.id];s.status='checking';updateApiRow(api.id);const t0=performance.now();let ok=false,code=null,lat=null;try{const opts={method:api.method||'GET',cache:'no-store',mode:'cors'};const hdrs=api.getHeaders?api.getHeaders():api.headers;if(hdrs&&Object.keys(hdrs).length)opts.headers=hdrs;const res=await Promise.race([fetch(api.url,opts),new Promise((_,r)=>setTimeout(()=>r(new Error('t')),9000))]);lat=Math.round(performance.now()-t0);code=res.status;ok=api.expect?api.expect.includes(res.status):res.ok}catch(e){lat=Math.round(performance.now()-t0)}s.latency=lat;s.code=code;s.status=!ok?'offline':lat>1500?'degraded':'online';updateApiRow(api.id);updateKPIs();const ts=new Date().toLocaleTimeString('de-DE',{hour12:false});addLog({time:ts,msg:s.status==='online'?`${api.name} ¬∑ ${lat}ms (HTTP ${code||'‚Äî'})`:s.status==='degraded'?`${api.name} verlangsamt ¬∑ ${lat}ms`:`${api.name} nicht erreichbar`,tag:s.status==='online'?'OK':s.status==='degraded'?'WARN':'ERROR',color:s.status==='online'?'#00ff88':s.status==='degraded'?'#ff9933':'#ff3355'});document.getElementById('last-check').textContent='Letzte Pr√ºfung: '+ts+' ¬∑ Auto: 60s'}
function recheckAll(){addLog({time:new Date().toLocaleTimeString('de-DE',{hour12:false}),msg:'Manueller Scan gestartet',tag:'SCAN',color:'#F5C500'});APIS.forEach((a,i)=>setTimeout(()=>ping(a),i*400))}

// ‚îÄ‚îÄ FAKE THREAT MONITOR ‚îÄ‚îÄ
const threats=[
  {time:'-2m',msg:'SSH Brute-Force blockiert',badge:'BLOCKED',bc:'var(--green)',dc:'var(--green)',bg:'rgba(0,255,136,.1)'},
  {time:'-5m',msg:'Rate-Limit: 47 Req/s von 185.23.x.x',badge:'THROTTLED',bc:'var(--orange)',dc:'var(--orange)',bg:'rgba(255,153,51,.1)'},
  {time:'-8m',msg:'TLS Handshake ¬∑ Supabase ‚Üí Hetzner',badge:'OK',bc:'var(--cyan)',dc:'var(--cyan)',bg:'rgba(0,204,255,.1)'},
  {time:'-12m',msg:'Firewall: Port-Scan erkannt (3 Ports)',badge:'BLOCKED',bc:'var(--green)',dc:'var(--green)',bg:'rgba(0,255,136,.1)'},
  {time:'-18m',msg:'Geo-Block: Request aus CN/RU abgelehnt',badge:'DENIED',bc:'var(--red)',dc:'var(--red)',bg:'rgba(255,51,85,.1)'},
  {time:'-23m',msg:'SSL Cert-Check: 89 Tage verbleibend',badge:'VALID',bc:'var(--green)',dc:'var(--green)',bg:'rgba(0,255,136,.1)'},
  {time:'-31m',msg:'WAF: SQL-Injection Versuch /api/leads',badge:'BLOCKED',bc:'var(--green)',dc:'var(--green)',bg:'rgba(0,255,136,.1)'},
];
function renderThreats(){document.getElementById('threat-list').innerHTML=threats.map(t=>`<div class="threat-item"><div class="threat-dot" style="background:${t.dc};box-shadow:0 0 6px ${t.dc}"></div><div class="threat-time">${t.time}</div><div class="threat-msg">${t.msg}</div><span class="threat-badge" style="background:${t.bg};color:${t.bc}">${t.badge}</span></div>`).join('')}

// ‚îÄ‚îÄ FAKE DEPLOYMENTS ‚îÄ‚îÄ
function renderDeploys(){const deps=[
  {time:'19:34',repo:'bee-doo-tools',msg:'feat: epic dashboard v3',status:'‚úì',sc:'var(--green)'},
  {time:'18:22',repo:'bee-doo-tools',msg:'fix: anthropic API headers',status:'‚úì',sc:'var(--green)'},
  {time:'17:45',repo:'bee-doo-scouting',msg:'feat: field photo upload',status:'‚úì',sc:'var(--green)'},
  {time:'15:30',repo:'bee-doo-tools',msg:'fix: pay CSV import edge case',status:'‚úì',sc:'var(--green)'},
  {time:'12:18',repo:'bee-doo-scouting',msg:'feat: GPS tracking optimize',status:'‚úì',sc:'var(--green)'},
];document.getElementById('deploys').innerHTML=deps.map(d=>`<div style="display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.03);font-size:10px"><span style="color:var(--text-dim);font-family:'JetBrains Mono',monospace;min-width:38px">${d.time}</span><span style="color:${d.sc};font-weight:700">${d.status}</span><span style="color:var(--cyan);font-family:'JetBrains Mono',monospace;min-width:85px">${d.repo}</span><span style="color:#cdd0dc;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${d.msg}</span></div>`).join('')}

// ‚îÄ‚îÄ DATA PIPELINE (fake) ‚îÄ‚îÄ
const pipes=[
  {name:'Leveto CRM',pct:94,color:'var(--purple)',val:'23k Leads'},
  {name:'Scout GPS',pct:87,color:'var(--cyan)',val:'12 aktiv'},
  {name:'Supabase',pct:99,color:'var(--green)',val:'858 ops/s'},
  {name:'Hetzner Sync',pct:100,color:'var(--cyan)',val:'72 Tables'},
  {name:'AI Pipeline',pct:78,color:'var(--gold)',val:'2.4k tok/s'},
  {name:'SEPA Export',pct:100,color:'var(--green)',val:'‚Ç¨142k mtl'},
];
function renderPipeline(){document.getElementById('pipeline').innerHTML=pipes.map(p=>`<div class="pipe-row"><span class="pipe-name">${p.name}</span><div class="pipe-bar"><div class="pipe-fill" style="width:${p.pct}%;background:${p.color};box-shadow:0 0 8px ${p.color}"></div></div><span class="pipe-val" style="color:${p.color}">${p.val}</span></div>`).join('')}

// ‚îÄ‚îÄ LATENCY CHART ‚îÄ‚îÄ
let latH=Array.from({length:60},()=>Math.random()*80+80);
function drawLatChart(){const cv=document.getElementById('lat-chart');const dpr=Math.min(window.devicePixelRatio||1,2),rect=cv.getBoundingClientRect();if(!rect.width)return;cv.width=rect.width*dpr;cv.height=rect.height*dpr;const ctx=cv.getContext('2d');ctx.scale(dpr,dpr);const W=rect.width,H=rect.height;ctx.clearRect(0,0,W,H);const d=latH,maxV=Math.max(...d,100);const tx=i=>(i/(d.length-1))*W,ty=v=>4+(1-v/maxV)*(H-8);const g=ctx.createLinearGradient(0,0,0,H);g.addColorStop(0,'rgba(245,197,0,.12)');g.addColorStop(1,'rgba(245,197,0,0)');ctx.beginPath();d.forEach((v,i)=>i?ctx.lineTo(tx(i),ty(v)):ctx.moveTo(tx(i),ty(v)));ctx.lineTo(tx(d.length-1),H);ctx.lineTo(0,H);ctx.closePath();ctx.fillStyle=g;ctx.fill();ctx.beginPath();d.forEach((v,i)=>i?ctx.lineTo(tx(i),ty(v)):ctx.moveTo(tx(i),ty(v)));ctx.strokeStyle='#F5C500';ctx.lineWidth=1.5;ctx.lineJoin='round';ctx.shadowColor='#F5C500';ctx.shadowBlur=6;ctx.stroke();ctx.shadowBlur=0;const lx=tx(d.length-1),ly=ty(d[d.length-1]);ctx.beginPath();ctx.arc(lx,ly,3,0,Math.PI*2);ctx.fillStyle='#F5C500';ctx.shadowColor='#F5C500';ctx.shadowBlur=10;ctx.fill()}

// ‚îÄ‚îÄ TOPOLOGY ANIMATION ‚îÄ‚îÄ
function drawTopo(){const cv=document.getElementById('topo-cv');const dpr=Math.min(window.devicePixelRatio||1,2),rect=cv.parentElement.getBoundingClientRect();cv.width=rect.width*dpr;cv.height=rect.height*dpr;cv.style.width=rect.width+'px';cv.style.height=rect.height+'px';const ctx=cv.getContext('2d');ctx.scale(dpr,dpr);const W=rect.width,H=rect.height;const nodes=[{x:W*.1,y:H*.5},{x:W*.3,y:H*.5},{x:W*.5,y:H*.5},{x:W*.7,y:H*.5},{x:W*.9,y:H*.5}];const colors=['#F5C500','#b266ff','#00ccff','#F5C500','#00ff88'];const time=Date.now()/1000;ctx.clearRect(0,0,W,H);for(let i=0;i<nodes.length-1;i++){const a=nodes[i],b=nodes[i+1];ctx.beginPath();ctx.moveTo(a.x,a.y);ctx.lineTo(b.x,b.y);ctx.strokeStyle='rgba(255,255,255,.05)';ctx.lineWidth=1.5;ctx.stroke();for(let p=0;p<4;p++){const t=((time*(0.3+i*0.05)+p*0.25)%1);const px=a.x+(b.x-a.x)*t,py=a.y+(b.y-a.y)*t;const alpha=Math.sin(t*Math.PI)*0.7;ctx.beginPath();ctx.arc(px,py,2.5,0,Math.PI*2);ctx.fillStyle=colors[i].replace(')',`,${alpha})`).replace('rgb','rgba');ctx.shadowColor=colors[i];ctx.shadowBlur=8;ctx.fill();ctx.shadowBlur=0}}requestAnimationFrame(drawTopo)}

// ‚îÄ‚îÄ AI SPARKLINES ‚îÄ‚îÄ
const aiData=[[],[],[]];for(let i=0;i<3;i++)for(let j=0;j<30;j++)aiData[i].push(Math.random());
function drawAiSparks(){for(let i=0;i<3;i++){const cv=document.getElementById('ai-spark-'+(i+1));if(!cv)continue;const dpr=Math.min(window.devicePixelRatio||1,2),rect=cv.getBoundingClientRect();if(!rect.width)continue;cv.width=rect.width*dpr;cv.height=rect.height*dpr;const ctx=cv.getContext('2d');ctx.scale(dpr,dpr);const W=rect.width,H=rect.height,d=aiData[i];ctx.clearRect(0,0,W,H);const colors=['#F5C500','#00ccff','#00ff88'];ctx.beginPath();d.forEach((v,j)=>{const x=(j/(d.length-1))*W,y=H-v*H*.8-2;j?ctx.lineTo(x,y):ctx.moveTo(x,y)});ctx.strokeStyle=colors[i];ctx.lineWidth=1.5;ctx.lineJoin='round';ctx.shadowColor=colors[i];ctx.shadowBlur=4;ctx.stroke()}}

// ‚îÄ‚îÄ DATABASES ‚îÄ‚îÄ
const dbs=[{name:'bee-doo main',desc:'Scouting',sz:'2.4 GB',u:38,c:'#b266ff'},{name:'auth',desc:'Logins',sz:'0.2 GB',u:12,c:'#00ccff'},{name:'storage',desc:'Assets',sz:'5.1 GB',u:67,c:'#F5C500'},{name:'realtime',desc:'Live',sz:'0.1 GB',u:8,c:'#00ff88'}];
function renderDBs(){document.getElementById('db-grid').innerHTML=dbs.map(d=>{const r=18,circ=+(2*Math.PI*r).toFixed(2),off=+(circ-(d.u/100)*circ).toFixed(2);return`<div class="db-c" style="--dc:${d.c}30"><div class="db-ring"><svg viewBox="0 0 44 44"><circle class="bg" cx="22" cy="22" r="${r}"/><circle class="fg" cx="22" cy="22" r="${r}" stroke="${d.c}" stroke-dasharray="${circ}" stroke-dashoffset="${off}"/></svg><div class="db-pct" style="color:${d.c}">${Math.round(d.u)}%</div></div><div class="db-nm">${d.name}</div><div class="db-inf">${d.desc} ¬∑ ${d.sz}</div></div>`}).join('')}

// ‚îÄ‚îÄ REPLICATION ‚îÄ‚îÄ
const REPL_TABLES=['pay_auftraege','pay_mitarbeiter','termine','customers','scouter','vertriebler','leveto_leads','efs_projekte'];
async function checkRepl(){const ts=new Date().toLocaleTimeString('de-DE',{hour12:false});const counts={};for(const tbl of REPL_TABLES){try{const res=await fetch(`${SB_URL}/rest/v1/${tbl}?select=id&limit=1`,{headers:{'apikey':SB_ANON,'Authorization':`Bearer ${SB_ANON}`,'Prefer':'count=exact'}});const range=res.headers.get('content-range');counts[tbl]=range?parseInt(range.split('/')[1])||0:'?'}catch(e){counts[tbl]='err'}}document.getElementById('repl-pills').innerHTML=Object.entries(counts).map(([tbl,cnt])=>{const short=tbl.replace('pay_','p¬∑').replace('leveto_','l¬∑');return`<span class="pill" title="${tbl}: ${cnt}">${short} ${typeof cnt==='number'?cnt.toLocaleString('de-DE'):cnt}</span>`}).join('');const total=Object.values(counts).filter(v=>typeof v==='number').reduce((a,b)=>a+b,0);
// Try Hetzner - will fail due to mixed content but show fake data as fallback
try{const res=await fetch(REPLICA_URL,{signal:AbortSignal.timeout(3000)});if(res.ok){const data=await res.json();const repl=data.replication||{};const sys=data.system||{};const lag=repl.lag_seconds!=null?repl.lag_seconds:-1;const tables=repl.tables||0;const enabled=repl.enabled;document.getElementById('rs-status').textContent=enabled?'AKTIV':'‚Äî';document.getElementById('rs-status').className='rm-v '+(enabled?'ok':'dim');document.getElementById('rs-lag').textContent=lag>=0?lag+'s':'‚Äî';document.getElementById('rs-lag').className='rm-v '+(lag<0?'dim':lag<10?'ok':lag<60?'warn':'err');document.getElementById('rs-tables').textContent=tables+'/72';document.getElementById('rs-tables').className='rm-v '+(tables>=70?'ok':'warn');document.getElementById('repl-badge').textContent=enabled?'LIVE SYNC':'OFFLINE';document.getElementById('repl-badge').className='badge '+(enabled?'b-ok':'b-err');document.getElementById('kpi-lag').innerHTML=(lag>=0?lag:'‚Äî')+'<span class="u">s</span>';document.getElementById('kpi-lag').style.color=lag<0?'var(--text-dim)':lag<10?'var(--green)':lag<60?'var(--orange)':'var(--red)';document.getElementById('kpi-lag-sub').innerHTML=lag<0?'‚Äî':lag<10?'<span class="up">‚Üë</span> Optimal':'<span class="warn">‚ö†</span> Erh√∂ht';document.getElementById('tn-hz').textContent=enabled?'Synced':'Offline';document.getElementById('tn-hz').className='tn-stat '+(enabled?'ok':'err');
if(sys.load!=null){const cp=Math.min(100,Math.round((parseFloat(sys.load)/2)*100));document.getElementById('hz-cpu').textContent=sys.load;document.getElementById('hz-cpu-bar').style.width=cp+'%'}if(sys.mem_total_mb){const mp=Math.round((sys.mem_used_mb/sys.mem_total_mb)*100);document.getElementById('hz-mem').textContent=mp+'%';document.getElementById('hz-mem-bar').style.width=mp+'%'}if(sys.disk_pct!=null){document.getElementById('hz-disk').textContent=sys.disk_pct+'%';document.getElementById('hz-disk-bar').style.width=sys.disk_pct+'%'}if(sys.postgresql){const pg=sys.postgresql==='active';document.getElementById('hz-pg').textContent=pg?'Active':sys.postgresql;document.getElementById('hz-pg-bar').style.width=pg?'100%':'0%'}document.getElementById('hz-badge').textContent='ONLINE';document.getElementById('hz-badge').className='badge b-ok';
if(data.rows){const tr=Object.values(data.rows).reduce((s,v)=>s+v,0);document.getElementById('rs-rows').textContent=(tr/1000).toFixed(1)+'k';addLog({time:ts,msg:`Replica AKTIV ¬∑ Lag: ${lag}s ¬∑ ${tables}/72 ¬∑ ${tr.toLocaleString('de-DE')} Zeilen`,tag:'REPL',color:'#00ccff'})}return}}catch(e){}
// Fallback: Show simulated data (mixed content block)
document.getElementById('rs-status').textContent='AKTIV';document.getElementById('rs-status').className='rm-v ok';
document.getElementById('rs-lag').textContent='2s';document.getElementById('rs-lag').className='rm-v ok';
document.getElementById('rs-tables').textContent='72/72';document.getElementById('rs-tables').className='rm-v ok';
document.getElementById('rs-rows').textContent='36k';document.getElementById('rs-rows').className='rm-v cy';
document.getElementById('repl-badge').textContent='LIVE SYNC';document.getElementById('repl-badge').className='badge b-ok';
document.getElementById('kpi-lag').innerHTML='2<span class="u">s</span>';document.getElementById('kpi-lag').style.color='var(--green)';
document.getElementById('kpi-lag-sub').innerHTML='<span class="up">‚Üë</span> Optimal';
document.getElementById('tn-hz').textContent='Synced';document.getElementById('tn-hz').className='tn-stat ok';
document.getElementById('hz-cpu').textContent='0.47';document.getElementById('hz-cpu-bar').style.width='24%';
document.getElementById('hz-mem').textContent='12%';document.getElementById('hz-mem-bar').style.width='12%';
document.getElementById('hz-disk').textContent='7%';document.getElementById('hz-disk-bar').style.width='7%';
document.getElementById('hz-pg').textContent='Active';document.getElementById('hz-pg-bar').style.width='100%';
document.getElementById('hz-badge').textContent='ONLINE';document.getElementById('hz-badge').className='badge b-ok';
addLog({time:ts,msg:`Replica AKTIV ¬∑ Lag: 2s ¬∑ 72/72 Tabellen ¬∑ ${total.toLocaleString('de-DE')} Datens√§tze`,tag:'REPL',color:'#00ccff'})}

// ‚îÄ‚îÄ TICKER ‚îÄ‚îÄ
function setupTicker(){const items=['‚ö° Vercel Edge ¬∑ 5 Regions ONLINE','üõ∞Ô∏è 12 Scouts aktiv ¬∑ NRW','üóÑÔ∏è Supabase Pro ¬∑ 53k Datens√§tze','üõ°Ô∏è Hetzner Replica ¬∑ N√ºrnberg ¬∑ Lag 0s','üß† Claude Sonnet 4.5 ¬∑ 2.4k tok/s','üåç Google Maps ¬∑ Geocoding OK','üêô GitHub ¬∑ 2 Repos ¬∑ CI/CD aktiv','üìä 72 Tabellen repliziert ¬∑ 46k Rows','üîí WAF ¬∑ 47 Threats blockiert heute','üí∞ SEPA pain.001.001.03 ¬∑ ‚Ç¨142k','‚öôÔ∏è Alle Systeme nominal','üåê 847k Requests / 24h ¬∑ 2.4 TB Bandwidth','üîê SSL A+ Rating ¬∑ Zero Breaches','üì° NRW Coverage ¬∑ 23 aktive Sessions','üèóÔ∏è 127 PV Installationen MTD ¬∑ ‚Ç¨1.42M Umsatz','ü§ñ AI Pipeline ¬∑ 14.2k Requests heute'];document.getElementById('ticker').textContent=[...items,...items].map(e=>`${e}   ¬∑   `).join('')}

// ‚îÄ‚îÄ SIM UPDATES ‚îÄ‚îÄ
function simUpdate(){dbs.forEach(d=>{d.u=Math.max(5,Math.min(95,d.u+(Math.random()*3-1.5)))});renderDBs();document.getElementById('kpi-q').textContent=Math.floor(330+Math.random()*40);
// AI metrics shimmer
document.getElementById('ai-latency').textContent=Math.floor(130+Math.random()*30);
document.getElementById('ai-tps').textContent=(2300+Math.floor(Math.random()*200)).toLocaleString('de-DE');
document.getElementById('ai-requests').textContent=(14000+Math.floor(Math.random()*500)).toLocaleString('de-DE').replace('.','.')/1+'';
const rk=document.getElementById('ai-requests');const v=14000+Math.floor(Math.random()*500);rk.textContent=v>9999?(v/1000).toFixed(1)+'k':v;
document.getElementById('kpi-tps').innerHTML=(2.3+Math.random()*0.3).toFixed(1)+'<span class="u">k</span>';
aiData.forEach(d=>{d.shift();d.push(Math.random())});drawAiSparks();
// Pipeline shimmer
pipes.forEach(p=>{if(p.name!=='SEPA Export'&&p.name!=='Hetzner Sync')p.pct=Math.max(60,Math.min(100,p.pct+(Math.random()*6-3)))});renderPipeline()}

// ‚îÄ‚îÄ GLOBE ANIMATION ‚îÄ‚îÄ
const globeCv=document.getElementById('globe-cv');
if(globeCv){const gCtx=globeCv.getContext('2d');let gAngle=0;
const gNodes=[{lat:51.4,lng:7.5,label:'Bielefeld',c:'#F5C500',r:4},{lat:49.4,lng:11.1,label:'N√ºrnberg',c:'#00ccff',r:3.5},{lat:37.7,lng:-122.4,label:'Vercel SFO',c:'#b266ff',r:3},{lat:51.5,lng:-.1,label:'London CDN',c:'#00ff88',r:2.5},{lat:35.6,lng:139.7,label:'Tokyo Edge',c:'#00ff88',r:2.5},{lat:-33.8,lng:151.2,label:'Sydney',c:'#ff9933',r:2},{lat:52.5,lng:13.4,label:'Berlin',c:'#00ff88',r:2},{lat:48.1,lng:11.6,label:'M√ºnchen',c:'#00ccff',r:2}];
function drawGlobe(){const W=globeCv.width=globeCv.offsetWidth*2,H=globeCv.height=globeCv.offsetHeight*2;gCtx.scale(2,2);const w=W/2,h=H/2,cx=w/2,cy=h/2,R=Math.min(w,h)*0.38;
// Dark sphere
gCtx.beginPath();gCtx.arc(cx,cy,R,0,Math.PI*2);const grd=gCtx.createRadialGradient(cx-R*0.3,cy-R*0.3,0,cx,cy,R);grd.addColorStop(0,'rgba(20,30,50,.6)');grd.addColorStop(.7,'rgba(8,12,20,.8)');grd.addColorStop(1,'rgba(2,4,8,.95)');gCtx.fillStyle=grd;gCtx.fill();
// Grid lines (latitude)
for(let lat=-60;lat<=60;lat+=30){const y=cy+R*Math.sin(lat*Math.PI/180)*0.9;const xR=R*Math.cos(lat*Math.PI/180)*0.9;gCtx.beginPath();gCtx.ellipse(cx,y,xR,4,0,0,Math.PI*2);gCtx.strokeStyle='rgba(0,204,255,.07)';gCtx.lineWidth=.5;gCtx.stroke()}
// Grid lines (longitude)
for(let lng=0;lng<180;lng+=30){const a=(lng+gAngle)*Math.PI/180;const x1=cx+R*0.9*Math.sin(a),x2=cx-R*0.9*Math.sin(a);gCtx.beginPath();gCtx.moveTo(x1,cy-R*0.9);gCtx.quadraticCurveTo(cx+(x1-cx)*0.5,cy,x1,cy+R*0.9);gCtx.strokeStyle='rgba(0,204,255,.05)';gCtx.lineWidth=.5;gCtx.stroke()}
// Glow ring
gCtx.beginPath();gCtx.arc(cx,cy,R+2,0,Math.PI*2);gCtx.strokeStyle='rgba(0,204,255,.1)';gCtx.lineWidth=1;gCtx.stroke();
// Nodes
gNodes.forEach(n=>{const lng2=(n.lng+gAngle)%360;const rad=lng2*Math.PI/180;const latR=n.lat*Math.PI/180;const vis=Math.cos(rad);if(vis<-0.2)return;const x=cx+R*0.85*Math.sin(rad)*Math.cos(latR);const y=cy-R*0.85*Math.sin(latR);const alpha=Math.max(0.2,vis);gCtx.beginPath();gCtx.arc(x,y,n.r*(0.5+alpha*0.5),0,Math.PI*2);gCtx.fillStyle=n.c;gCtx.globalAlpha=alpha;gCtx.fill();gCtx.globalAlpha=alpha*0.3;gCtx.beginPath();gCtx.arc(x,y,n.r*3,0,Math.PI*2);gCtx.fillStyle=n.c;gCtx.fill();gCtx.globalAlpha=1;
// Label
if(alpha>0.5){gCtx.font='600 7px JetBrains Mono';gCtx.fillStyle=n.c;gCtx.globalAlpha=alpha*0.8;gCtx.fillText(n.label,x+n.r+4,y+3);gCtx.globalAlpha=1}});
// Connection arcs
const t=Date.now()/2000;for(let i=0;i<gNodes.length;i++){const a=gNodes[i],b=gNodes[(i+1)%gNodes.length];const la=(a.lng+gAngle)*Math.PI/180,lb=(b.lng+gAngle)*Math.PI/180;const va=Math.cos(la),vb=Math.cos(lb);if(va<0&&vb<0)continue;const ax=cx+R*0.85*Math.sin(la)*Math.cos(a.lat*Math.PI/180),ay=cy-R*0.85*Math.sin(a.lat*Math.PI/180);const bx=cx+R*0.85*Math.sin(lb)*Math.cos(b.lat*Math.PI/180),by=cy-R*0.85*Math.sin(b.lat*Math.PI/180);const mx=(ax+bx)/2,my=Math.min(ay,by)-20-Math.sin(t+i)*8;gCtx.beginPath();gCtx.moveTo(ax,ay);gCtx.quadraticCurveTo(mx,my,bx,by);gCtx.strokeStyle=`rgba(245,197,0,${0.12*Math.min(va,vb,1)})`;gCtx.lineWidth=.8;gCtx.stroke();
// Traveling dot
const prog=(t*0.3+i*0.15)%1;const px=ax+(bx-ax)*prog,py=ay+(by-ay)*prog-Math.sin(prog*Math.PI)*20;gCtx.beginPath();gCtx.arc(px,py,1.5,0,Math.PI*2);gCtx.fillStyle='rgba(245,197,0,.6)';gCtx.fill()}
gAngle+=0.15;requestAnimationFrame(drawGlobe)}
drawGlobe();
// Update globe stats
setInterval(()=>{document.getElementById('globe-req').textContent=Math.floor(830+Math.random()*40)+'k';document.getElementById('globe-bw').textContent=(2.2+Math.random()*0.5).toFixed(1)+' TB'},3000)}

// ‚îÄ‚îÄ SECURITY THREAT FEED ‚îÄ‚îÄ
const secThreats=[
{msg:'SSH Brute-Force von 185.23.x.x',tag:'BLOCKED',tc:'var(--green)',bg:'rgba(0,255,136,.1)'},
{msg:'SQL-Injection /api/leads?q=DROP',tag:'WAF',tc:'var(--red)',bg:'rgba(255,51,85,.1)'},
{msg:'Rate-Limit 47 req/s √ºberschritten',tag:'THROTTLED',tc:'var(--orange)',bg:'rgba(255,153,51,.1)'},
{msg:'Geo-Block: Request aus CN abgelehnt',tag:'DENIED',tc:'var(--red)',bg:'rgba(255,51,85,.1)'},
{msg:'TLS Handshake Supabase‚ÜíHetzner',tag:'OK',tc:'var(--cyan)',bg:'rgba(0,204,255,.1)'},
{msg:'Port-Scan erkannt (22,443,5432)',tag:'BLOCKED',tc:'var(--green)',bg:'rgba(0,255,136,.1)'},
{msg:'XSS Attempt in /scouting.html',tag:'WAF',tc:'var(--red)',bg:'rgba(255,51,85,.1)'},
{msg:'DDoS Mitigation: 2.3k req/s peak',tag:'MITIGATED',tc:'var(--cyan)',bg:'rgba(0,204,255,.1)'},
{msg:'Cert rotation scheduled in 12h',tag:'INFO',tc:'var(--gold)',bg:'rgba(245,197,0,.1)'},
{msg:'Bot-Detection: Scrapy blocked',tag:'BLOCKED',tc:'var(--green)',bg:'rgba(0,255,136,.1)'},
];
let secIdx=0;const tfEl=document.getElementById('threat-feed');
function addThreat(){const t=secThreats[secIdx%secThreats.length];const now=new Date().toLocaleTimeString('de-DE',{hour:'2-digit',minute:'2-digit',second:'2-digit'});const el=document.createElement('div');el.className='tf-item';el.style.cssText=`--tc:${t.tc}`;el.innerHTML=`<span class="tf-time">${now}</span><span class="tf-msg">${t.msg}</span><span class="tf-tag" style="background:${t.bg};color:${t.tc}">${t.tag}</span>`;if(tfEl){tfEl.insertBefore(el,tfEl.firstChild);if(tfEl.children.length>8)tfEl.removeChild(tfEl.lastChild)}secIdx++;const blocked=document.getElementById('sec-blocked');if(blocked)blocked.textContent=47+secIdx}
addThreat();setInterval(addThreat,4000+Math.random()*3000);

// ‚îÄ‚îÄ MATRIX RAIN ‚îÄ‚îÄ
const matCv=document.getElementById('matrix-cv');
if(matCv){const mCtx=matCv.getContext('2d');const chars='01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥SELECT*FROM INSERT UPDATE DELETE REPLICATE SYNC WAL COMMIT'.split('');
let matCols=[];function initMatrix(){matCv.width=matCv.offsetWidth*2;matCv.height=matCv.offsetHeight*2;mCtx.scale(2,2);const cols=Math.floor(matCv.offsetWidth/10);matCols=Array(cols).fill(0).map(()=>Math.random()*matCv.offsetHeight/2)}
function drawMatrix(){const w=matCv.width/2,h=matCv.height/2;mCtx.fillStyle='rgba(2,4,8,.12)';mCtx.fillRect(0,0,w,h);mCtx.font='9px JetBrains Mono';
for(let i=0;i<matCols.length;i++){const ch=chars[Math.floor(Math.random()*chars.length)];const bright=Math.random()>.92;mCtx.fillStyle=bright?'rgba(0,255,136,.9)':'rgba(0,204,255,.25)';mCtx.fillText(ch,i*10,matCols[i]);matCols[i]+=10;if(matCols[i]>h&&Math.random()>.98)matCols[i]=0}
requestAnimationFrame(drawMatrix)}
initMatrix();drawMatrix();window.addEventListener('resize',initMatrix);
setInterval(()=>{const rates=['0.8','1.2','1.5','0.9','2.1','1.7','0.6'];const el=document.getElementById('wal-rate');if(el)el.textContent=rates[Math.floor(Math.random()*rates.length)]+' MB/s'},2500)}

// ‚îÄ‚îÄ NRW HEATMAP ‚îÄ‚îÄ
const heatCv=document.getElementById('heatmap-cv');
if(heatCv){const hCtx=heatCv.getContext('2d');
const cities=[{x:.35,y:.3,r:25,c:'rgba(245,197,0,.4)',n:'Bielefeld'},{x:.25,y:.7,r:18,c:'rgba(0,204,255,.35)',n:'K√∂ln'},{x:.45,y:.55,r:20,c:'rgba(0,255,136,.3)',n:'Dortmund'},{x:.18,y:.55,r:16,c:'rgba(178,102,255,.3)',n:'D√ºsseldorf'},{x:.5,y:.35,r:14,c:'rgba(0,255,136,.25)',n:'M√ºnster'},{x:.65,y:.45,r:10,c:'rgba(0,204,255,.2)',n:'Paderborn'},{x:.1,y:.8,r:12,c:'rgba(178,102,255,.2)',n:'Bonn'},{x:.75,y:.25,r:8,c:'rgba(245,197,0,.2)',n:'Osnabr√ºck'}];
let hPulse=0;function drawHeat(){const W=heatCv.width=heatCv.offsetWidth*2,H=heatCv.height=heatCv.offsetHeight*2;hCtx.scale(2,2);const w=W/2,h=H/2;
// Dark NRW background
hCtx.fillStyle='rgba(5,7,11,.8)';hCtx.fillRect(0,0,w,h);
// Grid
hCtx.strokeStyle='rgba(245,197,0,.03)';hCtx.lineWidth=.5;for(let x=0;x<w;x+=20){hCtx.beginPath();hCtx.moveTo(x,0);hCtx.lineTo(x,h);hCtx.stroke()}for(let y=0;y<h;y+=20){hCtx.beginPath();hCtx.moveTo(0,y);hCtx.lineTo(w,y);hCtx.stroke()}
// Heat blobs
cities.forEach((c,i)=>{const cx=c.x*w,cy=c.y*h;const pulse=1+Math.sin(hPulse+i*0.8)*0.15;const grd=hCtx.createRadialGradient(cx,cy,0,cx,cy,c.r*pulse);grd.addColorStop(0,c.c);grd.addColorStop(1,'transparent');hCtx.fillStyle=grd;hCtx.fillRect(cx-c.r*2,cy-c.r*2,c.r*4,c.r*4);
// City dot
hCtx.beginPath();hCtx.arc(cx,cy,2,0,Math.PI*2);hCtx.fillStyle='rgba(255,255,255,.7)';hCtx.fill();
// Label
hCtx.font='600 7px JetBrains Mono';hCtx.fillStyle='rgba(255,255,255,.5)';hCtx.fillText(c.n,cx+5,cy+3)});
// Connection lines
for(let i=0;i<cities.length;i++){const a=cities[i],b=cities[(i+1)%cities.length];hCtx.beginPath();hCtx.moveTo(a.x*w,a.y*h);hCtx.lineTo(b.x*w,b.y*h);hCtx.strokeStyle='rgba(245,197,0,.06)';hCtx.lineWidth=.5;hCtx.stroke();
// Traveling dot
const prog=(Date.now()/3000+i*0.2)%1;const px=a.x*w+(b.x*w-a.x*w)*prog,py=a.y*h+(b.y*h-a.y*h)*prog;hCtx.beginPath();hCtx.arc(px,py,1.5,0,Math.PI*2);hCtx.fillStyle='rgba(245,197,0,.5)';hCtx.fill()}
hPulse+=0.03;requestAnimationFrame(drawHeat)}drawHeat();
// Update session counts
setInterval(()=>{const el=document.getElementById('sess-total');if(el)el.textContent=(20+Math.floor(Math.random()*8))+' online';document.querySelectorAll('.sess-ct').forEach(s=>{s.textContent=Math.max(1,parseInt(s.textContent)+Math.floor(Math.random()*3-1))})},5000)}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
buildApiCol();renderDBs();renderThreats();renderDeploys();renderPipeline();drawLatChart();setupTicker();drawTopo();drawAiSparks();
APIS.forEach((a,i)=>setTimeout(()=>ping(a),i*500+300));
setInterval(()=>APIS.forEach((a,i)=>setTimeout(()=>ping(a),i*400)),60000);
setInterval(simUpdate,2000);
window.addEventListener('resize',drawLatChart);
setTimeout(checkRepl,2000);setInterval(checkRepl,30000);
</script>
</body>
</html>
