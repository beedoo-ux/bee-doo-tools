<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bee-doo | Import Cockpit</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root{--a:#FDE154;--ad:rgba(253,225,84,.12);--bg:#08090d;--c:#111219;--ch:#16171f;--el:#1a1b24;--b:rgba(255,255,255,.06);--ba:rgba(253,225,84,.2);--t:#d8dae2;--td:#6b7280;--tb:#f3f4f6;--g:#22c55e;--gd:rgba(34,197,94,.12);--r:#ef4444;--rd:rgba(239,68,68,.12);--o:#f59e0b;--od:rgba(245,158,11,.12);--bl:#3b82f6;--bld:rgba(59,130,246,.12)}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--t);min-height:100vh}
        ::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,255,255,.08);border-radius:3px}
        @keyframes fi{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}@keyframes sp{to{transform:rotate(360deg)}}@keyframes pu{0%,100%{opacity:1}50%{opacity:.5}}
        .fi{animation:fi .3s ease-out}.spinner{width:13px;height:13px;border:2px solid transparent;border-top-color:currentColor;border-radius:50%;animation:sp .6s linear infinite;display:inline-block}
        .hdr{padding:14px 28px;border-bottom:1px solid var(--b);display:flex;align-items:center;justify-content:space-between;background:linear-gradient(180deg,rgba(253,225,84,.02) 0%,transparent 100%)}
        .hdr-l{display:flex;align-items:center;gap:14px}.logo{font-size:18px;font-weight:700;color:var(--a);letter-spacing:-.5px}.logo span{color:var(--td);font-weight:400;font-size:15px}
        .hdr-lk{font-size:12px;color:var(--td);text-decoration:none;padding:5px 10px;border-radius:6px;border:1px solid var(--b);transition:all .2s}.hdr-lk:hover{color:var(--a);border-color:var(--ba);background:var(--ad)}
        .tabs{display:flex;gap:2px;padding:0 28px;background:var(--bg);border-bottom:1px solid var(--b)}
        .tab{padding:12px 20px;font-size:13px;font-weight:500;color:var(--td);cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;display:flex;align-items:center;gap:8px}.tab:hover{color:var(--t)}.tab.on{color:var(--a);border-bottom-color:var(--a)}
        .mn{max-width:1440px;margin:0 auto;padding:24px 28px}
        .sts{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:12px;margin-bottom:24px}
        .st{background:var(--c);border:1px solid var(--b);border-radius:10px;padding:16px 18px;transition:all .2s}.st:hover{border-color:var(--ba)}
        .st-l{font-size:10px;color:var(--td);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px}.st-v{font-size:24px;font-weight:700;color:var(--tb)}.st-s{font-size:10px;color:var(--td);margin-top:2px}
        .cd{background:var(--c);border:1px solid var(--b);border-radius:12px;padding:20px;margin-bottom:16px}
        .cd-t{font-size:15px;font-weight:600;color:var(--tb);display:flex;align-items:center;gap:8px;margin-bottom:14px}
        .btn{padding:9px 18px;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;border:none;transition:all .2s;display:inline-flex;align-items:center;gap:7px}
        .by{background:var(--a);color:#000}.by:hover:not(:disabled){background:#ffe566;box-shadow:0 4px 12px rgba(253,225,84,.25)}.by:disabled{opacity:.35;cursor:not-allowed}
        .bo{background:transparent;color:var(--t);border:1px solid var(--b)}.bo:hover{border-color:var(--ba);color:var(--a)}
        .br{background:var(--rd);color:var(--r);border:1px solid rgba(239,68,68,.15)}.br:hover{background:rgba(239,68,68,.2)}
        .bsm{padding:6px 12px;font-size:11px}.brow{display:flex;gap:10px;flex-wrap:wrap}
        .lb{background:var(--el);border-radius:8px;padding:14px;max-height:260px;overflow-y:auto;font-size:12px;font-family:monospace;line-height:1.8}
        .lb .tm{color:var(--td)}.lb .info{color:var(--t)}.lb .success{color:var(--g)}.lb .warn{color:var(--o)}.lb .error{color:var(--r)}
        .pb{height:4px;background:rgba(255,255,255,.05);border-radius:2px;overflow:hidden;margin:10px 0 4px}.pf{height:100%;background:linear-gradient(90deg,var(--a),#ffe566);border-radius:2px;transition:width .3s}
        .pt{font-size:11px;color:var(--td);display:flex;justify-content:space-between}
        .mt{width:100%;border-collapse:collapse;font-size:12px}.mt th{text-align:left;padding:8px 12px;color:var(--td);font-size:10px;text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid var(--b)}
        .mt td{padding:7px 12px;border-bottom:1px solid var(--b)}.mt tr:last-child td{border:none}
        .tg{font-size:10px;padding:2px 8px;border-radius:10px;font-weight:500}.tg-ok{background:var(--gd);color:var(--g)}.tg-w{background:var(--od);color:var(--o)}.tg-m{background:var(--rd);color:var(--r)}
        .ig{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:18px}
        .ic{background:var(--c);border:1px solid var(--b);border-radius:12px;padding:18px;transition:all .2s;position:relative;overflow:hidden}
        .ic::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--a);opacity:0;transition:opacity .3s}.ic:hover::before{opacity:1}.ic.on{border-color:var(--a)}.ic.on::before{opacity:1}
        .ich{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
        .ict{display:flex;align-items:center;gap:10px}.ici{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px}
        .icn{font-size:14px;font-weight:600;color:var(--tb)}.icd{font-size:11px;color:var(--td);margin-top:1px}
        .icb{font-size:10px;padding:2px 8px;border-radius:12px;font-weight:500}
        .dz{border:2px dashed rgba(255,255,255,.08);border-radius:8px;padding:18px;text-align:center;cursor:pointer;transition:all .3s;font-size:12px;color:var(--td)}
        .dz:hover,.dz.dv{border-color:var(--a);background:var(--ad)}.dz strong{color:var(--a)}.dz input{display:none}
        .fi2{display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--el);border-radius:6px;margin-top:6px;font-size:11px}
        .fi2-n{color:var(--tb);font-weight:500}.fi2-m{color:var(--td)}.fi2-x{background:none;border:none;color:var(--td);cursor:pointer;font-size:13px;margin-left:auto}.fi2-x:hover{color:var(--r)}
        .mh{font-size:11px;color:var(--a);background:var(--ad);padding:5px 8px;border-radius:5px;margin-bottom:8px;text-align:center}
        .rg{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;margin-top:8px}
        .ri{padding:7px;border-radius:6px;text-align:center}.ri.nw{background:var(--gd)}.ri.up{background:var(--bld)}.ri.er{background:var(--rd)}
        .rn{font-size:16px;font-weight:700}.ri.nw .rn{color:var(--g)}.ri.up .rn{color:var(--bl)}.ri.er .rn{color:var(--r)}.rl{font-size:9px;color:var(--td);margin-top:1px}
        .eg{display:grid;grid-template-columns:1fr 1fr;gap:14px}
        .mg{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:18px}
        .mc{background:var(--c);border:1px solid var(--b);border-radius:12px;padding:18px;text-align:center}
        .mv{font-size:28px;font-weight:700;color:var(--a);margin:8px 0}.ml{font-size:12px;color:var(--td)}
        @media(max-width:1100px){.ig,.eg{grid-template-columns:1fr 1fr}.mg{grid-template-columns:1fr}}
        @media(max-width:768px){.mn{padding:14px}.tabs{padding:0 14px;overflow-x:auto}.tab{padding:10px 14px;font-size:12px;white-space:nowrap}.sts{grid-template-columns:1fr 1fr}.ig,.eg{grid-template-columns:1fr}.hdr{padding:12px 14px}}
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useRef,useCallback}=React;
const SU='https://hqzpemfaljxcysyqssng.supabase.co';
const SK='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhxenBlbWZhbGp4Y3lzeXFzc25nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMzUzOTcsImV4cCI6MjA4NjkxMTM5N30.LSlMApceWuLk5MUctCGCVspXfYhc_As559aaoV2uSik';
const LU='https://beedoo.leveto.net/API';const LN='api@bee-doo.de';const LP='Patrick123456789!';
const B=50;const ap=t=>`${SU}/rest/v1/${t}`;const hd=(x={})=>({apikey:SK,Authorization:`Bearer ${SK}`,'Content-Type':'application/json',...x});

// CSV Parser
function parseCSV(t){const ls=[];let c='',q=false;for(let i=0;i<t.length;i++){const ch=t[i];if(ch==='"'){if(q&&t[i+1]==='"'){c+='"';i++}else q=!q}else if((ch==='\n'||ch==='\r')&&!q){if(c.length>0||ls.length>0){ls.push(c);c=''}if(ch==='\r'&&t[i+1]==='\n')i++}else c+=ch}if(c.length>0)ls.push(c);const sp=l=>{const cs=[];let cl='',q2=false;for(let i=0;i<l.length;i++){const ch=l[i];if(ch==='"'){if(q2&&l[i+1]==='"'){cl+='"';i++}else q2=!q2}else if(ch===','&&!q2){cs.push(cl.trim());cl=''}else cl+=ch}cs.push(cl.trim());return cs};if(!ls.length)return[];const h=sp(ls[0].replace(/^\uFEFF/,''));return ls.slice(1).filter(l=>l.trim()).map(l=>{const c2=sp(l);const o={};h.forEach((k,i)=>o[k]=c2[i]||'');return o})}

// Mappers
const pI=v=>{const n=parseInt(String(v).replace(/[^0-9-]/g,''));return isNaN(n)?0:n};const cl=v=>v&&v.trim()?v.trim():null;
function mL(r){return{lead_id:parseInt(r['Lead ID']),leadstatus:cl(r['Leadstatus']),mitarbeiter:cl(r['Mitarbeiter/Berater']),indikator:cl(r['Indikator']),letzter_bearbeitungsstatus:cl(r['LetzterBearbeitungsstatus']),projektstatus:cl(r['Projektstatus']),anrede:cl(r['Anrede']),vorname:cl(r['Vorname']),nachname:cl(r['Nachname']),name:cl(r['Name']),firma:cl(r['Firma']),strasse:cl(r['Strasse']),hausnummer:cl(r['Hausnummer']),plz:cl(r['PLZ']),ort:cl(r['Ort']),telefon:cl(r['Telefon']),mobil:cl(r['Mobil']),email:cl(r['E-Mail']),quelle:cl(r['Quelle']),projekt:cl(r['Projekt']),gruppe:cl(r['Gruppe']),anmerkung:cl(r['Anmerkung']),tags:cl(r['Tags']),erreichbarkeit:cl(r['Erreichbarkeit']),nicht_erreicht:pI(r['Nicht erreicht']),rueckruf:cl(r['R√ºckruf']),importiert:cl(r['Importiert']),verifizierung:cl(r['Verifizierung']),aktive_wiedervorlagen:pI(r['Aktive Wiedervorlagen']),mvpp_name:cl(r['MVPP-Name']),mvpp_id:cl(r['MVPP-ID']),qualitaetscall:cl(r['Qualit√§tscall']),qualitaetscall_notizen:cl(r['Qualit√§tscall Notizen']),externe_lead_id:cl(r['externeLeadID']),externe_lead_id_2:cl(r['externeLeadID 2']),externe_lead_id_3:cl(r['externeLeadID 3']),zuweisungsstatus:cl(r['Zuweisungsstatus']),qcells_zahlungsstatus:cl(r['Q-CellsZahlungsstatus']),qcells_fortschritt:cl(r['Q-CellsFortschritt']),lieferdatum:cl(r['Lieferdatum']),auftragsbestaetigung:cl(r['Auftragsbest√§tigung']),slots_verfuegbar:cl(r['Slots verf√ºgbar']),importierte_medien:pI(r['ImportierteMedien']),datum_qualifiziert:cl(r['Datum Qualifiziert']),datum_abgeschlossen:cl(r['Datumabgeschlossen']),datum_importiert:cl(r['Datumimportiert'])}}
function mA(r,q){return{termin_id:parseInt(r['TerminID']),lead_id:parseInt(r['LEADID'])||null,extern_id:cl(r['EXTERNID']),csv_quelle:q,leadquelle:cl(r['Leadquelle']),mvpp_name:cl(r['MVPP - NAME']),mvpp_id:cl(r['MVPP - ID']),leadkunde:cl(r['Leadkunde']),leadadresse:cl(r['Leadadresse']),terminiert_von:cl(r['Terminiertvon']),terminiert_an_name:cl(r['Terminiert anName']),terminiert_an_email:cl(r['Terminiert anE-Mail']),terminstatus:cl(r['Terminstatus']),aktueller_status:cl(r['AktuellerStatus']),angebotsstatus:cl(r['Angebotsstatus']),angebot_angenommen:cl(r['Angebot angenommen']),provisionsstatus:cl(r['Provisionsstatus']),terminausfall_begruendung:cl(r['TerminausfallBegr√ºndung']),abschlussstatus:cl(r['Abschlussstatus']),abschlussbemerkung:cl(r['Abschlussbemerkung']),bestaetigt_durch:cl(r['Best√§tigt Durch']),indikator:cl(r['Indikator']),datum_terminerstellung:cl(r['DatumTerminerstellung']),datum_termin_beginn:cl(r['DatumTermin Beginn']),datum_termin_ende:cl(r['DatumTermin Ende']),datum_abgeschlossen:cl(r['DatumAbgeschlossen']),datum_bestaetigt_partner:cl(r['DatumBest√§tigt Partner']),datum_bestaetigt_kunde:cl(r['DatumBest√§tigt Kunde'])}}
function mP(r){return{an_nr:parseInt(r['AN Nr.']),lead_id:parseInt(r['Lead ID'])||null,auftragsstatus:cl(r['Auftragsstatus']),typ:cl(r['Typ']),speichererweiterung:cl(r['Speichererweiterung']),dokumentstatus:cl(r['Dokumentstatus']),beedoo_fortschritt:cl(r['BeeDooFortschritt']),workflow_history:cl(r['WorkflowHistory']),ablehnung_freigabe_grund:cl(r['Ablehnung FreigabeGrund']),angebot_erstellt_von:cl(r['Angebot erstellt von']),kundenberater:cl(r['Kundenberater']),vp_nummer:cl(r['VP Nummer']),mvpp_id:cl(r['MVPP-ID']),mvpp_name:cl(r['MVPP-Name']),termine_agenten:cl(r['Termine Agenten']),termine_berater:cl(r['Termine Berater']),kunde:cl(r['Kunde']),kunde_plz:cl(r['Kunde PLZ']),kundennummer:cl(r['Kundennummer']),quelle:cl(r['Quelle']),an_wert_netto:cl(r['AN-WertNetto']),auszahlungsrelevant:cl(r['Auszahlungsrelevant']),ausgezahlt_am:cl(r['Ausgezahlt am']),efs_prozent:cl(r['EFS %']),finanzierung_gewuenscht:cl(r['Finanzierung gew√ºnscht']),angebot_kwp:cl(r['Angebot KWP']),angebot_module:cl(r['Angebot Module']),angebot_solarmodule:cl(r['Angebot Solarmodule']),angebot_batteriekapazitaet:cl(r['Angebot Batteriekapazit√§t Gesamt']),metrify:cl(r['Metrify']),lieferdatum:cl(r['Lieferdatum']),auftragsbestaetigung:cl(r['Auftragsbest√§tigung']),datum_erstellt:cl(r['DatumErstellt']),datum_an_kunde_gesendet:cl(r['DatumAn Kunde gesendet']),datum_gelesen:cl(r['DatumGelesen']),datum_angenommen:cl(r['DatumAngenommen']),zeit_vergangen:cl(r['Zeit vergangennach Kundenbenachrichtigung'])}}

// Supabase
async function sCnt(t){const r=await fetch(ap(t)+'?select=id&limit=0',{headers:{...hd(),'Prefer':'count=exact'}});const rng=r.headers.get('content-range');return rng?parseInt(rng.split('/')[1])||0:0}
async function uBat(t,rows,onP){let ins=0,upd=0,er=0;const eD=[];for(let i=0;i<rows.length;i+=B){const b=rows.slice(i,i+B);try{const r=await fetch(ap(t),{method:'POST',headers:{...hd(),'Prefer':'resolution=merge-duplicates,return=representation'},body:JSON.stringify(b)});if(!r.ok){er+=b.length;eD.push({error:(await r.text()).substring(0,300)})}else{(await r.json()).forEach(x=>{if(x.created_at===x.updated_at)ins++;else upd++})}}catch(e){er+=b.length;eD.push({error:e.message})}onP?.(Math.min(i+B,rows.length),rows.length)}return{inserted:ins,updated:upd,errors:er,errorDetails:eD}}

// Leveto
let lTk=null,lEx=0;
async function lAuth(){if(lTk&&Date.now()<lEx-30000)return lTk;const r=await fetch(LU+'/auth',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:`username=${encodeURIComponent(LN)}&password=${encodeURIComponent(LP)}`});const d=await r.json();if(!d.login)throw new Error('Leveto Auth: '+d.message);lTk=d.token;lEx=Date.now()+4.5*60*1000;return lTk}
async function lGet(p={}){const tk=await lAuth();const qs=new URLSearchParams(p).toString();return(await fetch(`${LU}/leads?${qs}`,{headers:{Authorization:`Bearer ${tk}`}})).json()}
function lMap(l){const a=l.homeAddress||{},s=l.status||{},sf=l.statusFirst||{},sv=l.survey||{};let sd=null;if(sv.data&&Array.isArray(sv.data)){sd={};sv.data.forEach(x=>{if(x.answer)sd[(x.question||'').replace(/[^a-zA-Z0-9√§√∂√º√Ñ√ñ√ú√ü]/g,'_').toLowerCase()]=x.answer})}return{leveto_id:l.id,id_extern:l.idExtern||null,anrede:l.salutation||null,vorname:(l.firstName||'').trim(),nachname:(l.lastName||'').trim(),firma:l.companyName||null,email:l.email||null,telefon:l.telephone||null,telefon2:l.telephone2||null,mobil:l.mobile||null,erreichbarkeit:l.reachability||null,strasse:a.fullstreet||a.street||null,hausnr:a.housenr||null,plz:a.postalCode||null,ort:a.city||null,lat:a.lat||null,lng:a.lng||null,quelle:l.source||null,tags:l.tags||null,berater_name:l.berater||null,berater_ma_nummer:l.ma_nummer||null,notizen:l.notes||null,nachricht:l.message||null,status_id:s.id??null,status_name:s.name||null,status_indicator:s.indicator||null,status_datum:s.date&&s.date!=='0000-00-00 00:00:00'?s.date:null,erster_status_id:sf.id??null,erster_status_name:sf.name||null,erster_status_datum:sf.date&&sf.date!=='0000-00-00 00:00:00'?sf.date:null,letzter_status_wechsel:l.last_status_change&&l.last_status_change!=='0000-00-00 00:00:00'?l.last_status_change:null,zuweisungsstatus:l.zuweisungsstatus||null,assignments_count:l.assignmentsCount||0,accepted_count:l.acceptedCount||0,declined_count:l.declinedCount||0,objekt_typ:l.objectType||null,personen_haushalt:l.personsInHousehold||null,dach_groesse:l.roofSize||null,dach_form:l.roofShape||null,stromverbrauch:l.powerConsumption||null,monatl_abschlag:l.partPayment||null,finanzierung:l.financingModel||null,survey_data:sd?JSON.stringify(sd):null,opt_in_bestaetigt:l.optIn?.confirmed||false,leveto_erstellt_am:l.createdOn&&l.createdOn!=='0000-00-00 00:00:00'?l.createdOn:null,leveto_importiert_am:l.importedOn&&l.importedOn!=='0000-00-00 00:00:00'?l.importedOn:null,leveto_abgeschlossen_am:l.finishedOn&&l.finishedOn!=='0000-00-00 00:00:00'?l.finishedOn:null,leveto_letzte_bearbeitung:l.lastEditOn&&l.lastEditOn!=='0000-00-00 00:00:00'?l.lastEditOn:null,sync_aktualisiert_am:new Date().toISOString()}}

// ‚ïê‚ïê‚ïê MAIN APP ‚ïê‚ïê‚ïê
function App(){
    const[tab,setTab]=useState('leveto');
    const[ct,setCt]=useState({leveto:'-',efs:'-',leads:'-',termine:'-',auftraege:'-'});
    const[logs,setLogs]=useState([]);
    const log=useCallback((m,l='info')=>setLogs(p=>[{t:new Date().toLocaleTimeString('de-DE'),m,l,id:Date.now()+Math.random()},...p].slice(0,100)),[]);
    const rc=useCallback(async()=>{try{const[a,b,c,d,e]=await Promise.allSettled([sCnt('leveto_leads'),sCnt('efs_projekte'),sCnt('import_leads'),sCnt('import_appointments'),sCnt('import_provisions')]);setCt({leveto:a.status==='fulfilled'?a.value:'-',efs:b.status==='fulfilled'?b.value:'-',leads:c.status==='fulfilled'?c.value:'-',termine:d.status==='fulfilled'?d.value:'-',auftraege:e.status==='fulfilled'?e.value:'-'})}catch(e){log('Count-Fehler: '+e.message,'error')}},[log]);
    useEffect(()=>{rc()},[rc]);
    const fm=v=>typeof v==='number'?v.toLocaleString('de-DE'):v;
    const TS=[{k:'leveto',l:'Leveto Sync',i:'üîÑ'},{k:'efs',l:'EFS Sync',i:'üìä'},{k:'csv',l:'CSV Import',i:'üìã'},{k:'merge',l:'Auto-Merge',i:'üîó'}];
    return(<React.Fragment>
        <div className="hdr"><div className="hdr-l"><div className="logo">bee-doo <span>| Import Cockpit</span></div></div><a href="https://bee-doo-tools.vercel.app/" className="hdr-lk">‚Üê Toolbox</a></div>
        <div className="tabs">{TS.map(t=><div key={t.k} className={`tab ${tab===t.k?'on':''}`} onClick={()=>setTab(t.k)}>{t.i} {t.l}</div>)}</div>
        <div className="mn">
            <div className="sts fi">{[{l:'Leveto Leads',v:ct.leveto,s:'leveto_leads'},{l:'EFS Projekte',v:ct.efs,s:'efs_projekte'},{l:'CSV Leads',v:ct.leads,s:'import_leads'},{l:'CSV Termine',v:ct.termine,s:'import_appointments'},{l:'CSV Auftr√§ge',v:ct.auftraege,s:'import_provisions'}].map(s=><div key={s.l} className="st"><div className="st-l">{s.l}</div><div className="st-v">{fm(s.v)}</div><div className="st-s">{s.s}</div></div>)}</div>
            {tab==='leveto'&&<LT log={log} rc={rc}/>}
            {tab==='efs'&&<ET log={log} rc={rc}/>}
            {tab==='csv'&&<CT log={log} rc={rc}/>}
            {tab==='merge'&&<MT log={log} rc={rc} ct={ct}/>}
            <div className="cd" style={{marginTop:16}}><div className="cd-t">üìä Activity Log</div>
                <div className="lb">{logs.length===0&&<div style={{color:'var(--td)',textAlign:'center',padding:20}}>Noch keine Aktivit√§t</div>}{logs.map(l=><div key={l.id}><span className="tm">[{l.t}]</span> <span className={l.l}>{l.m}</span></div>)}</div>
            </div>
        </div>
    </React.Fragment>);
}

// ‚ïê‚ïê‚ïê LEVETO TAB ‚ïê‚ïê‚ïê
function LT({log,rc}){
    const[run,setRun]=useState(false);const[prog,setProg]=useState(null);const ab=useRef(false);
    const sync=async(mode)=>{if(run)return;setRun(true);ab.current=false;const bs=100;log(`üöÄ Leveto ${mode==='full'?'Voll':'Inkrement'}-Sync`,'warn');
        try{const p=mode==='full'?{limit:1}:{limit:1,lastEditFrom:new Date(Date.now()-25*3600000).toISOString().split('T')[0]};const f=await lGet(p);const tot=f.totalrecords;log(`üìä ${tot.toLocaleString()} Leads ${mode==='full'?'total':'ge√§ndert'}`);
            let sy=0,pg=1;while(!ab.current){const off=(pg-1)*bs;if(off>=tot)break;const fp=mode==='full'?{limit:bs,offset:off}:{limit:bs,offset:off,lastEditFrom:new Date(Date.now()-25*3600000).toISOString().split('T')[0]};const d=await lGet(fp);if(!d.leads||!d.leads.length)break;const rows=d.leads.map(lMap);const r=await fetch(ap('leveto_leads'),{method:'POST',headers:{...hd(),'Prefer':'resolution=merge-duplicates'},body:JSON.stringify(rows)});if(!r.ok)throw new Error('Supabase: '+await r.text());sy+=rows.length;setProg({c:sy,t:tot,p:Math.round(sy/tot*100)});if(pg%10===0)log(`üì¶ ${sy.toLocaleString()} / ${tot.toLocaleString()}`);pg++;await new Promise(r=>setTimeout(r,200))}
            log(ab.current?`‚èπ Abgebrochen bei ${sy}`:`‚úÖ ${sy.toLocaleString()} Leads gesynct`,ab.current?'warn':'success');
        }catch(e){log(`‚ùå Leveto: ${e.message}`,'error')}setRun(false);setProg(null);rc()};
    return(<React.Fragment>
        <div className="cd fi"><div className="cd-t">üîÑ Leveto ‚Üí Supabase Sync</div>
            <div className="brow" style={{marginBottom:14}}>
                <button className="btn by" disabled={run} onClick={()=>sync('full')}>{run?<React.Fragment><span className="spinner"/> Sync l√§uft...</React.Fragment>:'Voll-Sync starten'}</button>
                <button className="btn bo" disabled={run} onClick={()=>sync('incr')}>Inkrementell (24h)</button>
                {run&&<button className="btn br" onClick={()=>{ab.current=true}}>‚èπ Stop</button>}
            </div>
            {prog&&<React.Fragment><div className="pb"><div className="pf" style={{width:`${prog.p}%`}}/></div><div className="pt"><span>{prog.c.toLocaleString()} / {prog.t.toLocaleString()}</span><span>{prog.p}%</span></div></React.Fragment>}
        </div>
        <div className="cd fi"><div className="cd-t">üó∫Ô∏è Feld-Mapping</div>
            <table className="mt"><thead><tr><th>Leveto</th><th>‚Üí Supabase</th><th>Status</th><th>Nutzen</th></tr></thead><tbody>
                {[['id','leveto_id','ok','Unique Key'],['idExtern','id_extern','ok','MVPP-ID'],['firstName + lastName','vorname, nachname','ok','Kontakt'],['homeAddress.*','strasse, plz, ort, lat, lng','ok','Geo'],['telephone, mobile, email','telefon, mobil, email','ok','Kontakt'],['berater','berater_name','ok','VT-Zuordnung'],['source','quelle','ok','Lead-Quelle'],['status.*','status_name, indicator','ok','Status'],['survey.data','survey_data (JSON)','ok','Details'],['‚Äî','kWp','m','Anlagengr√∂√üe (EFS/CSV)'],['‚Äî','Auftragswert','m','Vertragssumme (EFS/CSV)']].map((r,i)=><tr key={i}><td style={{color:'var(--tb)'}}>{r[0]}</td><td>{r[1]}</td><td><span className={`tg tg-${r[2]}`}>{r[2]==='ok'?'‚úÖ Sync':'‚ùå Fehlt'}</span></td><td style={{color:'var(--td)'}}>{r[3]}</td></tr>)}
            </tbody></table>
        </div>
        <div className="cd fi"><div className="cd-t">üìä Status-Mapping</div>
            <table className="mt"><thead><tr><th>Leveto</th><th>‚Üí bee-doo</th><th>Provision?</th></tr></thead><tbody>
                {[['Neuer Lead','Neuer Lead','‚Äî'],['WVL','Wiedervorlage','‚Äî'],['Terminiert','Termin gelegt','‚ö° Z√§hlt!'],['Angebot erstellt','Angebot','‚ö° Z√§hlt!'],['Angebot angenommen','Auftrag','üí∞ Auszahlung'],['AB erstellt','AB erstellt','üí∞ Auszahlung'],['Rechnung beglichen','Abgeschlossen','üí∞ Bezahlt'],['STORNO','Storniert','üî¥ R√ºckford.'],['Kein Interesse','Ausfall','‚Äî']].map((r,i)=><tr key={i}><td style={{color:'var(--tb)'}}>{r[0]}</td><td>{r[1]}</td><td>{r[2]}</td></tr>)}
            </tbody></table>
        </div>
    </React.Fragment>);
}

// ‚ïê‚ïê‚ïê EFS TAB ‚ïê‚ïê‚ïê
function ET({log,rc}){
    const[run,setRun]=useState(false);const[res,setRes]=useState(null);const[csv,setCsv]=useState(null);
    useEffect(()=>{fetch(`${SU}/storage/v1/object/public/efs-exports/latest.csv`,{method:'HEAD'}).then(r=>{if(r.ok)setCsv({url:`${SU}/storage/v1/object/public/efs-exports/latest.csv`,d:r.headers.get('last-modified')})}).catch(()=>{})},[]);
    const trigger=async()=>{setRun(true);setRes(null);log('üöÄ EFS Sync manuell gestartet...','warn');try{const r=await fetch('/api/efs-sync',{headers:{Authorization:'Bearer manual'}});const d=await r.json();setRes(d);if(d.success){log(`‚úÖ EFS: ${d.summary?.totalProjects} Projekte, ${d.summary?.csvRows} CSV-Zeilen`,'success');if(d.summary?.latestCsvUrl)setCsv({url:d.summary.latestCsvUrl,d:new Date().toISOString()})}else log(`‚ùå EFS: ${d.error}`,'error')}catch(e){log(`‚ùå EFS: ${e.message}`,'error')}setRun(false);rc()};
    return(<React.Fragment>
        <div className="eg fi">
            <div className="cd"><div className="cd-t">üìä EFS ‚Üí Supabase Sync</div>
                <p style={{fontSize:13,color:'var(--td)',marginBottom:14,lineHeight:1.6}}>Cron l√§uft t√§glich um <strong style={{color:'var(--a)'}}>06:00 Uhr</strong>. Holt alle Projekte via EFS tRPC API ‚Üí <code style={{background:'var(--el)',padding:'2px 6px',borderRadius:4}}>efs_projekte</code> ‚Üí CSV.</p>
                <div className="brow">
                    <button className="btn by" disabled={run} onClick={trigger}>{run?<React.Fragment><span className="spinner"/> Sync l√§uft...</React.Fragment>:'‚ö° Manuell triggern'}</button>
                    {csv&&<a href={csv.url} target="_blank" className="btn bo" style={{textDecoration:'none'}}>üì• Latest CSV</a>}
                </div>
                {run&&<div style={{marginTop:12,fontSize:12,color:'var(--o)'}}>‚è≥ Bis zu 5 Min (Vercel Pro)...</div>}
            </div>
            <div className="cd"><div className="cd-t">üìã Sync-Details</div>
                {res?.success?<div style={{fontSize:12,lineHeight:2}}><div>‚úÖ <strong>{res.summary.totalProjects}</strong> Projekte</div><div>üì¶ <strong>{res.summary.basisdatenUpserted}</strong> Basisdaten</div><div>üîç <strong>{res.summary.detailsEnriched}</strong> Details{res.summary.detailErrors>0&&<span style={{color:'var(--r)'}}> ({res.summary.detailErrors} Fehler)</span>}</div><div>üìä <strong>{res.summary.csvRows}</strong> CSV-Zeilen</div><div>‚è±Ô∏è {res.summary.durationSeconds}s</div></div>:res?.error?<div style={{fontSize:12,color:'var(--r)'}}>{res.error}</div>:<div style={{fontSize:12,color:'var(--td)',padding:20,textAlign:'center'}}>Noch kein manueller Sync. Cron l√§uft t√§glich.</div>}
                {res?.log&&<div className="lb" style={{marginTop:12,maxHeight:160,fontSize:11}}>{res.log.map((l,i)=><div key={i} style={{color:l.includes('FEHLER')?'var(--r)':l.includes('‚úÖ')?'var(--g)':'var(--td)'}}>{l}</div>)}</div>}
            </div>
        </div>
        <div className="cd fi"><div className="cd-t">üó∫Ô∏è EFS Feld-Mapping</div>
            <table className="mt"><thead><tr><th>EFS API</th><th>‚Üí Supabase</th><th>Phase</th></tr></thead><tbody>
                {[['id','efs_id','List'],['status / simplifiedStatus','status, simplified_status','List'],['primaryCustomer.*','kunde_*, plz, stadt','List'],['totalAmount','gesamtpreis_eur','List'],['user.*','zustaendiger, email','List'],['coSignedAt','co_signed_at','List'],['contract.rate','monatl_rate_eur','Detail'],['contract.product.*','preismodell, nominalzins, factoringrate','Detail'],['projectComponents','pv_kwp, wr_kw, bat_kwh, wb_kw','Detail'],['installedAt / gridConnectedAt','installed_at, grid_connected_at','Detail']].map((r,i)=><tr key={i}><td style={{color:'var(--tb)'}}>{r[0]}</td><td>{r[1]}</td><td><span className={`tg ${r[2]==='List'?'tg-ok':'tg-w'}`}>{r[2]}</span></td></tr>)}
            </tbody></table>
        </div>
    </React.Fragment>);
}

// ‚ïê‚ïê‚ïê CSV TAB ‚ïê‚ïê‚ïê
const CVT=[{k:'leads',l:'Leads Incoming',i:'üìã',d:'Eingehende Leads',c:'bld',t:'import_leads'},{k:'appointments',l:'Termine',i:'üìÖ',d:'Created + Closed CSVs',c:'gd',t:'import_appointments',m:true},{k:'provisions',l:'Provisionsrelevant',i:'üí∞',d:'Auftr√§ge & Finanzen',c:'od',t:'import_provisions'}];

function CT({log,rc}){
    const[fs,setFs]=useState({});const[imp,setImp]=useState(null);const[prog,setProg]=useState({});const[res,setRes]=useState({});
    const det=fn=>fn.toLowerCase().includes('closed')?'closed':'created';
    const hf=(k,f)=>{if(!f)return;const rd=new FileReader();rd.onload=e=>{const rows=parseCSV(e.target.result);if(k==='appointments'){const sub=det(f.name);setFs(p=>{const ex=p.appointments||{fl:[],ar:[],ts:0};const nl=[...ex.fl,{n:f.name,s:f.size,rc:rows.length,sub}];const mp=rows.map(r=>mA(r,sub)).filter(r=>!isNaN(r.termin_id));const mg=[...ex.ar];mp.forEach(row=>{const idx=mg.findIndex(r=>r.termin_id===row.termin_id);if(idx>=0){if(row.csv_quelle==='closed'||mg[idx].csv_quelle!=='closed')mg[idx]=row}else mg.push(row)});return{...p,appointments:{fl:nl,ar:mg,ts:ex.ts+f.size,rc:mg.length}}});log(`${f.name} (${sub}): ${rows.length.toLocaleString('de-DE')} Zeilen`)}else{setFs(p=>({...p,[k]:{f,rows,rc:rows.length,n:f.name,s:f.size}}));log(`${f.name}: ${rows.length.toLocaleString('de-DE')} Zeilen`)}};rd.readAsText(f,'UTF-8')};
    const rf=k=>{setFs(p=>{const n={...p};delete n[k];return n});setRes(p=>{const n={...p};delete n[k];return n})};
    const io=async k=>{const ct=CVT.find(t=>t.k===k);const fd=fs[k];if(!fd||!ct)return;setImp(k);const tot=k==='appointments'?fd.ar.length:fd.rc;setProg(p=>({...p,[k]:{c:0,t:tot}}));log(`Import: ${ct.l} (${tot.toLocaleString('de-DE')} Zeilen)`,'warn');const bid=crypto.randomUUID();
        try{let mp;if(k==='leads')mp=fd.rows.map(mL).filter(r=>!isNaN(r.lead_id));else if(k==='appointments')mp=fd.ar;else mp=fd.rows.map(mP).filter(r=>!isNaN(r.an_nr));mp=mp.map(r=>({...r,import_batch_id:bid}));const r=await uBat(ct.t,mp,(c,t)=>setProg(p=>({...p,[k]:{c,t}})));setRes(p=>({...p,[k]:r}));log(`‚úì ${ct.l}: ${r.inserted} neu, ${r.updated} aktualisiert${r.errors>0?`, ${r.errors} Fehler`:''}`,r.errors>0?'error':'success');
        await fetch(ap('import_logs'),{method:'POST',headers:hd(),body:JSON.stringify({batch_id:bid,csv_typ:k,dateiname:k==='appointments'?fd.fl.map(f=>f.n).join(' + '):fd.n,zeilen_gesamt:tot,zeilen_neu:r.inserted,zeilen_aktualisiert:r.updated,zeilen_fehler:r.errors,fehler_details:r.errorDetails.length?r.errorDetails:null,finished_at:new Date().toISOString()})});rc()}catch(e){log(`‚úó ${ct.l}: ${e.message}`,'error');setRes(p=>({...p,[k]:{inserted:0,updated:0,errors:tot,errorDetails:[{error:e.message}]}}))};setImp(null)};
    const ia=async()=>{for(const k of['leads','appointments','provisions'])if(fs[k])await io(k)};
    const fc=Object.keys(fs).length;
    return(<React.Fragment>
        <div className="ig fi">{CVT.map(ct=><CC key={ct.k} ct={ct} fd={fs[ct.k]} imp={imp===ct.k} prog={prog[ct.k]} res={res[ct.k]} onF={f=>hf(ct.k,f)} onR={()=>rf(ct.k)} onI={()=>io(ct.k)}/>)}</div>
        <div className="brow fi"><button className="btn by" disabled={fc===0||imp!==null} onClick={ia}>{imp?<React.Fragment><span className="spinner"/> Importiert...</React.Fragment>:<React.Fragment>üöÄ Alle importieren ({fc})</React.Fragment>}</button><button className="btn bo" onClick={rc}>üîÑ Aktualisieren</button></div>
    </React.Fragment>);
}

function CC({ct,fd,imp,prog,res,onF,onR,onI}){
    const ref=useRef(null);const[dg,setDg]=useState(false);const ml=ct.m;const has=ml?fd?.fl?.length>0:!!fd;
    const onD=e=>{e.preventDefault();setDg(false);Array.from(e.dataTransfer.files).filter(f=>f.name.endsWith('.csv')).forEach(f=>onF(f))};
    const onIn=e=>{Array.from(e.target.files).forEach(f=>onF(f));e.target.value=''};
    const pc=prog?Math.round(prog.c/prog.t*100):0;const tot=fd?.rc||0;
    const cols={bld:'var(--bld)',gd:'var(--gd)',od:'var(--od)'};
    const bd=()=>{if(imp)return<span className="icb" style={{background:'var(--ad)',color:'var(--a)'}}><span className="spinner" style={{width:8,height:8,borderWidth:1.5,marginRight:4}}/>Import</span>;if(res?.errors>0&&res?.inserted===0)return<span className="icb" style={{background:'var(--rd)',color:'var(--r)'}}>Fehler</span>;if(res)return<span className="icb" style={{background:'var(--gd)',color:'var(--g)'}}>‚úì Fertig</span>;if(has)return<span className="icb" style={{background:'var(--gd)',color:'var(--g)'}}>Bereit</span>;return<span className="icb" style={{background:'rgba(255,255,255,.05)',color:'var(--td)'}}>‚Äî</span>};
    return(<div className={`ic ${has?'on':''}`}>
        <div className="ich"><div className="ict"><div className="ici" style={{background:cols[ct.c]}}>{ct.i}</div><div><div className="icn">{ct.l}</div><div className="icd">{ct.d}</div></div></div>{bd()}</div>
        {ml&&<div className="mh">‚ö° Mehrere CSVs ‚Äì Closed √ºberschreibt Created</div>}
        {(!has||(ml&&!res))&&!imp&&<div className={`dz ${dg?'dv':''}`} onDragOver={e=>{e.preventDefault();setDg(true)}} onDragLeave={()=>setDg(false)} onDrop={onD} onClick={()=>ref.current?.click()}>{ml?'Created + Closed CSVs':'CSV'} hierher ziehen oder <strong>klicken</strong><input ref={ref} type="file" accept=".csv" multiple={ml} onChange={onIn}/></div>}
        {ml&&fd?.fl?.map((f,i)=><div key={i} className="fi2"><span>{f.sub==='closed'?'‚úÖ':'üìÑ'}</span><div><span className="fi2-n">{f.n}</span> <span className="fi2-m">¬∑ {f.rc.toLocaleString('de-DE')} Zeilen ¬∑ {f.sub}</span></div></div>)}
        {!ml&&fd&&<div className="fi2"><span>üìÑ</span><div><span className="fi2-n">{fd.n}</span> <span className="fi2-m">¬∑ {fd.rc.toLocaleString('de-DE')} Zeilen ¬∑ {(fd.s/1024).toFixed(0)} KB</span></div>{!imp&&!res&&<button className="fi2-x" onClick={onR}>‚úï</button>}</div>}
        {ml&&fd?.fl?.length>1&&<div style={{fontSize:11,color:'var(--a)',textAlign:'center',marginTop:4}}>‚Üí {fd.rc.toLocaleString('de-DE')} eindeutige Termine</div>}
        {imp&&prog&&<React.Fragment><div className="pb"><div className="pf" style={{width:`${pc}%`}}/></div><div className="pt"><span>{prog.c.toLocaleString('de-DE')} / {prog.t.toLocaleString('de-DE')}</span><span>{pc}%</span></div></React.Fragment>}
        {res&&<div className="rg"><div className="ri nw"><div className="rn">{res.inserted.toLocaleString('de-DE')}</div><div className="rl">Neu</div></div><div className="ri up"><div className="rn">{res.updated.toLocaleString('de-DE')}</div><div className="rl">Aktualisiert</div></div><div className="ri er"><div className="rn">{res.errors.toLocaleString('de-DE')}</div><div className="rl">Fehler</div></div></div>}
        {has&&!imp&&!res&&<button className="btn by" style={{width:'100%',marginTop:10,justifyContent:'center'}} onClick={onI}>‚ö° {tot.toLocaleString('de-DE')} Zeilen importieren</button>}
        {res&&!imp&&<button className="btn bo bsm" style={{width:'100%',marginTop:6,justifyContent:'center'}} onClick={onR}>‚Üª Neuer Import</button>}
    </div>);
}

// ‚ïê‚ïê‚ïê MERGE TAB ‚ïê‚ïê‚ïê
function MT({log,rc,ct}){
    const[run,setRun]=useState(false);const[mr,setMr]=useState(null);
    const go=async()=>{setRun(true);setMr(null);log('üîó Auto-Merge gestartet','warn');let le=0,lc=0,ec=0;
        try{log('Phase 1: EFS ‚Üî Leveto (PLZ + Name)...');
            const er=await(await fetch(ap('efs_projekte')+'?select=efs_id,kunde_nachname,kunde_plz,leveto_id&leveto_id=is.null&limit=2000',{headers:hd()})).json();
            if(er.length>0){const lr=await(await fetch(ap('leveto_leads')+'?select=id,leveto_id,nachname,plz&limit=10000',{headers:hd()})).json();const lk={};lr.forEach(l=>{const k=`${(l.nachname||'').toLowerCase().trim()}_${l.plz||''}`;if(!lk[k])lk[k]=[];lk[k].push(l)});
                for(const e of er){const k=`${(e.kunde_nachname||'').toLowerCase().trim()}_${e.kunde_plz||''}`;if(lk[k]){await fetch(ap('efs_projekte')+`?efs_id=eq.${e.efs_id}`,{method:'PATCH',headers:hd(),body:JSON.stringify({leveto_id:lk[k][0].leveto_id})});le++}}
                log(`‚úÖ EFS ‚Üî Leveto: ${le} Matches`,'success')}else log('EFS ‚Üî Leveto: Alle gematcht');
            log('Phase 2: CSV ‚Üî Leveto (Lead ID)...');const pr=await(await fetch(ap('import_provisions')+'?select=an_nr,lead_id&lead_id=not.is.null&limit=5000',{headers:hd()})).json();
            if(pr.length>0){const li=await(await fetch(ap('leveto_leads')+'?select=id,leveto_id&limit=50000',{headers:hd()})).json();const ik={};li.forEach(l=>{ik[l.leveto_id]=l.id});for(const p of pr)if(ik[p.lead_id])lc++; log(`‚úÖ CSV ‚Üî Leveto: ${lc} zuordenbar`,'success')}
            log('Phase 3: EFS ‚Üî CSV (Name + PLZ)...');const ea=await(await fetch(ap('efs_projekte')+'?select=efs_id,kunde_nachname,kunde_plz&limit=2000',{headers:hd()})).json();const pa=await(await fetch(ap('import_provisions')+'?select=an_nr,kunde,kunde_plz&limit=5000',{headers:hd()})).json();
            const pk={};pa.forEach(p=>{const nm=(p.kunde||'').split(/\s+/).pop()||'';const k=`${nm.toLowerCase()}_${p.kunde_plz||''}`;if(!pk[k])pk[k]=[];pk[k].push(p)});for(const e of ea){const k=`${(e.kunde_nachname||'').toLowerCase().trim()}_${e.kunde_plz||''}`;if(pk[k])ec++}log(`‚úÖ EFS ‚Üî CSV: ${ec} Matches`,'success');
            setMr({le,lc,ec});log(`üîó Merge fertig: ${le+lc+ec} total`,'success')}catch(e){log(`‚ùå Merge: ${e.message}`,'error')}setRun(false);rc()};
    const fm=v=>typeof v==='number'?v.toLocaleString('de-DE'):v;
    return(<React.Fragment>
        <div className="cd fi"><div className="cd-t">üîó Datenquellen verkn√ºpfen</div>
            <p style={{fontSize:13,color:'var(--td)',marginBottom:16,lineHeight:1.6}}>Matcht Leveto ‚Üî EFS ‚Üî CSV √ºber Name+PLZ und Lead-IDs. Verkn√ºpfte Daten erm√∂glichen vollst√§ndige Provisions-Berechnung.</p>
            <div className="mg">{[{i:'üîÑ',v:ct.leveto,l:'Leveto Leads'},{i:'üìä',v:ct.efs,l:'EFS Projekte'},{i:'üí∞',v:ct.auftraege,l:'CSV Auftr√§ge'}].map(s=><div key={s.l} className="mc"><div style={{fontSize:28}}>{s.i}</div><div className="mv">{fm(s.v)}</div><div className="ml">{s.l}</div></div>)}</div>
            <button className="btn by" disabled={run} onClick={go} style={{width:'100%',justifyContent:'center'}}>{run?<React.Fragment><span className="spinner"/> Merge l√§uft...</React.Fragment>:'üîó Auto-Merge starten'}</button>
        </div>
        {mr&&<div className="cd fi"><div className="cd-t">‚úÖ Merge-Ergebnis</div>
            <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:14}}>{[{v:mr.le,l:'EFS ‚Üî Leveto',bg:'var(--ad)',c:'var(--a)'},{v:mr.lc,l:'CSV ‚Üî Leveto',bg:'var(--bld)',c:'var(--bl)'},{v:mr.ec,l:'EFS ‚Üî CSV',bg:'var(--gd)',c:'var(--g)'}].map(s=><div key={s.l} style={{background:s.bg,borderRadius:10,padding:16,textAlign:'center'}}><div style={{fontSize:24,fontWeight:700,color:s.c}}>{s.v}</div><div style={{fontSize:11,color:'var(--td)',marginTop:4}}>{s.l}</div></div>)}</div>
        </div>}
        <div className="cd fi"><div className="cd-t">‚ÑπÔ∏è Merge-Logik</div>
            <table className="mt"><thead><tr><th>Quelle A</th><th>‚Üî</th><th>Quelle B</th><th>Match-Kriterium</th></tr></thead><tbody>
                <tr><td style={{color:'var(--tb)'}}>EFS Projekte</td><td>‚Üî</td><td>Leveto Leads</td><td>Nachname + PLZ</td></tr>
                <tr><td style={{color:'var(--tb)'}}>CSV Auftr√§ge</td><td>‚Üî</td><td>Leveto Leads</td><td>Lead ID (direkt)</td></tr>
                <tr><td style={{color:'var(--tb)'}}>EFS Projekte</td><td>‚Üî</td><td>CSV Auftr√§ge</td><td>Kunde Nachname + PLZ</td></tr>
            </tbody></table>
        </div>
    </React.Fragment>);
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
