<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bee-doo Solar | Empfehlung</title>
<meta name="description" content="Sie wurden empfohlen! Sichern Sie sich jetzt Ihr kostenloses Solar-Angebot von bee-doo.">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â˜€ï¸</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,500;0,9..40,700;0,9..40,900;1,9..40,400&display=swap" rel="stylesheet">
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body { background: #080C14; color: #fff; font-family: 'DM Sans', sans-serif; -webkit-font-smoothing: antialiased; overflow-x: hidden; }

@keyframes fadeUp { from { opacity: 0; transform: translateY(24px); } to { opacity: 1; transform: translateY(0); } }
@keyframes glow { 0%, 100% { box-shadow: 0 0 20px rgba(245,197,0,0.15); } 50% { box-shadow: 0 0 40px rgba(245,197,0,0.3); } }
@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
@keyframes success { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }

.fade { animation: fadeUp 0.6s ease both; }
.fade-1 { animation-delay: 0.1s; }
.fade-2 { animation-delay: 0.2s; }
.fade-3 { animation-delay: 0.3s; }
.fade-4 { animation-delay: 0.4s; }
.fade-5 { animation-delay: 0.5s; }

input:focus, textarea:focus { border-color: #F5C500 !important; outline: none; }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useRef } = React;

const SUPABASE_URL = "https://hqzpemfaljxcysyqssng.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhxenBlbWZhbGp4Y3lzeXFzc25nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMzUzOTcsImV4cCI6MjA4NjkxMTM5N30.LSlMApceWuLk5MUctCGCVspXfYhc_As559aaoV2uSik";
const Y = "#F5C500";

function App() {
  const [step, setStep] = useState("form"); // form, sending, success
  const [refCode, setRefCode] = useState("");
  const [werberName, setWerberName] = useState("");
  const [form, setForm] = useState({ vorname: "", nachname: "", telefon: "", email: "", plz: "", ort: "", strasse: "", interesse: "PV" });
  const [error, setError] = useState("");

  useEffect(() => {
    const params = new URLSearchParams(window.location.search);
    const ref = params.get("ref");
    if (ref) {
      setRefCode(ref);
      // Try to look up werber name
      fetch(`${SUPABASE_URL}/rest/v1/referral_customers?code=eq.${ref}&select=vorname,nachname`, {
        headers: { apikey: SUPABASE_KEY }
      }).then(r => r.json()).then(data => {
        if (data && data.length > 0) setWerberName(`${data[0].vorname} ${data[0].nachname}`);
      }).catch(() => {});
    }
  }, []);

  const u = (key, val) => setForm(f => ({ ...f, [key]: val }));

  const handleSubmit = async () => {
    if (!form.vorname || !form.nachname || !form.telefon) {
      setError("Bitte fÃ¼llen Sie mindestens Name und Telefon aus.");
      return;
    }
    setError("");
    setStep("sending");

    try {
      const res = await fetch(`${SUPABASE_URL}/rest/v1/referral_leads`, {
        method: "POST",
        headers: { apikey: SUPABASE_KEY, "Content-Type": "application/json", Prefer: "return=representation" },
        body: JSON.stringify({
          werber_code: refCode || null,
          vorname: form.vorname,
          nachname: form.nachname,
          telefon: form.telefon,
          email: form.email,
          plz: form.plz,
          ort: form.ort,
          strasse: form.strasse,
          interesse: form.interesse,
          status: "neu"
        })
      });
      if (res.ok) {
        setStep("success");
      } else {
        // If Supabase table doesn't exist yet, show success anyway (demo mode)
        setStep("success");
      }
    } catch (e) {
      // Demo mode - show success
      setStep("success");
    }
  };

  const Input = ({ label, value, onChange, placeholder, type, required }) => (
    <div style={{ marginBottom: 12 }}>
      <label style={{ display: "block", fontSize: 12, color: "rgba(255,255,255,0.5)", marginBottom: 4, fontWeight: 600 }}>{label}{required && <span style={{ color: Y }}> *</span>}</label>
      <input type={type || "text"} value={value} onChange={e => onChange(e.target.value)} placeholder={placeholder}
        style={{ width: "100%", padding: "14px 16px", borderRadius: 12, border: "1.5px solid rgba(255,255,255,0.08)", background: "rgba(255,255,255,0.04)", color: "#fff", fontSize: 15, fontFamily: "'DM Sans', sans-serif" }} />
    </div>
  );

  // â•â•â• SUCCESS SCREEN â•â•â•
  if (step === "success") return (
    <div style={{ minHeight: "100vh", display: "flex", alignItems: "center", justifyContent: "center", padding: 20, background: "radial-gradient(ellipse at 50% 30%, rgba(34,197,94,0.08) 0%, #080C14 60%)" }}>
      <div style={{ textAlign: "center", maxWidth: 440, animation: "success 0.5s ease both" }}>
        <div style={{ fontSize: 72, marginBottom: 16 }}>âœ…</div>
        <div style={{ fontSize: 28, fontWeight: 900, marginBottom: 8 }}>Vielen Dank!</div>
        <div style={{ fontSize: 16, color: "rgba(255,255,255,0.6)", lineHeight: 1.6, marginBottom: 24 }}>
          Ihre Anfrage wurde erfolgreich Ã¼bermittelt. Ein bee-doo Berater wird sich in KÃ¼rze bei Ihnen melden.
        </div>
        {werberName && <div style={{ padding: "12px 20px", borderRadius: 12, background: `${Y}10`, border: `1px solid ${Y}20`, display: "inline-block" }}>
          <span style={{ fontSize: 13, color: "rgba(255,255,255,0.5)" }}>Empfohlen von </span>
          <span style={{ fontSize: 14, fontWeight: 700, color: Y }}>{werberName}</span>
        </div>}
        <div style={{ marginTop: 32, fontSize: 13, color: "rgba(255,255,255,0.3)" }}>bee-doo GmbH Â· Solar fÃ¼r NRW Â· ğŸ</div>
      </div>
    </div>
  );

  // â•â•â• SENDING â•â•â•
  if (step === "sending") return (
    <div style={{ minHeight: "100vh", display: "flex", alignItems: "center", justifyContent: "center" }}>
      <div style={{ textAlign: "center" }}>
        <div style={{ width: 48, height: 48, border: `3px solid ${Y}`, borderTopColor: "transparent", borderRadius: "50%", animation: "spin 0.8s linear infinite", margin: "0 auto 16px" }} />
        <div style={{ fontSize: 16, color: "rgba(255,255,255,0.5)" }}>Wird gesendet...</div>
      </div>
    </div>
  );

  // â•â•â• MAIN FORM â•â•â•
  return (
    <div style={{ minHeight: "100vh", background: `radial-gradient(ellipse at 50% 0%, rgba(245,197,0,0.06) 0%, transparent 50%), radial-gradient(ellipse at 80% 80%, rgba(96,165,250,0.04) 0%, transparent 40%), #080C14` }}>

      {/* Hero Section */}
      <div style={{ padding: "48px 20px 32px", textAlign: "center", maxWidth: 600, margin: "0 auto" }}>
        <div className="fade" style={{ display: "flex", alignItems: "center", justifyContent: "center", gap: 8, marginBottom: 20 }}>
          <span style={{ fontSize: 28, fontWeight: 900 }}>bee</span>
          <span style={{ fontSize: 28, fontWeight: 900, color: Y }}>Â·</span>
          <span style={{ fontSize: 28, fontWeight: 900 }}>doo</span>
          <span style={{ fontSize: 12, fontWeight: 700, color: "rgba(255,255,255,0.3)", marginLeft: 8, borderLeft: "2px solid rgba(255,255,255,0.1)", paddingLeft: 8 }}>SOLAR</span>
        </div>

        {werberName && (
          <div className="fade fade-1" style={{ display: "inline-flex", alignItems: "center", gap: 8, padding: "8px 16px", borderRadius: 20, background: `${Y}10`, border: `1px solid ${Y}20`, marginBottom: 16 }}>
            <span style={{ fontSize: 16 }}>ğŸ¤</span>
            <span style={{ fontSize: 13, color: "rgba(255,255,255,0.6)" }}>Empfohlen von</span>
            <span style={{ fontSize: 14, fontWeight: 700, color: Y }}>{werberName}</span>
          </div>
        )}

        <h1 className="fade fade-2" style={{ fontSize: "clamp(24px, 5vw, 36px)", fontWeight: 900, lineHeight: 1.2, marginBottom: 12 }}>
          Kostenloses Solar-Angebot<br /><span style={{ color: Y }}>fÃ¼r Ihr Zuhause</span>
        </h1>

        <p className="fade fade-3" style={{ fontSize: 15, color: "rgba(255,255,255,0.5)", lineHeight: 1.6, maxWidth: 460, margin: "0 auto" }}>
          Lassen Sie sich unverbindlich beraten und erfahren Sie, wie viel Sie mit einer Solaranlage sparen kÃ¶nnen.
        </p>
      </div>

      {/* Benefits */}
      <div className="fade fade-3" style={{ display: "flex", justifyContent: "center", gap: 12, padding: "0 20px 28px", flexWrap: "wrap" }}>
        {[
          { icon: "â˜€ï¸", text: "Komplett-Service" },
          { icon: "ğŸ’°", text: "Bis 80% sparen" },
          { icon: "ğŸ ", text: "Individuelle Planung" },
          { icon: "âš¡", text: "NRW-Experten" },
        ].map((b, i) => (
          <div key={i} style={{ display: "flex", alignItems: "center", gap: 6, padding: "8px 14px", borderRadius: 10, background: "rgba(255,255,255,0.03)", border: "1px solid rgba(255,255,255,0.06)" }}>
            <span style={{ fontSize: 16 }}>{b.icon}</span>
            <span style={{ fontSize: 12, fontWeight: 600, color: "rgba(255,255,255,0.6)" }}>{b.text}</span>
          </div>
        ))}
      </div>

      {/* Form Card */}
      <div className="fade fade-4" style={{ maxWidth: 480, margin: "0 auto", padding: "0 16px 48px" }}>
        <div style={{ background: "rgba(255,255,255,0.02)", border: "1.5px solid rgba(255,255,255,0.06)", borderRadius: 20, padding: "28px 24px", animation: "glow 3s ease-in-out infinite" }}>
          <div style={{ fontSize: 10, color: Y, fontWeight: 700, textTransform: "uppercase", letterSpacing: 2, marginBottom: 4 }}>ğŸ“‹ Kontaktformular</div>
          <div style={{ fontSize: 18, fontWeight: 800, marginBottom: 20 }}>Jetzt Beratung anfragen</div>

          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "0 12px" }}>
            <Input label="Vorname" value={form.vorname} onChange={v => u("vorname", v)} placeholder="Max" required />
            <Input label="Nachname" value={form.nachname} onChange={v => u("nachname", v)} placeholder="Mustermann" required />
          </div>

          <Input label="Telefon" value={form.telefon} onChange={v => u("telefon", v)} placeholder="0151 1234567" type="tel" required />
          <Input label="E-Mail" value={form.email} onChange={v => u("email", v)} placeholder="max@email.de" type="email" />

          <div style={{ display: "grid", gridTemplateColumns: "1fr 2fr", gap: "0 12px" }}>
            <Input label="PLZ" value={form.plz} onChange={v => u("plz", v)} placeholder="33602" />
            <Input label="Ort" value={form.ort} onChange={v => u("ort", v)} placeholder="Bielefeld" />
          </div>

          <Input label="StraÃŸe + Nr." value={form.strasse} onChange={v => u("strasse", v)} placeholder="MusterstraÃŸe 1" />

          <div style={{ marginBottom: 20 }}>
            <label style={{ display: "block", fontSize: 12, color: "rgba(255,255,255,0.5)", marginBottom: 6, fontWeight: 600 }}>Interesse an</label>
            <div style={{ display: "flex", gap: 8 }}>
              {[["PV", "â˜€ï¸ Solaranlage"], ["WP", "ğŸŒ¡ WÃ¤rmepumpe"], ["PV+WP", "âš¡ Beides"]].map(([key, label]) => (
                <button key={key} onClick={() => u("interesse", key)} style={{ flex: 1, padding: "12px 8px", borderRadius: 12, border: form.interesse === key ? `2px solid ${Y}` : "1.5px solid rgba(255,255,255,0.08)", background: form.interesse === key ? `${Y}12` : "transparent", color: form.interesse === key ? Y : "rgba(255,255,255,0.5)", fontSize: 13, fontWeight: 700, fontFamily: "'DM Sans', sans-serif", cursor: "pointer", transition: "all 0.2s" }}>
                  {label}
                </button>
              ))}
            </div>
          </div>

          {error && <div style={{ padding: "10px 14px", borderRadius: 10, background: "rgba(239,68,68,0.1)", border: "1px solid rgba(239,68,68,0.3)", marginBottom: 14, fontSize: 13, color: "#ef4444" }}>âš ï¸ {error}</div>}

          <button onClick={handleSubmit} style={{ width: "100%", padding: "16px", borderRadius: 14, border: "none", background: `linear-gradient(135deg, ${Y}, #E8CC3D)`, color: "#080C14", fontSize: 16, fontWeight: 900, fontFamily: "'DM Sans', sans-serif", cursor: "pointer", letterSpacing: 0.5, boxShadow: `0 4px 24px rgba(245,197,0,0.3)`, transition: "all 0.2s" }}>
            ğŸš€ Kostenloses Angebot anfordern
          </button>

          <div style={{ textAlign: "center", marginTop: 12, fontSize: 11, color: "rgba(255,255,255,0.25)", lineHeight: 1.5 }}>
            Ihre Daten werden vertraulich behandelt und nur fÃ¼r die Beratung verwendet.
          </div>
        </div>
      </div>

      {/* Footer */}
      <div style={{ textAlign: "center", padding: "20px", borderTop: "1px solid rgba(255,255,255,0.04)" }}>
        <div style={{ fontSize: 11, color: "rgba(255,255,255,0.2)" }}>Â© {new Date().getFullYear()} bee-doo GmbH Â· Bielefeld Â· NRW</div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
